<!DOCTYPE html>
<html>
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<title>4. ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«GLM â€” çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°å®Ÿç¿’ 2022 TMDU</title>
<link rel="stylesheet" href="/slides/lib/reveal.js/reveal.css">
<script defer src="/slides/lib/reveal.js/reveal.js"></script>
<script defer src="/slides/lib/reveal.js/plugin/notes.js"></script>
<script defer src="/slides/lib/reveal-initialize.js"></script>
<link rel="stylesheet" href="/slides/css/theme-reveal.css">
<script defer src="/slides/lib/reload-img-onclick.js"></script>
<meta name="author" content="Watal M. Iwasaki">
<meta property="og:title" content="4. ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«GLM â€” çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°å®Ÿç¿’ 2022 TMDU">
<meta property="og:type" content="article">
<meta property="og:url" content="https://heavywatal.github.io/slides/tmd2022stats/4-glm.html">
<meta property="og:image" content="https://avatars.githubusercontent.com/heavywatal">
<meta property="og:description" content="">
<meta property="og:site_name" content="Slide decks â€” Heavy Watal">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@heavywatal">
<meta name="twitter:creator" content="@heavywatal">
<link rel="stylesheet" href="/lib/katex/katex.min.css">
<script defer src="/lib/katex/katex.min.js"></script>
<script defer src="/lib/katex/contrib/auto-render.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  renderMathInElement(document.body, {
    delimiters: [
      {left: "\\[", right: "\\]", display: true},
      {left: "$", right: "$", display: false}
    ]
  });
});
</script>
<style>
.katex {
  font-size: 1.12em;
}

.katex-display > .katex {
  text-align: left;
  padding-left: 2rem;
}
</style>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-V60H2JH0G6"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-V60H2JH0G6', { 'anonymize_ip': false });
}
</script>

</head>
<body>
<div class="reveal">
<div class="slides">
<section>
<link rel="stylesheet" href="style.css">
<h1 id="çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°å®Ÿç¿’-2022-tmdu"><a href=".">çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°å®Ÿç¿’ 2022 TMDU</a></h1>
<div class="author">
å²©åµœ èˆª (Watal M. Iwasaki, PhD)
</div>
<div class="affiliation">
æ±åŒ—å¤§å­¦ ç”Ÿå‘½ç§‘å­¦ç ”ç©¶ç§‘ é€²åŒ–ã‚²ãƒãƒŸã‚¯ã‚¹åˆ†é‡ ç‰¹ä»»åŠ©æ•™<br>
(Graduate School of Life Sciences, Tohoku University)
</div>
<ol>
<li><a href="1-introduction.html">å°å…¥ã€ç›´ç·šå›å¸°</a>
<li><a href="2-distribution.html">ç¢ºç‡åˆ†å¸ƒã€æ“¬ä¼¼ä¹±æ•°ç”Ÿæˆ</a>
<li><a href="3-likelihood.html">å°¤åº¦ã€æœ€å°¤æ¨å®š</a>
<li class="current-deck"><a href="4-glm.html">ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ« (GLM)</a>
<li><a href="5-glmm.html">å€‹ä½“å·®ã€ä¸€èˆ¬åŒ–ç·šå½¢æ··åˆãƒ¢ãƒ‡ãƒ« (GLMM)</a>
<li><a href="6-bayesian.html">ãƒ™ã‚¤ã‚ºã®å®šç†ã€äº‹å¾Œåˆ†å¸ƒã€MCMC</a>
<li><a href="7-stan.html">Stanã§GLM</a>
<li><a href="8-hbm.html">éšå±¤ãƒ™ã‚¤ã‚ºãƒ¢ãƒ‡ãƒ« (HBM)</a>
</ol>
<div class="footnote">
2023-03-18 æ±äº¬åŒ»ç§‘æ­¯ç§‘å¤§å­¦
<a href="https://heavywatal.github.io/slides/tmd2022stats/">https://heavywatal.github.io/slides/tmd2022stats/</a>
</div>

</section>
<section>
<h2 id="å‰ç« ã§è¦‹ãŸçµ±è¨ˆãƒ¢ãƒ‡ãƒ«">å‰ç« ã§è¦‹ãŸçµ±è¨ˆãƒ¢ãƒ‡ãƒ«</h2>
<p>ç¢ºç‡å¤‰æ•°$X$ã¯ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿$\theta$ã®ç¢ºç‡åˆ†å¸ƒ$f$ã«â€œå¾“ã†â€:Â 
$X \sim f(\theta) $</p>
<p>e.g., ã‚ã‚‹æ¤ç‰©ãŒä½œã‚‹ç¨®ã®æ•°$X$ã¯å¹³å‡å€¤$\lambda$ã®ãƒã‚¢ã‚½ãƒ³åˆ†å¸ƒã«å¾“ã†:</p>
<div>\[\begin{split}
X \sim \text{Poisson}(\lambda)
\end{split}\]</div>
<img src="./figure/only-dist-1.png" alt="plot of chunk only-dist" width="288" />
<p>ã“ã‚Œã‚’ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«(GLM)ã¨ã—ã¦è¦‹ã‚‹ã“ã¨ã‚‚ã§ãã‚‹ã€‚</p>

</section>
<section>
<h2 id="ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«glmã¨ã—ã¦è¨˜è¿°ã—ã¦ã¿ã‚‹">ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«(GLM)ã¨ã—ã¦è¨˜è¿°ã—ã¦ã¿ã‚‹</h2>
<p>å€‹ä½“$i$ã®ç¨®å­æ•°$y_i$ã¯å¹³å‡å€¤$\lambda_i$ã®ãƒã‚¢ã‚½ãƒ³åˆ†å¸ƒã«å¾“ã†ã€‚<br>
å¹³å‡å€¤$\lambda_i$ã¯<strong>ä»–ã®ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‰ãš$\beta_0$ã§ä¸€å®š</strong>ã€‚</p>
<div>\[\begin{split}
y_i &\sim \text{Poisson}(\lambda_i) \\
\lambda_i &= \beta_0
\end{split}\]</div>
<img src="./figure/glm-without-x-1.png" alt="plot of chunk glm-without-x" width="288" />
<p>ç¨®å­æ•°ã‚’Yè»¸ã«ã—ã¦ã€å¼ã‚’2ã¤ã«åˆ†ã‘ãŸã ã‘&hellip;?<br>
<strong>èª¬æ˜å¤‰æ•°</strong>ã‚’å«ã‚€ãƒ¢ãƒ‡ãƒ«ã‚’è¦‹ã‚Œã°ã”åˆ©ç›ŠãŒåˆ†ã‹ã‚‹ã‹ã‚‚ã€‚</p>

</section>
<section>
<h2 id="èª¬æ˜å¤‰æ•°ãŒ1ã¤ã‚ã‚‹ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«">èª¬æ˜å¤‰æ•°ãŒ1ã¤ã‚ã‚‹ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«</h2>
<p>å€‹ä½“$i$ã®ç¨®å­æ•°$y_i$ã¯å¹³å‡å€¤$\lambda_i$ã®ãƒã‚¢ã‚½ãƒ³åˆ†å¸ƒã«å¾“ã†ã€‚<br>
å¹³å‡å€¤ã®å¯¾æ•°$\log(\lambda_i)$ã¯<strong>ãã®å€‹ä½“ã®å¤§ãã•$x_i$ã«æ¯”ä¾‹</strong>ã™ã‚‹ã€‚</p>
<div class="column-container">
  <div class="column" style="flex-shrink: 1.0;">
<figure>
<img src="../tokiomarine2021/glm.drawio.svg" width="100%"><br>
</figure>
  </div>
  <div class="column" style="flex-shrink: 1.0;">
<img src="./figure/glm-poisson-1.png" alt="plot of chunk glm-poisson" width="360" />
  </div>
</div>
<p>ã“ã®å ´åˆã¯<strong>å˜å›å¸°</strong>ã€‚èª¬æ˜å¤‰æ•°ãŒè¤‡æ•°ã‚ã‚‹ã¨<strong>é‡å›å¸°</strong>ã€‚</p>

</section>
<section>
<h2 id="è¤‡æ•°ã®èª¬æ˜å¤‰æ•°ã‚’åŒæ™‚ã«æ‰±ã†é‡å›å¸°">è¤‡æ•°ã®èª¬æ˜å¤‰æ•°ã‚’åŒæ™‚ã«æ‰±ã†é‡å›å¸°</h2>
<p>\[\begin{split}
y_i &\sim \text{Poisson}(\lambda_i) \\
\log(\lambda_i) &= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \ldots
\end{split}\]</p>
<p>æ°—æ¸©ã‚‚æ¹¿åº¦ã‚‚é«˜ã„ã»ã©ãƒ“ãƒ¼ãƒ«ãŒå£²ã‚Œã‚‹æ¶ç©ºãƒ‡ãƒ¼ã‚¿:</p>
<img src="./figure/multiple-regression-1.png" alt="plot of chunk multiple-regression" width="720" />
<p>ã»ã‹ã®<strong>ç¢ºç‡åˆ†å¸ƒ</strong>ã¨<strong>ãƒªãƒ³ã‚¯é–¢æ•°</strong>ã‚’ä½¿ã†ä¾‹ã‚’è¦‹ã¦ã¿ã‚ˆã†ã€‚</p>

</section>
<section>
<h2 id="ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°">ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</h2>
<ul>
<li>ç¢ºç‡åˆ†å¸ƒ: <strong>äºŒé …åˆ†å¸ƒ</strong></li>
<li>ãƒªãƒ³ã‚¯é–¢æ•°: $\text{logit}(p) = \log \frac {p} {1 - p}$</li>
</ul>
<p>ä½•ã‹ã®æˆå¦ã«å¯¾ã™ã‚‹ä½•ã‹ã®å› å­ã®å½±éŸ¿ã€ã¨ã‹</p>
<div class="column-container">
  <div class="column" style="flex-shrink: 1.0; padding-top: 1rem;">
<p>å®¢10äººä¸­$y_i$äººãŒãƒ“ãƒ¼ãƒ«ã‚’æ³¨æ–‡ã€‚<br>
ãã®æ—¥$i$ã®æ°—æ¸©$x_i$ã«ã‚ˆã£ã¦å‰²åˆãŒå¤‰åŒ–ã€‚</p>
<p>\[\begin{split}
y_i &\sim \text{Binomial}(n,~p_i) \\
\text{logit}(p_i) &= \beta_0 + \beta_1 x_i \\
p_i &= \frac 1 {1 + e^{-(\beta_0 + \beta_1 x_i)}}
\end{split}\]</p>
<p>ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯é–¢æ•°â†‘</p>
  </div>
  <div class="column" style="flex-shrink: 1.0;">
<img src="./figure/glm-logistic-1.png" alt="plot of chunk glm-logistic" width="360" />
  </div>
</div>

</section>
<section>
<h2 id="ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°-ç‹­ç¾©">ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸° (ç‹­ç¾©)</h2>
<ul>
<li>ç¢ºç‡åˆ†å¸ƒ: <strong>ãƒ™ãƒ«ãƒŒãƒ¼ã‚¤åˆ†å¸ƒ</strong> ($n = 1$ ã®äºŒé …åˆ†å¸ƒ)</li>
<li>ãƒªãƒ³ã‚¯é–¢æ•°: $\text{logit}(p) = \log \frac {p} {1 - p}$</li>
</ul>
<p>ä½•ã‹ã®æˆå¦ã«å¯¾ã™ã‚‹ä½•ã‹ã®å› å­ã®å½±éŸ¿ã€ã¨ã‹</p>
<div class="column-container">
  <div class="column" style="flex-shrink: 1.0; padding-top: 1rem;">
<p>é¢¨ãŒå¹ã‘ã°æ¡¶å±‹ãŒå„²ã‹ã‚‹ã€‚</p>
<p>\[\begin{split}
y_i &\sim \text{Bernoulli}(p_i) \\
  &= \text{Binomial}(1,~p_i) \\
\text{logit}(p_i) &= \beta_0 + \beta_1 x_i \\
p_i &= \frac 1 {1 + e^{-(\beta_0 + \beta_1 x_i)}}
\end{split}\]</p>
<p>ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯é–¢æ•°â†‘</p>
  </div>
  <div class="column" style="flex-shrink: 1.0;">
<img src="./figure/wind-1.png" alt="plot of chunk wind" width="360" />
  </div>
</div>

</section>
<section>
<h2 id="ä¸€èˆ¬ç·šå½¢ãƒ¢ãƒ‡ãƒ«-åŒ–ç„¡ã—-ã¯glmã®ä¸€ç¨®">ä¸€èˆ¬ç·šå½¢ãƒ¢ãƒ‡ãƒ« (â€œåŒ–â€ç„¡ã—) ã¯GLMã®ä¸€ç¨®</h2>
<ul>
<li>ç¢ºç‡åˆ†å¸ƒ: <strong>æ­£è¦åˆ†å¸ƒ</strong></li>
<li>ãƒªãƒ³ã‚¯é–¢æ•°: <strong>æ’ç­‰é–¢æ•°</strong>(ãªã«ã‚‚ã›ãšãã®ã¾ã¾)</li>
</ul>
<div class="column-container">
  <div class="column" style="flex-shrink: 1.0; padding-top: 1rem;">
<p>\[\begin{split}
y_i &\sim \mathcal{N}(\mu_i,~\sigma^2) \\
\text{identity}(\mu_i) &= \beta_0 + \beta_1 x_i
\end{split}\]</p>
  </div>
  <div class="column" style="flex-shrink: 1.0;">
<img src="./figure/glm-weight-1.png" alt="plot of chunk glm-weight" width="288" />
  </div>
</div>
<p>æœ€å°äºŒä¹—æ³•ã®ç›´ç·šã‚ã¦ã¯ã‚ã¨çµæœçš„ã«åŒã˜ã«ãªã‚‹ã€‚</p>
<p><small style="color: #999999;">å˜å›å¸°ãƒ»é‡å›å¸°ã¨è¨€ã£ãŸã¨ãä¸€èˆ¬ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã‚’å‰æã¨ã™ã‚‹äººã‚‚ã„ã‚‹ã€‚</small></p>

</section>
<section>
<h2 id="åˆ†æ•£åˆ†æ-uanualysis-uouf-uvauriance-anova-as-glm">åˆ†æ•£åˆ†æ (<u>An</u>alysis <u>o</u>f <u>va</u>riance, ANOVA) as GLM</h2>
<p><strong>è³ªçš„ãªèª¬æ˜å¤‰æ•°</strong>ã‚’æŒã¤<strong>æ­£è¦åˆ†å¸ƒãƒ»æ’ç­‰ãƒªãƒ³ã‚¯</strong>ã®GLMã€ã¨è§£é‡ˆå¯èƒ½ã€‚<br>
<span title="ãƒ€ãƒŸãƒ¼å¤‰æ•°ã¨ã‚‚å‘¼ã°ã‚Œã‚‹"><strong>æŒ‡ç¤ºå¤‰æ•°</strong></span> (0 or 1) ã«å¤‰æ›ã—ã¦ã‹ã‚‰é‡å›å¸°ã™ã‚‹ã€‚</p>
<div class="column-container">
  <div class="column" style="flex-shrink: 1.0; padding-top: 1rem;">
<table>
<thead>
<tr>
<th>å¤©æ°—</th>
<th style="text-align:center">â†’</th>
<th style="text-align:center">$x_1$ â˜€ï¸ æ™´ã‚Œ</th>
<th style="text-align:center">$x_2$ â˜”ï¸ é›¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>â˜ï¸ ãã‚‚ã‚Š</td>
<td style="text-align:center"></td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td>â˜€ï¸ æ™´ã‚Œ</td>
<td style="text-align:center"></td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td>â˜”ï¸ é›¨</td>
<td style="text-align:center"></td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
</tr>
</tbody>
</table>
<p>\[\begin{split}
y_i &\sim \mathcal{N}(\mu_i,\sigma^2) \\
\mu_i &= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i}
\end{split}\]</p>
  </div>
  <div class="column" style="flex-shrink: 1.3;">
<img src="./figure/glm-anova-1.png" alt="plot of chunk glm-anova" width="324" />
  </div>
</div>
<p>ãã‚‚ã‚Šâ˜ï¸ $\beta_0$ ã‚’åŸºæº–ã«ã€æ™´ã‚Œã®åŠ¹æœâ˜€ï¸ $\beta_1$ ã¨é›¨ã®åŠ¹æœâ˜”ï¸ $\beta_2$ ãŒæ±‚ã¾ã‚‹ã€‚</p>
<p>GLMãªã‚‰ç¢ºç‡åˆ†å¸ƒãƒ»ãƒªãƒ³ã‚¯é–¢æ•°ã‚’å¤‰ãˆã¦ã‚‚ã£ã¨æŸ”è»Ÿã«ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã§ãã‚‹ã€‚</p>

</section>
<section>
<h2 id="å…±åˆ†æ•£åˆ†æ-uanualysis-of-ucovauriance-ancova-as-glm">å…±åˆ†æ•£åˆ†æ (<u>An</u>alysis of <u>cova</u>riance, ANCOVA) as GLM</h2>
<p><strong>è³ªçš„å¤‰æ•°ã¨é‡çš„å¤‰æ•°ã‚’ä¸¡æ–¹</strong>å«ã‚€GLMã€ã¨è§£é‡ˆå¯èƒ½ã€‚<br>
æ­£è¦åˆ†å¸ƒãƒ»ç­‰åˆ†æ•£ãƒ»æ’ç­‰ãƒªãƒ³ã‚¯ãªã©ãŒä»®å®šã•ã‚Œã‚‹ã€‚</p>
<div class="column-container">
  <div class="column" style="flex-shrink: 1.0; padding-top: 1rem;">
<table>
<thead>
<tr>
<th>å¤©æ°—</th>
<th style="text-align:center">â†’</th>
<th style="text-align:center">$x_1$ â˜€ï¸ æ™´ã‚Œ</th>
<th style="text-align:center">$x_2$ â˜”ï¸ é›¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>â˜ï¸ ãã‚‚ã‚Š</td>
<td style="text-align:center"></td>
<td style="text-align:center">0</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td>â˜€ï¸ æ™´ã‚Œ</td>
<td style="text-align:center"></td>
<td style="text-align:center">1</td>
<td style="text-align:center">0</td>
</tr>
<tr>
<td>â˜”ï¸ é›¨</td>
<td style="text-align:center"></td>
<td style="text-align:center">0</td>
<td style="text-align:center">1</td>
</tr>
</tbody>
</table>
<p>\[\begin{split}
y_i &\sim \mathcal{N}(\mu_i,\sigma^2) \\
\mu_i &= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_3 x_{3i}
\end{split}\]</p>
  </div>
  <div class="column" style="flex-shrink: 1.3;">
<img src="./figure/glm-ancova-1.png" alt="plot of chunk glm-ancova" width="324" />
  </div>
</div>
<p>GLMãªã‚‰ç¢ºç‡åˆ†å¸ƒãƒ»ãƒªãƒ³ã‚¯é–¢æ•°ã‚’å¤‰ãˆã¦ã‚‚ã£ã¨æŸ”è»Ÿã«ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã§ãã‚‹ã€‚</p>

</section>
<section>
<h2 id="äº¤äº’ä½œç”¨">äº¤äº’ä½œç”¨</h2>
<p>ã‚ã‚‹èª¬æ˜å¤‰æ•°ã®åŠ¹æœãŒã€åˆ¥ã®èª¬æ˜å¤‰æ•°ã«ã‚ˆã£ã¦ç•°ãªã‚‹ã€‚<br>
e.g., ãƒ“ãƒ¼ãƒ«å£²ä¸Šã®æ¸©åº¦ä¾å­˜æ€§ãŒå¤©æ°—ã«ã‚ˆã£ã¦ç•°ãªã‚‹ã€‚</p>
<div class="column-container">
  <div class="column" style="flex-shrink: 1.0; padding-top: 0.1rem;">
<table>
<thead>
<tr>
<th>å¤©æ°—</th>
<th style="text-align:center">$x_1$</th>
</tr>
</thead>
<tbody>
<tr>
<td>â˜€ï¸ æ™´ã‚Œ</td>
<td style="text-align:center">1</td>
</tr>
<tr>
<td>â˜”ï¸ é›¨</td>
<td style="text-align:center">0</td>
</tr>
</tbody>
</table>
<p>\[\begin{split}
y_i &\sim \mathcal{N}(\mu_i,\sigma^2) \\
\mu_i &= \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \beta_{1,2} x_{1i} x_{2i}
\end{split}\]</p>
<p>é›¨ã®æ—¥ã¯ $x_{1i} = 0$ ã®ãŸã‚ $\beta_0,~\beta_2$ ã®é …ã ã‘ã€‚<br>
æ™´ã‚Œã®æ—¥ã¯ãã‚Œã«åŠ ãˆã¦ $\beta_1,~\beta_{1,2}$ ã®é …ã‚‚ã€‚</p>
  </div>
  <div class="column" style="flex-shrink: 1.3;">
<img src="./figure/interaction-1.png" alt="plot of chunk interaction" width="324" />
  </div>
</div>
<p>è§£é‡ˆãŒä¸€æ°—ã«é›£ã—ããªã‚‹ã®ã§ã‚€ã‚„ã¿ã«ä½¿ã‚ãªã„ã€‚</p>

</section>
<section>
<h2 id="ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«glmãµã‚Šã‹ãˆã‚Š">ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«(GLM)ãµã‚Šã‹ãˆã‚Š</h2>
<p>ç¢ºç‡åˆ†å¸ƒãƒ»ãƒªãƒ³ã‚¯é–¢æ•°ã‚’å¤‰ãˆã¦æŸ”è»Ÿã«ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã§ãã‚‹ã€‚<br>
ç‰¹å®šã®çµ„ã¿åˆã‚ã›ã«ã¯åå‰ãŒã‚ã‚‹ã€‚</p>
<table>
<thead>
<tr>
<th>åå‰</th>
<th>ç¢ºç‡åˆ†å¸ƒ</th>
<th>ãƒªãƒ³ã‚¯é–¢æ•°</th>
<th>èª¬æ˜å¤‰æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒã‚¢ã‚½ãƒ³å›å¸°</td>
<td>ãƒã‚¢ã‚½ãƒ³åˆ†å¸ƒ</td>
<td>log</td>
<td></td>
</tr>
<tr>
<td>ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</td>
<td>äºŒé …åˆ†å¸ƒ</td>
<td>logit</td>
<td></td>
</tr>
<tr>
<td>ä¸€èˆ¬ç·šå½¢å›å¸°</td>
<td>æ­£è¦åˆ†å¸ƒ</td>
<td>æ’ç­‰</td>
<td></td>
</tr>
<tr>
<td>åˆ†æ•£åˆ†æ</td>
<td>æ­£è¦åˆ†å¸ƒ</td>
<td>æ’ç­‰</td>
<td>è³ªçš„å¤‰æ•°</td>
</tr>
<tr>
<td>å…±åˆ†æ•£åˆ†æ</td>
<td>æ­£è¦åˆ†å¸ƒ</td>
<td>æ’ç­‰</td>
<td>è³ªçš„å¤‰æ•°+é‡çš„å¤‰æ•°</td>
</tr>
</tbody>
</table>
<p>ç¢ºç‡åˆ†å¸ƒã«ã¤ã„ã¦ã¯<a href="2-stats-model.html">å‰ç« ã‚’å‚ç…§</a>ã€‚<br>
ãƒªãƒ³ã‚¯é–¢æ•°ã‚’ã‚‚ã†å°‘ã—ã ã‘æ˜ã‚Šä¸‹ã’ãŸã„ã€‚</p>

</section>
<section>
<h2 id="ãƒªãƒ³ã‚¯é–¢æ•°">ãƒªãƒ³ã‚¯é–¢æ•°</h2>
<p>çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã«ãŠã„ã¦ã€Œã¾ã£ã™ãä»¥å¤–ã‚‚è¡¨ç¾ã§ãã‚‹ã€æ„å‘³</p>
<dl>
<dt>$\text{identity}(\mu_i)$</dt>
<dd>$\mu_i = \beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \ldots$</dd>
<dd>èª¬æ˜å¤‰æ•°ã®åŠ¹æœãŒ<strong>è¶³ã—ç®—</strong>çš„ã«åƒãã€‚</dd>
<dt>$\log(\lambda_i)$</dt>
<dd>$\lambda_i = e^{\beta_0 + \beta_1 x_{1i} + \beta_2 x_{2i} + \ldots} = e^{\beta_0} \times e^{\beta_1 x_{1i}} \times e^{\beta_2 x_{2i}} \times \ldots$</dd>
<dd>èª¬æ˜å¤‰æ•°ã®åŠ¹æœãŒ<strong>æ›ã‘ç®—</strong>çš„ã«åƒãã€‚<br>
e.g., $\Delta x_1$ å¢—ãˆã‚‹ã¨ $e^{\beta_1 \Delta x_{1}}$ å€ã«ãªã‚‹</dd>
<dt>$\text{logit}(p_i)$</dt>
<dd>$p_i = \frac 1 {1 + e^{-(\beta_0 + \beta_1 x_i + \ldots)}} $ (ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯é–¢æ•°)</dd>
<dd>èª¬æ˜å¤‰æ•°ã®åŠ¹æœãŒ<strong>é ­æ‰“ã¡</strong>ã«ãªã‚‹ã€‚<br>
e.g., $\lim_{x \to -\infty} p = 0;~\lim_{x \to \infty} p = 1$</dd>
</dl>
<p>ã»ã‹ã« <code>probit</code>, <code>inverse</code>, <code>sqrt</code>, etc.</p>

</section>
<section>
<h2 id="rã«ãŠã‘ã‚‹glmã®ã‚„ã‚Šã‹ãŸ">Rã«ãŠã‘ã‚‹GLMã®ã‚„ã‚Šã‹ãŸ</h2>
<p>ç›´ç·šå›å¸°ã®ã¨ãã® <code>lm</code> ã¨ã»ã¼åŒã˜ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">formula</span> <span class="o">=</span> <span class="n">weight</span> <span class="o">~</span> <span class="n">height</span>
</span></span><span class="line"><span class="cl"><span class="n">fit</span> <span class="o">=</span> <span class="nf">glm</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df_weight</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">coef</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>(Intercept)      height 
  -69.85222    78.63444 
</code></pre><p>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯æ­£è¦åˆ†å¸ƒãƒ»æ’ç­‰ãƒªãƒ³ã‚¯ã§ <code>lm</code> ã¨åŒã˜çµæœã€‚<br>
<code>family=</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ç¢ºç‡åˆ†å¸ƒã¨ãƒªãƒ³ã‚¯é–¢æ•°ã‚’æ˜ç¤ºçš„ã«æŒ‡å®š:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">glm</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="nf">gaussian</span><span class="p">(</span><span class="n">link</span> <span class="o">=</span> <span class="n">identity</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydata</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">glm</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="nf">poisson</span><span class="p">(</span><span class="n">link</span> <span class="o">=</span> <span class="n">log</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydata</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">glm</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="nf">binomial</span><span class="p">(</span><span class="n">link</span> <span class="o">=</span> <span class="n">logit</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mydata</span><span class="p">)</span>
</span></span></code></pre></div><p>See <a href="https://stat.ethz.ch/R-manual/R-patched/library/stats/html/family.html"><code>?family</code></a> for more details.</p>

</section>
<section>
<h2 id="-ã¨ã«ã‹ãglmã‚’ä½¿ã£ã¦ã¿ã‚‹ç·´ç¿’">ğŸ”° ã¨ã«ã‹ãGLMã‚’ä½¿ã£ã¦ã¿ã‚‹ç·´ç¿’</h2>
<p>ã¨ã‚Šã‚ãˆãšå½“ã¦ã¯ã‚ã¨ä½œå›³ã ã‘ã€‚<br>
çµæœã®è§£é‡ˆã‚„ãƒ¢ãƒ‡ãƒ«ã®è©•ä¾¡ã¯ã“ã®å¾Œã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="m">50</span>
</span></span><span class="line"><span class="cl"><span class="n">df_weight</span> <span class="o">=</span> <span class="n">tibble</span><span class="o">::</span><span class="nf">tibble</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">height</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="m">1.70</span><span class="p">,</span> <span class="m">0.05</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">bmi</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="m">22</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">weight</span> <span class="o">=</span> <span class="n">bmi</span> <span class="o">*</span> <span class="p">(</span><span class="n">height</span><span class="o">**</span><span class="m">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>     height      bmi   weight
 1 1.718019 21.55500 63.62151
 2 1.782862 22.83775 72.59199
 3 1.617464 22.43569 58.69604
 4 1.678291 23.37245 65.83231
--                           
47 1.762930 21.78337 67.70106
48 1.744133 21.47257 65.31960
49 1.730495 19.72866 59.07966
50 1.676496 22.85824 64.24627
</code></pre>
</section>
<section>
<h2 id="-ãƒã‚¢ã‚½ãƒ³å›å¸°">ğŸ”° ãƒã‚¢ã‚½ãƒ³å›å¸°</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="m">300L</span>
</span></span><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="m">3</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="m">-3</span>
</span></span><span class="line"><span class="cl"><span class="n">df_seeds</span> <span class="o">=</span> <span class="n">tibble</span><span class="o">::</span><span class="nf">tibble</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">body_mass</span> <span class="o">=</span> <span class="nf">runif</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="m">0.4</span><span class="p">,</span> <span class="m">1.7</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">num_seeds</span> <span class="o">=</span> <span class="nf">rpois</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nf">exp</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">body_mass</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>    body_mass num_seeds
  1 0.9185923         1
  2 0.5154446         0
  3 1.3362802         4
  4 1.6858125        11
 --                    
297 1.3407210         3
298 1.3357421         1
299 0.8928759         0
300 0.4583795         0
</code></pre>
</section>
<section>
<h2 id="-é‡å›å¸°">ğŸ”° é‡å›å¸°</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="m">200L</span>
</span></span><span class="line"><span class="cl"><span class="n">true_coef</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="m">0.05</span><span class="p">,</span> <span class="m">0.006</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_beer</span> <span class="o">=</span> <span class="n">tibble</span><span class="o">::</span><span class="nf">tibble</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">temperature</span> <span class="o">=</span> <span class="nf">runif</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">32</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">humidity</span> <span class="o">=</span> <span class="nf">runif</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">80</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">beer_sales</span> <span class="o">=</span> <span class="nf">rpois</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nf">exp</span><span class="p">(</span><span class="n">true_coef[1]</span> <span class="o">+</span> <span class="n">true_coef[2]</span> <span class="o">*</span> <span class="n">temperature</span> <span class="o">+</span> <span class="n">true_coef[3]</span> <span class="o">*</span> <span class="n">humidity</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>    temperature humidity beer_sales
  1    17.57401 54.68339         67
  2    10.13129 67.34727         55
  3    25.28517 40.93855        104
  4    31.73808 32.14308        113
 --                                
197    26.28116 41.89173        105
198    23.53532 73.12257        113
199    13.87494 41.92560         51
200    31.60519 61.47984        140
</code></pre>
</section>
<section>
<h2 id="-ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°">ğŸ”° ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">sigmoid</span> <span class="o">=</span> <span class="nf">function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">gain</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span><span class="m">1</span> <span class="o">/</span> <span class="p">(</span><span class="m">1</span> <span class="o">+</span> <span class="nf">exp</span><span class="p">(</span><span class="o">-</span><span class="n">gain</span> <span class="o">*</span> <span class="n">x</span><span class="p">))}</span>
</span></span><span class="line"><span class="cl"><span class="n">nrep</span> <span class="o">=</span> <span class="m">200L</span>
</span></span><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="m">10L</span>
</span></span><span class="line"><span class="cl"><span class="n">df_logistic</span> <span class="o">=</span> <span class="n">tibble</span><span class="o">::</span><span class="nf">tibble</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">x</span> <span class="o">=</span> <span class="nf">runif</span><span class="p">(</span><span class="n">nrep</span><span class="p">,</span> <span class="m">-10</span><span class="p">,</span> <span class="m">35</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">logit_p</span> <span class="o">=</span> <span class="m">-3</span> <span class="o">+</span> <span class="m">0.3</span> <span class="o">*</span> <span class="n">x</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">p</span> <span class="o">=</span> <span class="nf">sigmoid</span><span class="p">(</span><span class="n">logit_p</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">y</span> <span class="o">=</span> <span class="nf">rbinom</span><span class="p">(</span><span class="n">nrep</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">response</span> <span class="o">=</span> <span class="nf">matrix</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="n">y</span><span class="p">),</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>            x    logit_p          p  y response[,1] [,2]
  1  7.951271 -0.6146188 0.35100632  4            4    6
  2 -6.003840 -4.8011520 0.00815325  0            0   10
  3 22.409698  3.7229095 0.97640654 10           10    0
  4 34.508895  7.3526686 0.99935953 10           10    0
 --                                                     
197 24.277180  4.2831541 0.98638875 10           10    0
198 19.128721  2.7386162 0.93926720  8            8    2
199  1.015520 -2.6953441 0.06324865  0            0   10
200 34.259733  7.2779199 0.99930986 10           10    0
</code></pre>
</section>
<section>
<h2 id="-å…±åˆ†æ•£åˆ†æ-glm-with-è³ªçš„å¤‰æ•°--é‡çš„å¤‰æ•°">ğŸ”° å…±åˆ†æ•£åˆ†æ: GLM with è³ªçš„å¤‰æ•° + é‡çš„å¤‰æ•°</h2>
<p>ã¾ãšã¯weatherã ã‘ã§åˆ†æ•£åˆ†æã€æ¬¡ã«temperatureã‚’å…¥ã‚Œã¦å…±åˆ†æ•£åˆ†æã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="m">200L</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">70</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">20</span><span class="p">,</span> <span class="m">-20</span><span class="p">)</span>  <span class="c1"># true coef</span>
</span></span><span class="line"><span class="cl"><span class="n">weather_levels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;sunny&#34;</span><span class="p">,</span> <span class="s">&#34;cloudy&#34;</span><span class="p">,</span> <span class="s">&#34;rainy&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_ancova</span> <span class="o">=</span> <span class="n">tibble</span><span class="o">::</span><span class="nf">tibble</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">temperature</span> <span class="o">=</span> <span class="nf">runif</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">32</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">weather</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="nf">sample</span><span class="p">(</span><span class="n">weather_levels</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">),</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">weather_levels</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">mutate</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="n">weather</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="m">1L</span><span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="n">tidyr</span><span class="o">::</span><span class="nf">pivot_wider</span><span class="p">(</span><span class="n">values_fill</span> <span class="o">=</span> <span class="m">0L</span><span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">select</span><span class="p">(</span><span class="o">!</span><span class="n">cloudy</span><span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">mutate</span><span class="p">(</span><span class="n">mu</span> <span class="o">=</span> <span class="n">b[1]</span> <span class="o">+</span> <span class="n">b[2]</span> <span class="o">*</span> <span class="n">temperature</span> <span class="o">+</span> <span class="n">b[3]</span> <span class="o">*</span> <span class="n">sunny</span> <span class="o">+</span> <span class="n">b[4]</span> <span class="o">*</span> <span class="n">rainy</span><span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">mutate</span><span class="p">(</span><span class="n">beer_sales</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>    temperature weather sunny rainy        mu beer_sales
  1   23.377217  cloudy     0     0 140.13165  129.36288
  2   26.043088  cloudy     0     0 148.12926  138.26966
  3   30.830351  cloudy     0     0 162.49105  141.46190
  4   15.022311  cloudy     0     0 115.06693  108.18593
 --                                                     
197    8.277514  cloudy     0     0  94.83254   74.38321
198   28.675228   rainy     0     1 136.02568  140.34777
199   27.310881   rainy     0     1 131.93264  122.31587
200   24.064285   sunny     1     0 162.19286  144.89368
</code></pre>
</section>
<section>
<h2 id="-äº¤äº’ä½œç”¨">ğŸ”° äº¤äº’ä½œç”¨</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">n</span> <span class="o">=</span> <span class="m">200L</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">70</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">100</span><span class="p">,</span> <span class="m">-2</span><span class="p">)</span>  <span class="c1"># true coef</span>
</span></span><span class="line"><span class="cl"><span class="n">weather_levels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;sunny&#34;</span><span class="p">,</span> <span class="s">&#34;rainy&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_interact</span> <span class="o">=</span> <span class="n">tibble</span><span class="o">::</span><span class="nf">tibble</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">temperature</span> <span class="o">=</span> <span class="nf">runif</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="m">32</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">    <span class="n">weather</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="nf">sample</span><span class="p">(</span><span class="n">weather_levels</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">),</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">weather_levels</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">mutate</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="n">weather</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="m">1L</span><span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="n">tidyr</span><span class="o">::</span><span class="nf">pivot_wider</span><span class="p">(</span><span class="n">values_fill</span> <span class="o">=</span> <span class="m">0L</span><span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">mutate</span><span class="p">(</span><span class="n">mu</span> <span class="o">=</span> <span class="n">b[1]</span> <span class="o">*</span> <span class="n">sunny</span> <span class="o">+</span> <span class="n">b[2]</span> <span class="o">*</span> <span class="n">temperature</span> <span class="o">+</span> <span class="n">b[3]</span> <span class="o">*</span> <span class="n">rainy</span> <span class="o">+</span> <span class="n">b[4]</span> <span class="o">*</span> <span class="n">temperature</span> <span class="o">*</span> <span class="n">rainy</span><span class="p">)</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">mutate</span><span class="p">(</span><span class="n">beer_sales</span> <span class="o">=</span> <span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="m">10</span><span class="p">))</span> <span class="o">|&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>    temperature weather rainy sunny        mu beer_sales
  1   23.377217   rainy     1     0 123.37722   116.2995
  2   26.043088   rainy     1     0 126.04309   133.9018
  3   30.830351   rainy     1     0 130.83035   130.6798
  4   15.022311   rainy     1     0 115.02231   117.5620
 --                                                     
197    8.277514   sunny     0     1  94.83254   104.2573
198   28.675228   sunny     0     1 156.02568   155.3134
199   27.310881   rainy     1     0 127.31088   131.0297
200   24.064285   sunny     0     1 142.19286   142.8241
</code></pre>
</section>
<section>
<h2 id="ãƒ‡ãƒ¼ã‚¿ã¯ã²ã¨ã¤ãƒ¢ãƒ‡ãƒ«ã¯ãŸãã•ã‚“">ãƒ‡ãƒ¼ã‚¿ã¯ã²ã¨ã¤ã€ãƒ¢ãƒ‡ãƒ«ã¯ãŸãã•ã‚“</h2>
<p>ã©ã†é¸ã¶ï¼Ÿ</p>
<ol>
<li>ãƒ¡ã‚«ãƒ‹ã‚ºãƒ çš„ã«ç´å¾—ã§ãã‚‹ã‚‚ã®ã‚’é¸ã¶
<ul>
<li>ãƒã‚¢ã‚½ãƒ³éç¨‹ã®<strong>ã‚«ã‚¦ãƒ³ãƒˆ</strong>ãªã‚‰ãƒã‚¢ã‚½ãƒ³åˆ†å¸ƒã€<strong>é–“éš”</strong>ãªã‚‰ã‚¬ãƒ³ãƒåˆ†å¸ƒ</li>
<li>nå›ä¸­kå›ã®ã‚ˆã†ã«<strong>å‰²åˆçš„ãªã‚«ã‚¦ãƒ³ãƒˆ</strong>ãªã‚‰äºŒé …åˆ†å¸ƒ</li>
</ul>
</li>
<li>ãƒ‡ãƒ¼ã‚¿ã‚’å¯è¦–åŒ–ã—ã¦ã¿ã¦ã€ãã‚Œã£ã½ã„å½¢ãƒ»æ€§è³ªã®ã‚‚ã®ã‚’é¸ã¶
<ul>
<li><strong>å·¦å³å¯¾ç§°ã®ã²ã¨å±±</strong>ãªã‚‰ã¨ã‚Šã‚ãˆãšæ­£è¦åˆ†å¸ƒ</li>
<li><strong>è² ã®å€¤ã‚’å–ã‚‰ãªã„</strong>ãªã‚‰ã‚¬ãƒ³ãƒåˆ†å¸ƒ</li>
<li>ç›´ç·šçš„ã‹ã€æŒ‡æ•°é–¢æ•°çš„ã‹ã€é ­æ‰“ã¡ã‹ã€ãªã©ãªã©</li>
</ul>
</li>
</ol>
<p>å®¢è¦³çš„ãªæŒ‡æ¨™ã‚‚ã»ã—ã„ã€‚<br>
ãƒ¢ãƒ‡ãƒ«ã®å°¤ã‚‚ã‚‰ã—ã•ã¨ã„ãˆã°&hellip;</p>

</section>
<section>
<h2 id="rubyå°¤rtã‚†ã†rtåº¦ruby-likelihood"><ruby>å°¤<rt>ã‚†ã†</rt>åº¦</ruby> (likelihood)</h2>
<p><strong>ã‚ã‚‹ãƒ¢ãƒ‡ãƒ«$M$ã®ä¸‹ã§ãã®ãƒ‡ãƒ¼ã‚¿$D$ãŒè¦³å¯Ÿã•ã‚Œã‚‹ç¢ºç‡</strong>:<br>
$\text{Prob}(D \mid M)$</p>
<p>ãƒ‡ãƒ¼ã‚¿$D$ã‚’å›ºå®šã—ã€ãƒ¢ãƒ‡ãƒ«$M$ã®é–¢æ•°ã¨ã¿ãªã—ãŸã‚‚ã®ãŒ<strong>å°¤åº¦é–¢æ•°</strong>:<br>
$L(M \mid D)$</p>
<p>ãƒ¢ãƒ‡ãƒ«ã®æ§‹é€ ã‚‚å›ºå®šã—ã¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿$\theta$ã ã‘å‹•ã‹ã™å ´åˆã¯ã“ã†æ›¸ã:<br>
$L(\theta \mid D)$ or $L(\theta)$</p>
<p><strong>å¯¾æ•°å°¤åº¦</strong> $\log L$ ã®å½¢ã«ã—ãŸã»ã†ãŒã„ã‚ã„ã‚ä¾¿åˆ©ã€‚</p>
<hr>
<p>å„ãƒ¢ãƒ‡ãƒ«ã§æœ€é©ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¢ã—ã¦ã€æ¯”è¼ƒ:<br>
$\log L^* (M_1) \text{ vs. } \log L^* (M_2) \text{ vs. } \log L^* (M_3) \ldots$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">broom</span><span class="o">::</span><span class="nf">glance</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>  null.deviance df.null    logLik      AIC      BIC deviance df.residual nobs
1      1305.043      49 -124.9298 255.8597 261.5957 433.2606          48   50
</code></pre>
</section>
<section>
<h2 id="ãŸã—ã‹ã«å°¤åº¦ã¯ã‚ã¦ã¯ã¾ã‚Šã®è‰¯ã•ã‚’è¡¨ã—ã¦ãã†">ãŸã—ã‹ã«å°¤åº¦ã¯ã‚ã¦ã¯ã¾ã‚Šã®è‰¯ã•ã‚’è¡¨ã—ã¦ãã†</h2>
<p>ã“ã®å ´åˆã¯ç›´ç·šå›å¸°ã‚ˆã‚Šã‚‚ãƒã‚¢ã‚½ãƒ³å›å¸°ãŒè‰¯ã•ãã†:</p>
<img src="./figure/compare-loglik-1.png" alt="plot of chunk compare-loglik" width="648" />
<p>ã“ã®èª¿å­ã§ã€ã‚ˆã‚Šå°¤åº¦ã®é«˜ã„ãƒ¢ãƒ‡ãƒ«ã‚’æ¢ã—ã¦ã„ã‘ã°ã„ã„ã ã‚ã†ã‹ï¼Ÿ</p>

</section>
<section>
<h2 id="ã‚ã¦ã¯ã¾ã‚ŠãŒè‰¯ã‘ã‚Œã°ã„ã„ã£ã¦ã‚‚ã‚“ã§ã‚‚ãªã„">ã‚ã¦ã¯ã¾ã‚ŠãŒè‰¯ã‘ã‚Œã°ã„ã„ã£ã¦ã‚‚ã‚“ã§ã‚‚ãªã„</h2>
<dl>
<dt>éå‰°é©åˆ / éå­¦ç¿’ / overfitting</dt>
<dd>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å¢—ã‚„ã›ã°<strong>ç¾ãƒ‡ãƒ¼ã‚¿ã¸ã®</strong>é©åˆåº¦ãƒ»å°¤åº¦ã‚’é«˜ãã§ãã‚‹ãŒã€<br>
äºˆæ¸¬ãƒ»ç†è§£ã®å½¹ã«ã¯ç«‹ãŸãªããªã‚‹ã€‚</dd>
</dl>
<img src="./figure/saturated-model-1.png" alt="plot of chunk saturated-model" width="792" />
<p><strong>å¸°ç„¡ãƒ¢ãƒ‡ãƒ«</strong>: èª¬æ˜å¤‰æ•°ãªã—ã€‚åˆ‡ç‰‡ã®ã¿ã€‚<br>
<strong>é£½å’Œãƒ¢ãƒ‡ãƒ«</strong>: ãƒ‡ãƒ¼ã‚¿ç‚¹ã®æ•° â‰¤ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ•°ã€‚â€œãƒ‡ãƒ¼ã‚¿èª­ã¿ä¸Šã’â€çš„ãƒ¢ãƒ‡ãƒ«
</section>
<section>
<h2 id="ç„¡é§„ãªèª¬æ˜å¤‰æ•°ã‚’åŠ ãˆã¦ã‚‚å°¤åº¦ã¯ä¸ŠãŒã‚‹">ç„¡é§„ãªèª¬æ˜å¤‰æ•°ã‚’åŠ ãˆã¦ã‚‚å°¤åº¦ã¯ä¸ŠãŒã‚‹</h2>
<p>ã‚ã‚‹æ¤ç‰©ãŒä½œã‚‹ç¨®ã®æ•° $y$ ã¯å€‹ä½“ã®ã‚µã‚¤ã‚º $x$ ã«å¿œã˜ã¦å¢—ãˆã‚‹ã€‚<br>
è¦³å¯Ÿæ™‚ã«ç€ã¦ãŸæœã®è‰² $x_2$ ã‚’è¿½åŠ ã™ã‚‹ã¨å°¤åº¦ãŒä¸ŠãŒã‚‹&hellip;&hellip;?</p>
<img src="./figure/many-models-1.png" alt="plot of chunk many-models" width="504" />
</section>
<section>
<h2 id="aic-èµ¤æ± æƒ…å ±é‡åŸºæº–">AIC: èµ¤æ± æƒ…å ±é‡åŸºæº–</h2>
<p>\[\begin{split}
\text{AIC} = -2 (\log L^* - k) = -2 \log L^* + 2k
\end{split}\]</p>
<ul>
<li><strong>AICãŒå°ã•ã„ã»ã©äºˆæ¸¬ç²¾åº¦ã®è‰¯ã„ãƒ¢ãƒ‡ãƒ«</strong>ã€‚
<ul>
<li>å°¤åº¦ã¯ä¸Šã’ãŸã„ã€‚</li>
<li>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•° $k$ ãŒå¢—ãˆã‚‹ã¨ãƒšãƒŠãƒ«ãƒ†ã‚£ã€‚</li>
</ul>
</li>
<li>ã©ã®ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã™ã‚‹å½“ã¦ã¯ã¾ã‚Šã‚’ç›®æŒ‡ã™ã‹ã¨ã„ã†è¦³ç‚¹
<ul>
<li>ã€Œæ‰‹å…ƒã®ãƒ‡ãƒ¼ã‚¿ã€ã«å¯¾ã™ã‚‹å¯¾æ•°å°¤åº¦ã¯ $\log L^*$<br></li>
<li>ã€ŒçœŸã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‹ã‚‰å‡ºã¦ãã‚‹æœªæ¥ã®ãƒ‡ãƒ¼ã‚¿ã€ã«å¯¾ã™ã‚‹<br>
å¹³å‡å¯¾æ•°å°¤åº¦ã®æ¨å®šé‡ã¯ $(\log L^* - k)$<br>
(Kullback&ndash;Leibleræƒ…å ±é‡ã‚’ä½¿ã£ã¦å°å‡ºã™ã‚‹ã‚‰ã—ã„)</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">broom</span><span class="o">::</span><span class="nf">glance</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>  null.deviance df.null    logLik      AIC      BIC deviance df.residual nobs
1      1305.043      49 -124.9298 255.8597 261.5957 433.2606          48   50
</code></pre>
</section>
<section>
<h2 id="ç„¡é§„ãªèª¬æ˜å¤‰æ•°ã®è¿½åŠ ã§aicå¢—åŠ ">ç„¡é§„ãªèª¬æ˜å¤‰æ•°ã®è¿½åŠ ã§AICå¢—åŠ </h2>
<p>ã‚ã‚‹æ¤ç‰©ãŒä½œã‚‹ç¨®ã®æ•° $y$ ã¯å€‹ä½“ã®ã‚µã‚¤ã‚º $x$ ã«å¿œã˜ã¦å¢—ãˆã‚‹ã€‚<br>
è¦³å¯Ÿæ™‚ã«ç€ã¦ãŸæœã®è‰² $x_2$ ã‚’è¿½åŠ ã—ãŸãƒ¢ãƒ‡ãƒ«ã¯AICãŒå¢—åŠ ã€‚</p>
<img src="./figure/many-models-aic-1.png" alt="plot of chunk many-models-aic" width="504" />
</section>
<section>
<h2 id="ã»ã‹ã®æƒ…å ±é‡åŸºæº–">ã»ã‹ã®æƒ…å ±é‡åŸºæº–</h2>
<ul>
<li>$\text{BIC} = -2 \log L^* + k \log n$
<ul>
<li>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•° $k$ ã§ãƒšãƒŠãƒ«ãƒ†ã‚£ã‚’ä»˜ã‘ã‚‹ã®ã¯AICã¨åŒã˜ã€‚</li>
<li>ãƒ‡ãƒ¼ã‚¿ã®è¦³æ¸¬æ•° $n$ ã«ä¾å­˜ã™ã‚‹ç‚¹ã§AICã¨ç•°ãªã‚‹ã€‚<br>
æ„Ÿè¦šã¨ã—ã¦ã¯ã€ŒAICã¯ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºã«ã‚ˆã‚‹ãƒšãƒŠãƒ«ãƒ†ã‚£ãŒç„¡ã„ã€</li>
<li>(å‘¨è¾ºå°¤åº¦ã®æœ€å¤§åŒ–ã¨ã„ã†è¦³ç‚¹ã§å°å‡ºã™ã‚‹ã‚‰ã—ã„)</li>
</ul>
</li>
<li><a href="http://watanabe-www.math.dis.titech.ac.jp/users/swatanab/waic2011.html">WAIC</a>,
<a href="http://watanabe-www.math.dis.titech.ac.jp/users/swatanab/wbic2012.html">WBIC</a>
<ul>
<li>AIC, BICã‚’ä¸€èˆ¬åŒ–ã—ã€åºƒãä½¿ãˆã‚‹ã‚ˆã†ã«ã—ãŸã‚‚ã®ã€‚</li>
<li>ç†æƒ³çš„ãªæ¡ä»¶ã§ã¯ãã‚Œãã‚ŒAIC, BICã¨ã»ã¼åŒã˜ã€‚<br>
ãã†ã˜ã‚ƒãªã„å ´åˆ(ç¾å®Ÿçš„ã«ã¯å¸¸ã«)ã“ã¡ã‚‰ãŒå„ªä½ã€‚</li>
<li>WAICã¯äºˆæ¸¬ã®è‰¯ã•ã€WBICã¯çœŸã®ãƒ¢ãƒ‡ãƒ«ã¸ã®è¿‘ã•ã€ã‚’è¡¨ã™ã€‚</li>
</ul>
</li>
</ul>

</section>
<section>
<h2 id="ãƒ¢ãƒ‡ãƒ«é¸æŠã®å¿ƒæ§‹ãˆ">ãƒ¢ãƒ‡ãƒ«é¸æŠã®å¿ƒæ§‹ãˆ</h2>
<p>ã€Œæ­£ã—ã„ã€ã‚‚ã®ã‚’é¸ã¹ã‚‹ã‚ã‘ã§ã¯ãªã„ã€‚<br>
äºˆæ¸¬ãƒ»ç†è§£ã« useful ãªã‚‚ã®ã‚’ä½•ã‚‰ã‹ã®åŸºæº–ã§é¸ã¶ã ã‘ã€‚</p>
<blockquote>
<p>All models are wrong, but some are useful. &mdash; George E. P. Box</p>
</blockquote>
<figure>
<img src="../tokiomarine2021/math-model.drawio.svg" width="600"><br>
<figcaption><cite>ã€Œãƒ‡ãƒ¼ã‚¿åˆ†æã®ãŸã‚ã®æ•°ç†ãƒ¢ãƒ‡ãƒ«å…¥é–€ã€æ±Ÿå´è²´è£• 2020 ã‚ˆã‚Šæ”¹å¤‰</cite></figcaption>
</figure>

</section>
<section>
<h2 id="ç¾å®Ÿçš„ãªæ³¨æ„ç‚¹æ‚©ã¿ã©ã“ã‚">ç¾å®Ÿçš„ãªæ³¨æ„ç‚¹ãƒ»æ‚©ã¿ã©ã“ã‚</h2>
<ul>
<li>å¤šé‡å…±ç·šæ€§(multicollinearity):
<ul>
<li>èª¬æ˜å¤‰æ•°åŒå£«ãŒå¼·ã„ç›¸é–¢é–¢ä¿‚ã«ã‚ã‚‹</li>
</ul>
</li>
<li>å¤‰æ•°å¤‰æ›:
<ul>
<li>æ°—å®‰ãã‚„ã‚‹ã¹ãã˜ã‚ƒãªã„ã‘ã©ã€å¯¾æ•°å¤‰æ›ãªã©ã—ã°ã—ã°æœ‰ç”¨</li>
<li>å‰²ã‚Šç®—ã—ãŸå€¤ã¯å±é™º</li>
</ul>
</li>
<li>äº¤äº’ä½œç”¨ã‚’å…¥ã‚Œã‚‹ã¨è§£é‡ˆãŒé›£ã—ããªã‚‹ã€‚</li>
</ul>

</section>
<section>
<h2 id="ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«åº§å­¦ã¾ã¨ã‚">ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«åº§å­¦ã¾ã¨ã‚</h2>
<ul>
<li>ä½•ã¯ã¨ã‚‚ã‚ã‚Œæ•£å¸ƒå›³ã‚’æã</li>
<li>é©åˆ‡ãªç¢ºç‡åˆ†å¸ƒãƒ»ãƒªãƒ³ã‚¯é–¢æ•°ãƒ»èª¬æ˜å¤‰æ•°ã‚’è€ƒãˆã‚‹</li>
<li>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æœ€å°¤æ¨å®šã™ã‚‹</li>
<li>å°¤åº¦ã¯ã€Œæ‰‹å…ƒã®ãƒ‡ãƒ¼ã‚¿ã¸ã®ã‚ã¦ã¯ã¾ã‚Šã€</li>
<li>ãƒ¢ãƒ‡ãƒ«ã‚’æ¯”è¼ƒã™ã‚‹ã¨ãã¯æƒ…å ±é‡åŸºæº–ã‚’å‚è€ƒã«ã™ã‚‹</li>
</ul>

</section>
<section>
<h2 id="penguinsãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ">penguinsãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</h2>
<a href="https://allisonhorst.github.io/palmerpenguins/">
<cite>https://allisonhorst.github.io/palmerpenguins/</cite><br>
<img src="/slides/image/rstats/lter_penguins.png" width="45%">
<img src="/slides/image/rstats/culmen_depth.png" width="45%">
</a>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#34;palmerpenguins&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">palmerpenguins</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">penguins_colors</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="n">Adelie</span> <span class="o">=</span> <span class="s">&#34;darkorange&#34;</span><span class="p">,</span> <span class="n">Chinstrap</span> <span class="o">=</span> <span class="s">&#34;purple&#34;</span><span class="p">,</span> <span class="n">Gentoo</span> <span class="o">=</span> <span class="s">&#34;cyan4&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">penguins</span><span class="p">)</span>
</span></span></code></pre></div>
</section>
<section>
<h2 id="penguinsãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ">penguinsãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</h2>
<a href="https://allisonhorst.github.io/palmerpenguins/">
<cite>https://allisonhorst.github.io/palmerpenguins/</cite><br>
<img src="/slides/image/rstats/lter_penguins.png" width="45%">
<img src="/slides/image/rstats/culmen_depth.png" width="45%">
</a>
<pre tabindex="0"><code>      species    island bill_length_mm bill_depth_mm flipper_length_mm body_mass_g    sex year
  1    Adelie Torgersen           39.1          18.7               181        3750   male 2007
  2    Adelie Torgersen           39.5          17.4               186        3800 female 2007
  3    Adelie Torgersen           40.3          18.0               195        3250 female 2007
  4    Adelie Torgersen             NA            NA                NA          NA     NA 2007
 --                                                                                           
341 Chinstrap     Dream           43.5          18.1               202        3400 female 2009
342 Chinstrap     Dream           49.6          18.2               193        3775   male 2009
343 Chinstrap     Dream           50.8          19.0               210        4100   male 2009
344 Chinstrap     Dream           50.2          18.7               198        3775 female 2009
</code></pre>
</section>
<section>
<h2 id="-penguinsã§glmã®ç·´ç¿’">ğŸ”° penguinsã§GLMã®ç·´ç¿’</h2>
<p>æ¬¡ã®èª²é¡Œã‚’è§£ã„ã¦ã¿ã‚ˆã†ã€‚<br>
(æ¬¡ãƒšãƒ¼ã‚¸ä»¥é™ã«è§£ç­”ã€‚ã¾ãšã¯è‡ªåŠ›ã§ã€‚)</p>
<ol>
<li><code>body_mass_g</code> ã‚’æ¨ªè»¸ã€ <code>flipper_length_mm</code> ã‚’ç¸¦è»¸ã«ã€ã¾ãšä½œå›³ã€‚</li>
<li>å˜å›å¸°ã—ã¦ã€åˆ‡ç‰‡ã¨å‚¾ãã‚’æ±‚ã‚ã‚‹ã€‚ãã—ã¦ä½œå›³ã€‚</li>
<li><code>species</code> ã§è‰²åˆ†ã‘ã—ã¦ä½œå›³ã€‚</li>
<li><code>species</code> ã‚‚èª¬æ˜å¤‰æ•°ã«åŠ ãˆã¦é‡å›å¸°ã—ã€åˆ‡ç‰‡ã¨å‚¾ãã‚’æ±‚ã‚ã‚‹ã€‚ãã—ã¦ä½œå›³ã€‚</li>
<li>ä½™è£•ãŒã‚ã‚Œã°ã€ã‚¯ãƒãƒã‚·ã®é•·ã•ã¨æ·±ã•ã‚’ç¸¦æ¨ªè»¸ã«ã—ã¦åŒæ§˜ã®è§£æã€‚</li>
</ol>

</section>
<section>
<h2 id="å˜å›å¸°ã®ç·´ç¿’-1-ã¾ãšä½œå›³">å˜å›å¸°ã®ç·´ç¿’: 1. ã¾ãšä½œå›³</h2>
<p>ã©ã†ã‚„ã‚‰ã€é‡ã„ãƒšãƒ³ã‚®ãƒ³ã»ã©ç¿¼é•·ã‚‚é•·ã„ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">p_penweight</span> <span class="o">=</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">penguins</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">body_mass_g</span><span class="p">,</span> <span class="n">flipper_length_mm</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="m">16</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.66</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_bw</span><span class="p">(</span><span class="n">base_size</span> <span class="o">=</span> <span class="m">20</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme</span><span class="p">(</span><span class="n">panel.grid.minor</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">())</span>
</span></span><span class="line"><span class="cl"><span class="n">p_penweight</span>
</span></span></code></pre></div><img src="./figure/penguins-weight-1.png" alt="plot of chunk penguins-weight" width="324" />

</section>
<section>
<h2 id="å˜å›å¸°ã®ç·´ç¿’-2-ãƒ¢ãƒ‡ãƒ«ä½œæˆãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°">å˜å›å¸°ã®ç·´ç¿’: 2. ãƒ¢ãƒ‡ãƒ«ä½œæˆã€ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h2>
<p>ã¨ã‚Šã‚ãˆãšãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æ­£è¦åˆ†å¸ƒãƒ»æ’ç­‰ãƒªãƒ³ã‚¯ã€‚
$y = 136.7 + 0.0153 x$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fit1</span> <span class="o">=</span> <span class="nf">glm</span><span class="p">(</span><span class="n">flipper_length_mm</span> <span class="o">~</span> <span class="n">body_mass_g</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">broom</span><span class="o">::</span><span class="nf">tidy</span><span class="p">(</span><span class="n">fit1</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>         term     estimate   std.error statistic       p.value
1 (Intercept) 136.72955927 1.996835406  68.47312 5.712947e-201
2 body_mass_g   0.01527592 0.000466836  32.72223 4.370681e-107
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">broom</span><span class="o">::</span><span class="nf">glance</span><span class="p">(</span><span class="n">fit1</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>  null.deviance df.null    logLik      AIC     BIC deviance df.residual nobs
1      67426.54     341 -1145.518 2297.035 2308.54  16250.3         340  342
</code></pre>
</section>
<section>
<h2 id="å˜å›å¸°ã®ç·´ç¿’-3-ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœã‚’ä½œå›³">å˜å›å¸°ã®ç·´ç¿’: 3. ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœã‚’ä½œå›³</h2>
<p>çµæœã¨ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰äºˆæ¸¬å€¤ã‚’ä½œã£ã¦å›å¸°ç·šã‚’å¼•ãã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">added1</span> <span class="o">=</span> <span class="n">modelr</span><span class="o">::</span><span class="nf">add_predictions</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">fit1</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#34;response&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p1</span> <span class="o">=</span> <span class="n">p_penweight</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">pred</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">added1</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;#3366ff&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p1</span>
</span></span></code></pre></div><img src="./figure/penguins-weight-glm-1.png" alt="plot of chunk penguins-weight-glm" width="360" />
</section>
<section>
<h2 id="é‡å›å¸°ã®ç·´ç¿’-1-ã¾ãšä½œå›³">é‡å›å¸°ã®ç·´ç¿’: 1. ã¾ãšä½œå›³</h2>
<p>ç¨®ã«ã‚ˆã£ã¦è‰²åˆ†ã‘ã—ã¦ã¿ã‚‹ã¨ã€å‚¾å‘ã®é•ã„ãŒè¦‹ãˆã‚‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">p_penweight_color</span> <span class="o">=</span> <span class="n">p_penweight</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">species</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="n">penguins_colors</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p_penweight_color</span>
</span></span></code></pre></div><img src="./figure/penguins-weight-sp-1.png" alt="plot of chunk penguins-weight-sp" width="504" />

</section>
<section>
<h2 id="é‡å›å¸°ã®ç·´ç¿’-2-ãƒ¢ãƒ‡ãƒ«ä½œæˆãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°">é‡å›å¸°ã®ç·´ç¿’: 2. ãƒ¢ãƒ‡ãƒ«ä½œæˆã€ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h2>
<p>Adelieã‚’åŸºæº–ã«ã€Chinstrapã¨Gentooã¯ãã‚Œã‚ˆã‚Šé•·ã‚ã€‚<br>
ä½“é‡ã®åŠ¹æœã¯å˜å›å¸°ã®ã¨ã(0.0153)ã‚ˆã‚Šå°ã•ã„ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fit2</span> <span class="o">=</span> <span class="nf">glm</span><span class="p">(</span><span class="n">flipper_length_mm</span> <span class="o">~</span> <span class="n">body_mass_g</span> <span class="o">+</span> <span class="n">species</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">broom</span><span class="o">::</span><span class="nf">tidy</span><span class="p">(</span><span class="n">fit2</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>              term     estimate    std.error statistic       p.value
1      (Intercept) 1.588603e+02 2.3865766963 66.564071 2.450113e-196
2      body_mass_g 8.402113e-03 0.0006338976 13.254686  1.401600e-32
3 speciesChinstrap 5.597440e+00 0.7882166229  7.101398  7.334777e-12
4    speciesGentoo 1.567747e+01 1.0906590679 14.374308  6.800823e-37
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">broom</span><span class="o">::</span><span class="nf">glance</span><span class="p">(</span><span class="n">fit2</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>  null.deviance df.null    logLik      AIC      BIC deviance df.residual nobs
1      67426.54     341 -1059.718 2129.437 2148.611 9839.073         338  342
</code></pre>
</section>
<section>
<h2 id="é‡å›å¸°ã®ç·´ç¿’-3-ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœã‚’ä½œå›³">é‡å›å¸°ã®ç·´ç¿’: 3. ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœã‚’ä½œå›³</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">added2</span> <span class="o">=</span> <span class="n">modelr</span><span class="o">::</span><span class="nf">add_predictions</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">fit2</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#34;response&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p2</span> <span class="o">=</span> <span class="n">p_penweight_color</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">pred</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">added2</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p2</span>
</span></span></code></pre></div><img src="./figure/penguins-weight-sp-glm-1.png" alt="plot of chunk penguins-weight-sp-glm" width="504" />
<p><strong>å‚¾ã</strong>ã‚‚ç¨®ã«ã‚ˆã£ã¦é•ã†ã‹ã‚‚ã€‚<strong>äº¤äº’ä½œç”¨</strong>ã‚’å…¥ã‚Œã¦ã¿ãŸã„ã€‚</p>

</section>
<section>
<h2 id="äº¤äº’ä½œç”¨ã®ç·´ç¿’-ãƒ¢ãƒ‡ãƒ«ä½œæˆãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°">äº¤äº’ä½œç”¨ã®ç·´ç¿’: ãƒ¢ãƒ‡ãƒ«ä½œæˆã€ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h2>
<p>Adelieã‚’åŸºæº–ã«ã€Chinstrapã®å‚¾ããŒçµæ§‹é•ã†ã€‚<br>
åˆ‡ç‰‡ã®é•ã„ã¯è§£é‡ˆã—ã«ãããªã£ãŸã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fit3</span> <span class="o">=</span> <span class="nf">glm</span><span class="p">(</span><span class="n">flipper_length_mm</span> <span class="o">~</span> <span class="n">body_mass_g</span> <span class="o">*</span> <span class="n">species</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">penguins</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">broom</span><span class="o">::</span><span class="nf">tidy</span><span class="p">(</span><span class="n">fit3</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>                          term      estimate    std.error statistic       p.value
1                  (Intercept) 165.244812649 3.5508916651 46.536146 1.561669e-148
2                  body_mass_g   0.006676867 0.0009522935  7.011354  1.301783e-11
3             speciesChinstrap -13.863939075 7.3012647809 -1.898841  5.844186e-02
4                speciesGentoo   6.059375933 6.0508813200  1.001404  3.173522e-01
5 body_mass_g:speciesChinstrap   0.005228197 0.0019486293  2.683013  7.657147e-03
6    body_mass_g:speciesGentoo   0.002362269 0.0013525781  1.746494  8.163897e-02
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">broom</span><span class="o">::</span><span class="nf">glance</span><span class="p">(</span><span class="n">fit3</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>  null.deviance df.null    logLik      AIC      BIC deviance df.residual nobs
1      67426.54     341 -1055.711 2125.422 2152.265 9611.166         336  342
</code></pre>
</section>
<section>
<h2 id="äº¤äº’ä½œç”¨ã®ç·´ç¿’-ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœã‚’ä½œå›³">äº¤äº’ä½œç”¨ã®ç·´ç¿’: ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœã‚’ä½œå›³</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">added3</span> <span class="o">=</span> <span class="n">modelr</span><span class="o">::</span><span class="nf">add_predictions</span><span class="p">(</span><span class="n">penguins</span><span class="p">,</span> <span class="n">fit3</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#34;response&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p3</span> <span class="o">=</span> <span class="n">p_penweight_color</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">pred</span><span class="p">),</span> <span class="n">data</span> <span class="o">=</span> <span class="n">added3</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p3</span>
</span></span></code></pre></div><img src="./figure/penguins-interaction-1.png" alt="plot of chunk penguins-interaction" width="504" />
</section>
<section>
<h2 id="ã“ã“ã¾ã§ã®3ã¤ã®ãƒ¢ãƒ‡ãƒ«ã§ã©ã‚ŒãŒã„ã„ã‹">ã“ã“ã¾ã§ã®3ã¤ã®ãƒ¢ãƒ‡ãƒ«ã§ã©ã‚ŒãŒã„ã„ã‹ï¼Ÿ</h2>
<p>AICã§é¸ã¶ãªã‚‰äº¤äº’ä½œç”¨å…¥ã‚Šé‡å›å¸°ãŒè‰¯ã•ãã†ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">labels</span> <span class="o">=</span> <span class="nf">sprintf</span><span class="p">(</span><span class="s">&#34;AIC = %.1f&#34;</span><span class="p">,</span> <span class="nf">AIC</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="n">fit2</span><span class="p">,</span> <span class="n">fit3</span><span class="p">)</span><span class="o">$</span><span class="n">AIC</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cowplot</span><span class="o">::</span><span class="nf">plot_grid</span><span class="p">(</span><span class="n">p1</span> <span class="o">+</span> <span class="nf">labs</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="n">labels[1]</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                   <span class="n">p2</span> <span class="o">+</span> <span class="nf">labs</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="n">labels[2]</span><span class="p">)</span> <span class="o">+</span> <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                   <span class="n">p3</span> <span class="o">+</span> <span class="nf">labs</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="n">labels[3]</span><span class="p">)</span> <span class="o">+</span> <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">),</span> <span class="n">nrow</span> <span class="o">=</span> <span class="m">1L</span><span class="p">)</span>
</span></span></code></pre></div><img src="./figure/penguins-aic-1.png" alt="plot of chunk penguins-aic" width="792" />

</section>
<section>
<h2 id="ä½™è£•ãŒã‚ã£ãŸã‚‰è¿½åŠ ã®ç·´ç¿’">ä½™è£•ãŒã‚ã£ãŸã‚‰è¿½åŠ ã®ç·´ç¿’</h2>
<p>ğŸ”°ã‚¯ãƒãƒã‚·ã®é•·ã•ã¨æ·±ã•ã§åŒã˜è§£æã‚’ã‚„ã£ã¦ã¿ã‚ˆã†ã€‚</p>
<img src="./figure/penguins-bill-1.png" alt="plot of chunk penguins-bill" width="792" />
<p>ğŸ”°ä½™è£•ãŒã‚ã£ãŸã‚‰æ€§åˆ¥ã‚„å¹´ãªã©ã‚‚èª¬æ˜å¤‰æ•°ã«å…¥ã‚Œã¦ã¿ã‚ˆã†ã€‚</p>
<!-- TODO: ç·´ç¿’ã«é©ã—ãŸèª²é¡Œãƒ‡ãƒ¼ã‚¿ -->

</section>
<section>
<h2 id="å‚è€ƒæ–‡çŒ®">å‚è€ƒæ–‡çŒ®</h2>
<ul>
<li><a href="https://amzn.to/33suMIZ">ãƒ‡ãƒ¼ã‚¿è§£æã®ãŸã‚ã®çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°å…¥é–€</a> ä¹…ä¿æ‹“å¼¥ 2012</li>
<li><a href="https://amzn.to/3uwx7Pb">Stanã¨Rã§ãƒ™ã‚¤ã‚ºçµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°</a> æ¾æµ¦å¥å¤ªéƒ 2016</li>
<li><a href="https://amzn.to/3o1eCzP">Rã¨Stanã§ã¯ã˜ã‚ã‚‹ ãƒ™ã‚¤ã‚ºçµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿åˆ†æå…¥é–€</a> é¦¬å ´çœŸå“‰ 2019</li>
<li><a href="https://amzn.to/3uCxTKo">ãƒ‡ãƒ¼ã‚¿åˆ†æã®ãŸã‚ã®æ•°ç†ãƒ¢ãƒ‡ãƒ«å…¥é–€</a> æ±Ÿå´è²´è£• 2020</li>
<li><a href="https://amzn.to/3uznzCK">åˆ†æè€…ã®ãŸã‚ã®ãƒ‡ãƒ¼ã‚¿è§£é‡ˆå­¦å…¥é–€</a> æ±Ÿå´è²´è£• 2020</li>
<li><a href="https://amzn.to/3ty80Kv">çµ±è¨ˆå­¦ã‚’å“²å­¦ã™ã‚‹</a> å¤§å¡šæ·³ 2020</li>
</ul>
<a href="5-glmm.html" rel="next" class="readmore">
5. ä¸€èˆ¬åŒ–ç·šå½¢æ··åˆãƒ¢ãƒ‡ãƒ« GLMM
</a>

</section>
</div>
</div>
</body>
</html>
