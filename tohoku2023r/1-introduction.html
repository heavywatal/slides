<!DOCTYPE html>
<html lang="ja">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<title>1. 導入: データ解析の全体像。Rの基本。 — 進化学実習 2023 牧野研 東北大学</title>
<meta name="author" content="Watal M. Iwasaki">
<meta property="og:title" content="1. 導入: データ解析の全体像。Rの基本。 — 進化学実習 2023 牧野研 東北大学">
<meta property="og:type" content="article">
<meta property="og:url" content="https://heavywatal.github.io/slides/tohoku2023r/1-introduction.html">
<meta property="og:image" content="https://avatars.githubusercontent.com/heavywatal">
<meta property="og:description" content="">
<meta property="og:site_name" content="Slide decks — Heavy Watal">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@heavywatal">
<meta name="twitter:creator" content="@heavywatal">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-V60H2JH0G6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-V60H2JH0G6');
</script>
<link rel="stylesheet" href="/slides/lib/reveal.js/reveal.css">
<script type="module">
import { Reveal } from "/slides/lib/reveal.js/reveal.js";
window.addEventListener('DOMContentLoaded', function() {
  Reveal.configure({width: 1440, height: 1080});
  document.querySelector('html').style.fontSize = '240%';
})
</script>
<link rel="stylesheet" href="/slides/lib/katex/katex.min.css">
<script src="/slides/lib/katex/katex.min.js"></script>
<script src="/slides/lib/iconify.js"></script>
<script defer src="/slides/lib/reload-img-onclick.js"></script>
<link rel="stylesheet" href="/slides/css/style-reveal.css">
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="reveal">
<div class="slides">
<section>
<h1 id="進化学実習-2023-牧野研-東北大学"><a href=".">進化学実習 2023 牧野研 東北大学</a></h1>
<div class="author">
岩嵜 航
</div>
<div class="affiliation">
東北大学 生命科学研究科 進化ゲノミクス分野 牧野研 特任助教
</div>
<ol>
<li class="current-deck"><a href="1-introduction.html">導入: データ解析の全体像。Rの基本。</a>
<li><a href="2-visualization.html">データの可視化、レポート作成。</a>
<li><a href="3-structure1.html">データ構造の処理1: 抽出、集約など。</a>
<li><a href="4-structure2.html">データ構造の処理2: 結合、変形など。</a>
<li><a href="5-content.html">データ内容の処理: 数値、文字列など。</a>
<li><a href="6-input.html">データ入力、データ解釈</a>
<li><a href="7-distribution.html">統計モデリング1: 確率分布、尤度</a>
<li><a href="8-glm.html">統計モデリング2: 一般化線形モデル</a>
<li><a href="9-report.html">発表会</a>
</ol>
<div class="footnote">
2023-04-10 東北大学 理学部生物学科 進化学実習<br>
<a href="https://heavywatal.github.io/slides/tohoku2023r/">https://heavywatal.github.io/slides/tohoku2023r/</a>
</div>

</section>
<section>
<h2 id="本実習のお品書きデータ取り扱いの基礎">本実習のお品書き「データ取り扱いの基礎」</h2>
<ul>
<li>生物学研究におけるデータ解析の重要性を認識する。
<ul>
<li>理解する、とは</li>
</ul>
</li>
<li>プログラミング言語Rを習得し、長い目で見て楽をする。
<ul>
<li>データの可視化</li>
<li>データの前処理</li>
<li>レポート作成</li>
</ul>
</li>
<li>データ解析入門
<ul>
<li>統計モデリング・仮説検定</li>
<li>データ解釈の心構え・落とし穴</li>
</ul>
</li>
</ul>
<p>牧野研以外の実習・研究でも使える知識・技術。<br>
(研究じゃない場面でも役に立つはず。)</p>
</section>
<section>
<h2 id="生物の理ことわりを知りたい理学部生物学科">「生物の理（ことわり）を知りたい」理学部生物学科</h2>
<ul>
<li>生物の複雑な機能や形態がどのように進化してきたのか解明したい</li>
<li>多様な生態系がどう誕生し維持されてきたのか理解したい</li>
<li>四肢と鰭の発生プログラムの違いや共通点を理解したい</li>
<li>行動選択や学習に関わる分子神経機構を解明したい</li>
<li>細胞内小器官の時空間的制御を理解したい</li>
<li>プラナリアなどの再生能力をもたらす遺伝的基盤を解明したい</li>
<li>昆虫が植物に「虫こぶ」を作らせる機構を解明したい</li>
<li>etc.</li>
</ul>

</section>
<section>
<h2 id="研究の基本プロセス">研究の基本プロセス</h2>
<ol>
<li>課題を見つける、仮説を立てる</li>
<li>実験🧫・観察🔬・文献📚などからデータを集める</li>
<li><strong>データを整理・解析して仮説を検証する</strong></li>
<li><strong>結果を報告する</strong>、1に戻る</li>
</ol>
<br>
<ul>
<li>実験や観察は研究の半分くらい。</li>
<li>残り半分はデータの整理・解析・報告。<br>
→ しかし軽視されがち。ここを<strong>ちゃんと、でも楽に</strong>やりたい。</li>
</ul>

</section>
<section>
<h2 id="データ解析って必要-生の数字見ればよくない">データ解析って必要？ 生の数字見ればよくない？</h2>
<p>生のままでは複雑過ぎ、情報多すぎ、何もわからない。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">ggplot2</span><span class="o">::</span><span class="n">diamonds</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>      carat       cut color clarity depth table price    x    y    z
    1  0.23     Ideal     E     SI2  61.5    55   326 3.95 3.98 2.43
    2  0.21   Premium     E     SI1  59.8    61   326 3.89 3.84 2.31
    3  0.23      Good     E     VS1  56.9    65   327 4.05 4.07 2.31
    4  0.29   Premium     I     VS2  62.4    58   334 4.20 4.23 2.63
   --                                                               
53937  0.72      Good     D     SI1  63.1    55  2757 5.69 5.75 3.61
53938  0.70 Very Good     D     SI1  62.8    60  2757 5.66 5.68 3.56
53939  0.86   Premium     H     SI2  61.0    58  2757 6.15 6.12 3.74
53940  0.75     Ideal     D     SI2  62.2    55  2757 5.83 5.87 3.64
</code></pre><p>ダイヤモンド53,940個について10項目の値を持つデータセット</p>

</section>
<section>
<h2 id="要約統計量を見てみよう">要約統計量を見てみよう</h2>
<p>各列の<strong>平均</strong>とか<strong>標準偏差</strong>とか:</p>
<pre tabindex="0"><code>  stat carat depth table    price
1 mean  0.80 61.75 57.46  3932.80
2   sd  0.47  1.43  2.23  3989.44
3  max  5.01 79.00 95.00 18823.00
4  min  0.20 43.00 43.00   326.00
</code></pre><p>大きさ <code>carat</code> と価格 <code>price</code> の<strong>相関係数</strong>はかなり高い:</p>
<pre tabindex="0"><code>      carat depth table price
carat  1.00                  
depth  0.03  1.00            
table  0.18 -0.30  1.00      
price  0.92 -0.01  0.13  1.00
</code></pre><hr>
<p><strong>生のままよりは把握しやすい</strong>かも。</p>
<p>しかし要注意&hellip;&hellip;</p>

</section>
<section>
<h2 id="代表値ばかり見て可視化を怠ると構造を見逃す">代表値ばかり見て可視化を怠ると構造を見逃す</h2>
<figure style="position: relative;">
<a href="https://www.autodesk.com/research/publications/same-stats-different-graphs">
<img src="/slides/image/rstats/datasaurus.png" width="95%">
<figcaption class="url">https://www.autodesk.com/research/publications/same-stats-different-graphs</figcaption>
</a>
<img src="/slides/image/rstats/DataDino-600x455.gif" width="22%"
     style="position: absolute; left: 0; top: 0; z-index: 255;">
</figure>

</section>
<section>
<h2 id="データ可視化は理解の第一歩">データ可視化は理解の第一歩</h2>
<p>情報をうまく絞って整理 → <strong>直感的にわかる</strong></p>
<p><img src="./figure/simplify-diamonds-1.png" alt="plot of chunk simplify-diamonds"></p>
<p><code>carat</code> が大きいほど <code>price</code> も高いらしい。<br>
その度合いは <code>clarity</code> によって異なるらしい。</p>

</section>
<section>
<h2 id="統計とは">統計とは</h2>
<p>データをうまくまとめ、それに基づいて推論するための手法。</p>
<ul>
<li><strong>記述統計</strong>: データそのものを要約する
<ul>
<li>要約統計量 (e.g., 平均、標準偏差、etc.)</li>
<li>作図、作表</li>
</ul>
</li>
<li><strong>推測統計</strong>: データの背後にある母集団・生成過程を考える
<ul>
<li>数理モデル</li>
<li>確率分布</li>
<li>パラメータ(母数)</li>
</ul>
</li>
</ul>
<p>「グラフを眺めてなんとなく分かる」以上の分析には<strong>モデル</strong>が必要</p>

</section>
<section>
<h2 id="モデルとは">モデルとは</h2>
<p>対象システムを単純化・理想化して扱いやすくしたもの</p>
<dl>
<dt>Mathematical Model 数理モデル<img src="../tokiomarine2021/image/hill-equation.png" width="210" align="right" style="margin: 0 -5px;"></dt>
<dd>数学的な方程式として記述されるもの。</dd>
<dd>e.g., Lotka-Volterra eq., <span style="color: #888;">Hill eq.</span></dd>
<dd><br>
</dd>
<dt>Computational Model 数値計算モデル<img src="/slides/image/tumopp/Chex_Lconst.gif" width="210" align="right"></dt>
<dd>数値計算の手続きとして記述されるもの。</dd>
<dd>e.g., Schelling’s Segregation Model, <span style="color: #888;"><em>tumopp</em></span></dd>
<dd><br>
</dd>
<dt>Concrete Model 具象モデル<img src="../tokiomarine2021/image/weisberg-sfbay.jpg" width="330" align="right"></dt>
<dd>具体的な事物で作られるもの。</dd>
<dd>e.g., San Francisco Bay-Delta Model</dd>
</dl>
<cite>
Weisberg 2012 "Simulation and Similarity" (科学とモデル)
</cite>
</section>
<section>
<h2 id="データ科学における数理モデル">データ科学における数理モデル</h2>
<p>データ生成をうまく真似できそうな仮定の数式表現。<br>
 </p>
<figure>
<img src="../tokiomarine2021/math-model.drawio.svg" width="1100"><br>
<figcaption><cite>「データ分析のための数理モデル入門」江崎貴裕 2020 より改変</cite></figcaption>
</figure>
</section>
<section>
<h2 id="データ科学における数理モデル">データ科学における数理モデル</h2>
<p>データ生成をうまく真似できそうな仮定の数式表現。<br>
e.g., 大きいほど高く売れる: $\text{price} = A \times \text{carat} + B + \epsilon$</p>
<p><img src="./figure/lm-diamonds-1.png" alt="plot of chunk lm-diamonds"></p>
<p>ダイヤモンドの価格はこういう数式でおよそ表せる、という理解<br>
→ モデルをさらに改良していき、理解の精度を上げられるかも</p>

</section>
<section>
<h2 id="ウェットな実験もモデルの一種と見なせる">ウェットな実験もモデルの一種と見なせる</h2>
<p>対象システムを単純化・理想化して扱いやすくしたもの<br>
→ 自然ではありえない状況にしてでも、見たい関係を見る<br>
→ 「Xを変えればYが変わる」という<strong>還元的な理解の1ステップ</strong></p>
<ul>
<li>ノイズをなるべく除去
<ul>
<li>栄養や温度など、<strong>環境を揃える</strong></li>
<li>近親交配を繰り返して純系を作り、<strong>遺伝的背景を揃える</strong></li>
</ul>
</li>
<li>興味のある要因のみ変えて、表現型の違いを評価
<ul>
<li><strong>遺伝子</strong>1つ2つだけ改変</li>
<li>投与する<strong>薬剤</strong>の種類・量を変えてみる</li>
<li><strong>栄養塩</strong>の濃度と<strong>光</strong>の強さを変えてみる</li>
</ul>
</li>
</ul>
<p>ドライの理論研究者を指して「モデル屋」と呼びがちだが、<br>
広い意味では生物学者みんな「モデル屋」。</p>

</section>
<section>
<h2 id="科学の営み--巨人の肩に立つ">科学の営み = 巨人の肩に立つ</h2>
<figure style="position: absolute; top: 2em; right: 1.5em;">
<a href="https://en.wikipedia.org/wiki/Standing_on_the_shoulders_of_giants">
<img src="/slides/image/free/Orion_aveugle_cherchant_le_soleil.jpg" width="320">
<figcaption class="url">
https://en.wikipedia.org/wiki/<br>Standing_on_the_shoulders_of_giants
</figcaption>
</a>
</figure>
<p>先人たちの積み重ねに基づいて、新しい発見をする</p>
<dl>
<dt>記録を残すことは何より重要</dt>
<dd>実験や野外観察では些細なことも漏らさず記録。</dd>
<dd>生データは何重にもバックアップ。</dd>
<dt>データ整理・解析・作図も不可欠、だけど&hellip;</dt>
<dd>再現不能の職人技で切り抜けちゃう人も多い。</dd>
<dd>コピペ、メニュー選択、配色と配置を微調整&hellip;</dd>
<dt>疑義が生じたら&hellip;？ 別の人がその研究を発展させたいとき&hellip;？</dt>
<dd>💩「ありまぁす！」</dd>
<dd>✅「誰でも確実に再現できるプロトコルがこちらです」</dd>
</dl>
<p><strong>Reproducible Research (再現可能な研究)</strong> が巨人を大きくする。</p>

</section>
<section>
<h2 id="再現不可能な職人的研究の例">再現不可能な職人的研究の例</h2>
<p>動物園の混合展示で、各種動物はどのように分布・行動しているか、<br>
それらを決める要因は何か。膨大な観察データに基づく超大作卒論。</p>
<figure>
<img src="/slides/image/messy/thesis.png" width="1200">
</figure>
</section>
<section>
<h2 id="生データ-ここはまだそんなに悪くない">生データ: ここはまだそんなに悪くない</h2>
<p>週に1回、各個体の位置と行動を種ごとのファイルに記録。<br>
タブは個体、A列B列はXY座標でそれ以降の列は行動、各行はある時刻。</p>
<figure style="position: relative; margin: 20px 0;">
<img src="/slides/image/messy/dir-0826.png" class="screenshot" height="750">
<img src="/slides/image/messy/file-0826-zebra.png" class="screenshot" height="660"
     style="position: absolute; left: 270px; top: 50px;">
</figure>
</section>
<section>
<h2 id="マウスとコピペを駆使して条件ごとに複製集計">マウスとコピペを駆使して条件ごとに複製・集計</h2>
<p>ちゃんと合ってるのかな&hellip; ファイルもタブもたくさん&hellip;</p>
<figure style="position: relative;">
<img src="/slides/image/messy/dir-z.png" class="screenshot" height="800"
     style="position: absolute; z-index: 100;">
<img src="/slides/image/messy/file-z-book1.png" class="screenshot" height="720"
     style="position: absolute; left: 250px; top: 50px;">
</figure>
</section>
<section>
<h2 id="マウスとコピペを駆使して条件ごとに複製集計">マウスとコピペを駆使して条件ごとに複製・集計</h2>
<p>ちゃんと合ってるのかな&hellip; ファイルもタブもたくさん&hellip;</p>
<figure style="position: relative;">
<img src="/slides/image/messy/dir-z.png" class="screenshot" height="800"
     style="position: absolute; z-index: 100;">
<img src="/slides/image/messy/file-z-book1.png" class="screenshot" height="720"
     style="position: absolute; left: 250px; top: 50px;">
<img src="/slides/image/messy/file-z-z-behavior-z1e.png" class="screenshot" height="720"
     style="position: absolute; left: 30px; top: 20px; z-index: 200;">
<img src="/slides/image/messy/file-z-z-behavior-z1p.png" class="screenshot" height="720"
     style="position: absolute; left: 260px; top: 40px; z-index: 300;">
</figure>
</section>
<section>
<h2 id="目と手で数え濃淡を計算し画像ソフトで塗る">目と手で数え、濃淡を計算し、画像ソフトで塗る</h2>
<p>泣きながら何十枚も&hellip;。無料期間が終わって今は使えない&hellip;。</p>
<figure style="position: relative; margin: 1em 0;">
<img src="/slides/image/messy/file-z-z2-habitat.png" class="screenshot" width="105%">
<img src="/slides/image/messy/photoshop.jpg" width="780"
     style="position: absolute; left: 200px; top: -10px;">
</figure>
<img src="/slides/image/messy/zebra_AM.jpg" width="450">
<img src="/slides/image/messy/zebra_PM.jpg" width="450">
</section>
<section>
<h2 id="目作業手作業--シーシュポスの岩">目作業・手作業 ＝ シーシュポスの岩</h2>
<figure style="float: right; margin: 0.7rem 0 0;">
<a href="https://en.wikipedia.org/wiki/Sisyphus">
<img src="/slides/image/free/Punishment_sisyph.jpg" alt="Punishment sisyph.jpg" height="420">
<figcaption class="url">https://en.wikipedia.org/wiki/Sisyphus</figcaption>
</a>
</figure>
<ul>
<li><strong>膨大な単純作業</strong>がそもそもツラい</li>
<li>人間だもの、<strong>ミスは防ぎきれない</strong></li>
<li>ミスを減らすためのチェックもツラい</li>
<li>ミスを発見 → <strong>初めからやり直し</strong></li>
<li>新データ追加 → <strong>初めからやり直し</strong></li>
<li>熟練してもツラいまま</li>
<li>そのときの自分しかできない、記録に残らない<br>
→ <strong>検証のしようがない</strong></li>
<li>卒論なら努力賞でいいかもしれないけど、科学の手続きとしては問題。</li>
</ul>

</section>
<section>
<h2 id="プログラミングで大量のファイルを捌く">プログラミングで大量のファイルを捌く</h2>
<p>先の例に負けず生データはどっさり。でも頑張るのは機械。</p>
<figure>
<img src="/slides/image/tek/finder.png" height="630">
<img src="/slides/image/tek/fig5.png" height="630">
<figcaption class="url">Iwasaki, Kijima, Innan (2019)</figcaption>
</figure>
</section>
<section>
<h2 id="こんな感じの図もrでラクラク描けるよ">こんな感じの図もRでラクラク描けるよ</h2>
<figure>
<img src="/slides/image/tumopp/paper/Fig1.png" height="360">
<img src="/slides/image/tumopp/param-p.png" height="360">
<img src="/slides/image/tumopp/param-k.png" height="360"><br>
<img src="/slides/image/tumopp/paper/Fig3.png" height="180">
<img src="/slides/image/tumopp/Cmoore_Lconst.gif" height="180">
<img src="/slides/image/tumopp/Cmoore_Llinear.gif" height="180">
<img src="/slides/image/tumopp/Chex_Lconst.gif" height="180">
<img src="/slides/image/tumopp/Chex_Llinear.gif" height="180">
<figcaption class="url">Iwasaki and Innan (2017)</figcaption>
</figure>
</section>
<section>
<h2 id="rにやらせて楽しよう">Rにやらせて楽しよう</h2>
<ul>
<li>規則性のある退屈な仕事は人間よりも機械のほうが得意。</li>
<li>一度書いたプログラムは、データが変わっても<strong>使いまわせる</strong>。</li>
<li><strong>自分以外の人でも再現・検証</strong>できる</li>
<li><strong>きれいな図を簡単に</strong>描ける</li>
<li>部分的に改変しながらいろんな解析を試せる。<br>
→ <strong>仮説検証</strong> だけでなく、 <strong>仮説生成(探索的データ解析)</strong> もやりやすい</li>
<li>やれば上達する。どんどん楽になる！</li>
</ul>
<figure>
<a href="https://r4ds.had.co.nz/introduction.html">
<img src="/slides/image/r4ds/data-science.png" width="720">
<figcaption class="url">https://r4ds.had.co.nz/introduction.html</figcaption>
</a>
</figure>
</section>
<section>
<h2 id="rとは">Rとは</h2>
<p>統計解析と作図の機能が充実したプログラミング言語・環境</p>
<figure style="float: right;">
<a href="https://cran.r-project.org/">
<img src="/slides/image/rstats/Rlogo.svg" height="300">
<figcaption class="url">https://cran.r-project.org/</figcaption>
</a>
</figure>
<dl>
<dt>クロスプラットフォーム</dt>
<dd>Linux, Mac, Windows で動く</dd>
<dt>オープンソース</dt>
<dd>永久に無償で、すべての機能を使える。</dd>
<dd>集合知によって常に進化している。</dd>
<dt>コミュニティ</dt>
<dd>相談できる人や参考になるウェブサイトがたくさん見つかる。</dd>
</dl>
<p>他のプログラミング言語でもいいよ:
<a href="https://www.python.org/">Python</a>とか<a href="https://julialang.org/">Julia</a>とか。</p>

</section>
<section>
<h2 id="この実習の目標">この実習の目標</h2>
<h3 id="-del生物学研究にはデータとモデルが必須だと認識del">✅ <del>生物学研究にはデータとモデルが必須だと認識</del></h3>
<h3 id="-del再現可能な解析を楽にやりたい気持ちになるdel">✅ <del>再現可能な解析を楽にやりたい気持ちになる</del></h3>
<h3 id="-必要な方法を調べ実践する力をつける">⬜ 必要な方法を調べ、実践する力をつける</h3>
<ul>
<li>Rでできそうなことを把握する</li>
<li>困ったときの対処法・相談先を知る</li>
</ul>
<h3 id="-データ解析の基本に触れる">⬜ データ解析の基本に触れる</h3>
<br>
個々の方法は覚えなくても大丈夫！<br>
忘れては調べ、を何度も繰り返しながら染み込ませていこう。

</section>
<section>
<h2 id="1時限目後半-rの基礎">1時限目後半: Rの基礎</h2>
<p>✅ <del>Rはデータ解析に便利なプログラミング言語・環境</del></p>
<p>⬜ R環境のセットアップ</p>
<p>⬜ Rとの対話</p>
<p>⬜ 「プロジェクト」と「スクリプト」を作る</p>
<p>⬜ 基本的な型と演算</p>
<p>⬜ Rパッケージ</p>
<p>⬜ 疑問・エラーの解決方法</p>

</section>
<section>
<h2 id="keyboard-shortcuts">Keyboard shortcuts</h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Action</th>
          <th style="text-align: left"><iconify-icon icon="mdi:apple"></iconify-icon> Mac</th>
          <th style="text-align: left"><iconify-icon icon="mdi:microsoft"></iconify-icon> Windows</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">Switch apps</td>
          <td style="text-align: left"><kbd>command</kbd><kbd>tab</kbd></td>
          <td style="text-align: left"><kbd>alt</kbd><kbd>tab</kbd></td>
      </tr>
      <tr>
          <td style="text-align: left">Quit apps</td>
          <td style="text-align: left"><kbd>command</kbd><kbd>q</kbd></td>
          <td style="text-align: left"><kbd>alt</kbd><kbd>F4</kbd></td>
      </tr>
      <tr>
          <td style="text-align: left">Spotlight</td>
          <td style="text-align: left"><kbd>command</kbd><kbd>space</kbd></td>
          <td style="text-align: left"></td>
      </tr>
      <tr>
          <td style="text-align: left">Cut, Copy, Paste</td>
          <td style="text-align: left"><kbd>command</kbd><kbd>x</kbd>, -<kbd>c</kbd>, -<kbd>v</kbd></td>
          <td style="text-align: left"><kbd>ctrl</kbd><kbd>x</kbd>, -<kbd>c</kbd>, -<kbd>v</kbd></td>
      </tr>
      <tr>
          <td style="text-align: left">Select all</td>
          <td style="text-align: left"><kbd>command</kbd><kbd>a</kbd></td>
          <td style="text-align: left"><kbd>ctrl</kbd><kbd>a</kbd></td>
      </tr>
      <tr>
          <td style="text-align: left">Undo</td>
          <td style="text-align: left"><kbd>command</kbd><kbd>z</kbd></td>
          <td style="text-align: left"><kbd>ctrl</kbd><kbd>z</kbd></td>
      </tr>
      <tr>
          <td style="text-align: left">Find</td>
          <td style="text-align: left"><kbd>command</kbd><kbd>f</kbd></td>
          <td style="text-align: left"><kbd>ctrl</kbd><kbd>f</kbd></td>
      </tr>
      <tr>
          <td style="text-align: left">Save</td>
          <td style="text-align: left"><kbd>command</kbd><kbd>s</kbd></td>
          <td style="text-align: left"><kbd>ctrl</kbd><kbd>s</kbd></td>
      </tr>
  </tbody>
</table>
<p>See <a href="https://support.apple.com/HT201236">https://support.apple.com/HT201236</a></p>
</section>
<section>
<h2 id="r環境のセットアップ">R環境のセットアップ</h2>
<dl>
<dt><a href="https://cran.rstudio.com/">R本体</a></dt>
<dd>コマンドを解釈して実行するコア部分。</dd>
<dd>よく使われる関数なども標準パッケージとして同梱。</dd>
<dt><a href="https://www.rstudio.com/">RStudio Desktop</a></dt>
<dd>Rをより快適に使うための総合開発環境 (IDE)</dd>
<dd>必須じゃないけど便利なので結構みんな使ってる。</dd>
</dl>
<img src="/slides/image/rstudio/rstudio-300x260.png">

</section>
<section>
<h2 id="rstudioを起動して環境チェック">RStudioを起動して、環境チェック</h2>
<p>次のコードをコピーして、左下のConsoleにペースト <kbd>return</kbd></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">student_id</span> <span class="o">=</span> <span class="s">&#34;C1SB0000&#34;</span>   <span class="c1"># 自分のIDに書き換えてください</span>
</span></span><span class="line"><span class="cl"><span class="nf">source</span><span class="p">(</span><span class="s">&#34;https://example.com/sice/report.R&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p><code>Hello, C1SB0000.</code>
のような返事が返ってきていればOK。</p>
<p>なんらかのエラーが出た人は申し出てください。</p>
<p>余裕があれば <code>update.packages()</code> を実行して更新。</p>
<aside style="font-size: 50%; opacity: 50%;">
<a href="https://github.com/heavywatal/sysinfocollector">
         https://github.com/heavywatal/sysinfocollector</a>
</aside>
</section>
<section>
<h2 id="rstudioを起動してconsoleで対話しよう">RStudioを起動してConsoleで対話しよう</h2>
<p><strong>Workspace (Environment)</strong> = 一時オブジェクトの集まり</p>
<img src="/slides/image/rstudio/console.png" class="screenshot" width="90%">
</section>
<section>
<h2 id="毎回まっさらなワークスペースで始める設定">毎回まっさらなワークスペースで始める設定</h2>
<p><iconify-icon icon="mdi:apple"></iconify-icon> RStudio → Preferences   <kbd>command</kbd><kbd>,</kbd><br>
<iconify-icon icon="mdi:microsoft"></iconify-icon> Tools → Global options</p>
<p>&ldquo;Restore &hellip;&rdquo; の<strong>チェックを外し</strong>て、 &ldquo;Save &hellip;&rdquo; の<strong>Never</strong>を選択</p>
<figure style="margin: 0;">
<a href="https://r4ds.had.co.nz/workflow-projects.html">
<img src="/slides/image/rstudio/preferences-workspace.png"
  style="object-fit: cover; object-position: top; width: 32em; height: 16em;">
<figcaption class="url">https://r4ds.had.co.nz/workflow-projects.html</figcaption>
</a>
</figure>

</section>
<section>
<h2 id="project-を新規作成する">&ldquo;Project&rdquo; を新規作成する</h2>
<p>File → New Project&hellip; → New Directory → New Project →<br>
→ Directory name: <code>r-training-2023</code><br>
→ as subdirectory of: <code>~/project</code> or <code>C:/Users/yourname/project</code></p>
<p><img src="/slides/image/rstudio/create-new-project.png" class="screenshot"
width="90%" style="object-fit: cover; object-position: top; height: 16em;"></p>
<p>📁 ディレクトリ ＝ フォルダ。 <code>~/</code> = ホームディレクトリ</p>

</section>
<section>
<h2 id="rスクリプトに書いてから実行">Rスクリプトに書いてから実行</h2>
<p>File → New File → R script</p>
<img src="/slides/image/rstudio/newfile.png" width="100%">
</section>
<section>
<h2 id="rスクリプトに書いてから実行">Rスクリプトに書いてから実行</h2>
<p>File → New File → R script</p>
<img src="/slides/image/rstudio/script-console.png" width="100%">
</section>
<section>
<h2 id="rスクリプトに書いてから実行">Rスクリプトに書いてから実行</h2>
<p>Select text with <kbd>shift</kbd><kbd>←</kbd><kbd>↓</kbd><kbd>↑</kbd><kbd>→</kbd><br>
Execute them with <kbd>ctrl</kbd><kbd>return</kbd></p>
<img src="/slides/image/rstudio/101.png" width="100%">
</section>
<section>
<h2 id="rスクリプトを保存する">Rスクリプトを保存する</h2>
<ul>
<li>手順
<ul>
<li>File → Save <kbd>command</kbd><kbd>s</kbd></li>
<li>ファイル名: <code>hello.R</code></li>
<li>場所: さっき作ったプロジェクト内 (デフォルトでそうなるはず)</li>
</ul>
</li>
<li><strong>スクリプトを書いたら消さずに保存すること！</strong>
<ul>
<li>書いたスクリプトは財産</li>
<li>保存しておけばまた使い回せる</li>
</ul>
</li>
</ul>
<p>🔰 いろんな四則演算を試して <code>hello.R</code> に保存してみよう。<br>
e.g., <code>1 + 2 + 3</code>, <code>3 * 7 * 2</code>, <code>4 / 2</code>, <code>4 / 3</code>, etc.</p>
</section>
<section>
<h2 id="プロジェクトにファイルが溜まっていく">プロジェクト📁にファイルが溜まっていく</h2>
<p>スクリプト、データ、結果を分けて整理する例:</p>
<pre tabindex="0"><code>r-training-2023/           # プロジェクトの最上階
├── r-training-2023.Rproj  # これダブルクリックでRStudioを起動
├── hello.R
├── transform.R            # データ整理・変形のスクリプト
├── visualize.R            # 作図のスクリプト
├── data/                  # 元データを置くところ
│   ├── iris.tsv
│   └── diamonds.xlsx
└── output/                # 結果の出力先
    ├── iris-petal.png
    └── iris-summary.tsv
</code></pre><p>プロジェクト最上階を<strong>作業ディレクトリ</strong>とし、<br>
ファイル読み書きの基準にする。(後で詳しく)</p>
<p>ほんの一例です。好きな構造に決めてください。</p>

</section>
<section>
<h2 id="作業ディレクトリ-rにとっての現在地-getwd">作業ディレクトリ: Rにとっての現在地 <code>getwd()</code></h2>
<ul>
<li>ファイル読み書き、画像の保存などはここが基準。</li>
<li><code>*.Rproj</code> ダブルクリックでRStudioを開けば、いい位置で作業再開。</li>
</ul>
<img src="/slides/image/rstudio/getwd.png" style="width: 100%;">

</section>
<section>
<h2 id="rと接する上での心構え">Rと接する上での心構え</h2>
<figure>
<img src="/slides/image/free/akusyu_uchuujin.png" height="200">
</figure>
<dl>
<dt>エラー文を恐れない</dt>
<dd>熟練プログラマでも頻繁にエラーを起こす。</dd>
<dd>エラーはRからのメッセージ。<strong>意図を読み取って修正</strong>しよう。</dd>
<dd>プログラミングの経験値 ≈ エラー解決の経験値</dd>
<dt>困ったらウェブ検索</dt>
<dd>あなたの問題は全世界のRユーザーが既に通った道。</dd>
<dd>日本語で、英語で、エラー文そのもので検索すれば解決策に当たる。</dd>
</dl>

</section>
<section>
<h2 id="この実習の取り組み方">この実習の取り組み方</h2>
<p>とにかく手を動かして体感しよう！</p>
<ol>
<li>こういう枠が出てきたら、自分のRスクリプトに<strong>コピペして保存</strong>:
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
</span></span></code></pre></div></li>
<li><strong>実行してコンソールを確認</strong>。思ったとおりの出力？<br>
<code>Error</code> や <code>Warning</code> があったらよく読んで対処する。<br>
(無視していい <code>Warning</code> もたまーにあるけど)</li>
<li>🔰若葉マークの練習問題があれば解いてみる。<br>
そこまでのコードの<strong>コピペ＋改変</strong>でできるはず。</li>
</ol>
<p>疑問・困りごとがある場合は<strong>気軽に割り込んで</strong>ください。<br>
TAがいるならTAが、リモートならChat欄が随時受付中です。</p>

</section>
<section>
<h2 id="変数オブジェクトを作ってみよう">変数/オブジェクトを作ってみよう</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="m">2</span>        <span class="c1"># Create x</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span>            <span class="c1"># What&#39;s in x?</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 2
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="m">5</span>        <span class="c1"># Create y</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span>            <span class="c1"># What&#39;s in y?</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 5
</code></pre><p>Rでは代入演算子として矢印 <code>&lt;-</code> も使えるけど私は <code>=</code> 推奨。<br>
<code>#</code> 記号より右はRに無視される。コメントを書くのに便利。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 7
</code></pre><p>🔰 <code>x</code> と <code>y</code> の引き算、掛け算、割り算をやってみよう</p>

</section>
<section>
<h2 id="基本的な演算">基本的な演算</h2>
<p><code>+</code> とか <code>*</code> のような演算子(operator)を変数の間に置く。<br></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="m">10</span> <span class="o">+</span> <span class="m">3</span>    <span class="c1"># addition</span>
</span></span><span class="line"><span class="cl"><span class="m">10</span> <span class="o">-</span> <span class="m">3</span>    <span class="c1"># subtraction</span>
</span></span><span class="line"><span class="cl"><span class="m">10</span> <span class="o">*</span> <span class="m">3</span>    <span class="c1"># multiplication</span>
</span></span><span class="line"><span class="cl"><span class="m">10</span> <span class="o">/</span> <span class="m">3</span>    <span class="c1"># division</span>
</span></span><span class="line"><span class="cl"><span class="m">10</span> <span class="o">%/%</span> <span class="m">3</span>  <span class="c1"># integer division</span>
</span></span><span class="line"><span class="cl"><span class="m">10</span> <span class="o">%%</span> <span class="m">3</span>   <span class="c1"># modulus 剰余</span>
</span></span><span class="line"><span class="cl"><span class="m">10</span> <span class="o">**</span> <span class="m">3</span>   <span class="c1"># exponent 10^3</span>
</span></span></code></pre></div><p>🔰 コピペして結果を確認してみよう。</p>

</section>
<section>
<h2 id="関数-function">関数 (function)</h2>
<p>変数を受け取って、何か仕事して、返す命令セット</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>  <span class="c1"># 1と3を渡すとvectorが返ってくる</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 1 2 3
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>         <span class="c1"># vectorを渡すと足し算が返ってくる</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 6
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">square</span> <span class="o">=</span> <span class="kr">function</span><span class="p">(</span><span class="n">something</span><span class="p">)</span> <span class="p">{</span>  <span class="c1"># 自分の関数を定義</span>
</span></span><span class="line"><span class="cl">  <span class="n">something</span> <span class="o">**</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                       <span class="c1"># 使ってみる</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 1 4 9
</code></pre><p>🔰 自分の関数を何か作ってみよう。
e.g., 2倍にする関数 <code>twice</code></p>

</section>
<section>
<h2 id="変数オブジェクトを作ってみよう-part-2">変数/オブジェクトを作ってみよう Part 2</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="m">42</span>       <span class="c1"># Create x</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span>            <span class="c1"># What&#39;s in x?</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 42
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="s">&#34;24601&#34;</span>  <span class="c1"># Create y</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span>            <span class="c1"># What&#39;s in y?</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;24601&#34;
</code></pre><p>この <code>x</code> と <code>y</code> を足そうとするとエラーになる。なぜ？</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">+</span> <span class="n">y</span>        <span class="c1"># Error! Why?</span>
</span></span></code></pre></div><pre tabindex="0"><code>Error in x + y: non-numeric argument to binary operator
</code></pre>
</section>
<section>
<h2 id="変数オブジェクトの型">変数/オブジェクトの型</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;numeric&#34;
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">is.numeric</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] TRUE
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">is.character</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] FALSE
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">as.character</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;42&#34;
</code></pre><p>🔰 さっき作った <code>y</code> にも同じ関数を適用してみよう。</p>
</section>
<section>
<h2 id="変数オブジェクトの型">変数/オブジェクトの型</h2>
<ul>
<li><code>vector</code>: 基本型。一次元の配列。
<ul>
<li><code>logical</code>: 論理値 (<code>TRUE</code> or <code>FALSE</code>)</li>
<li><code>numeric</code>: 数値 (整数 <code>42L</code> or 実数 <code>3.1416</code>)</li>
<li><code>character</code>: 文字列 (<code>&quot;a string&quot;</code>)</li>
<li><code>factor</code>: 因子 (文字列っぽいけど微妙に違う)</li>
</ul>
</li>
<li><code>array</code>: 多次元配列。<code>vector</code>同様、全要素が同じ型。
<ul>
<li><code>matrix</code>: 行列 = 二次元の配列。</li>
</ul>
</li>
<li><code>list</code>: 異なる型でも詰め込める太っ腹ベクトル。</li>
<li><strong><code>data.frame</code>: 同じ長さのベクトルを並べた長方形のテーブル。重要。</strong> <br>
<strong><code>tibble</code></strong> とか <strong><code>tbl_df</code></strong> と呼ばれる亜種もあるけどほぼ同じ。</li>
</ul>

</section>
<section>
<h2 id="vector-一次元の配列">vector: 一次元の配列</h2>
<p>1個の値でもベクトル扱い。<br>
同じ長さ(または長さ1)の相手との計算が得意。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">9</span><span class="p">)</span>  <span class="c1"># 長さ3の数値ベクトル</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">+</span> <span class="n">x</span>           <span class="c1"># 同じ長さ同士の計算</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1]  2  4 18
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="m">10</span>          <span class="c1"># 長さ1の数値ベクトル</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">+</span> <span class="n">y</span>           <span class="c1"># 長さ3 + 長さ1 = 長さ3 (それぞれ足し算)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 11 12 19
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">&lt;</span> <span class="m">5</span>           <span class="c1"># 5より小さいか</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1]  TRUE  TRUE FALSE
</code></pre><p>🔰 この <code>x, y</code> を使っていろいろな演算を試してみよう</p>

</section>
<section>
<h2 id="vectorから部分的に抜き出す">vectorから部分的に抜き出す</h2>
<p><code>[]</code> を使う。番号は1から始まる。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="kc">letters</span>
</span></span></code></pre></div><pre tabindex="0"><code> [1] &#34;a&#34; &#34;b&#34; &#34;c&#34; &#34;d&#34; &#34;e&#34; &#34;f&#34; &#34;g&#34; &#34;h&#34; &#34;i&#34; &#34;j&#34; &#34;k&#34; &#34;l&#34; &#34;m&#34; &#34;n&#34; &#34;o&#34; &#34;p&#34; &#34;q&#34; &#34;r&#34; &#34;s&#34; &#34;t&#34; &#34;u&#34; &#34;v&#34; &#34;w&#34; &#34;x&#34; &#34;y&#34; &#34;z&#34;
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="kc">letters</span><span class="n">[3]</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;c&#34;
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="kc">letters</span><span class="nf">[seq</span><span class="p">(</span><span class="m">4</span><span class="p">,</span> <span class="m">6</span><span class="p">)</span><span class="n">]</span>       <span class="c1"># 4 5 6</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;d&#34; &#34;e&#34; &#34;f&#34;
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="kc">letters</span><span class="nf">[seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">26</span><span class="p">)</span> <span class="o">&lt;</span> <span class="m">4</span><span class="n">]</span>  <span class="c1"># TRUE TRUE TRUE FALSE FALSE ...</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;a&#34; &#34;b&#34; &#34;c&#34;
</code></pre>
</section>
<section>
<h2 id="vectorを渡した結果は関数によって異なる">vectorを渡した結果は関数によって異なる</h2>
<p>各要素に適用するもの:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>     <span class="c1"># square root</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 1.000000 1.414214 3.000000
</code></pre><p>全要素を集約した値を返すもの:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">z</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">z</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 12
</code></pre><p>🔰 <code>log()</code>, <code>exp()</code>, <code>length()</code>, <code>max()</code>, <code>mean()</code>
にvectorを渡してみよう。</p>

</section>
<section>
<h2 id="matrix-二次元の配列-行列">matrix: 二次元の配列 (行列)</h2>
<p>1本のvectorを折り曲げて長方形にしたもの。<br>
中身は全て同じ型。機械学習とか画像処理とかで使う。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">v</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">8</span><span class="p">)</span>              <span class="c1"># c(1, 2, 3, 4, 5, 6, 7, 8)</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">matrix</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>    <span class="c1"># 2行に畳む。列ごとに詰める</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span>
</span></span></code></pre></div><pre tabindex="0"><code>     [,1] [,2] [,3] [,4]
[1,]    1    3    5    7
[2,]    2    4    6    8
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="nf">matrix</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">byrow</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>  <span class="c1"># 行ごとに詰める</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span>
</span></span></code></pre></div><pre tabindex="0"><code>     [,1] [,2] [,3] [,4]
[1,]    1    2    3    4
[2,]    5    6    7    8
</code></pre><p>🔰 結果を確認してみよう: <code>x + y</code>, <code>dim(x)</code>, <code>nrow(x)</code>, <code>ncol(x)</code>.</p>

</section>
<section>
<h2 id="行-row-列-column-の憶え方">行 (row), 列 (column) の憶え方</h2>
<div class="column-container">
  <div class="column">
    <figure>
    <a href="https://commons.wikimedia.org/wiki/File:2012_Super_GT_Sugo_starting_grid.jpg">
    <img src="/slides/image/free/front-row.jpg" height="720">
    <figcaption class="url">https://commons.wikimedia.org/wiki/File:2012_Super_GT_Sugo_starting_grid.jpg</figcaption>
    </a>
    </figure>
  </div>
  <div class="column">
    <figure>
    <a href="https://en.wikipedia.org/wiki/Rhodes">
    <img src="/slides/image/free/apollon-columns.jpg" height="720">
    <figcaption class="url">https://en.wikipedia.org/wiki/Rhodes</figcaption>
    </a>
    </figure>
  </div>
</div>

</section>
<section>
<h2 id="dataframe-長方形のテーブル-重要">data.frame: 長方形のテーブル (重要!)</h2>
<p>同じ長さの列vectorを複数束ねた長方形の表。<br>
e.g., 長さ150の数値ベクトル4本と因子ベクトル1本:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>    Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
  1          5.1         3.5          1.4         0.2    setosa
  2          4.9         3.0          1.4         0.2    setosa
  3          4.7         3.2          1.3         0.2    setosa
  4          4.6         3.1          1.5         0.2    setosa
 --                                                            
147          6.3         2.5          5.0         1.9 virginica
148          6.5         3.0          5.2         2.0 virginica
149          6.2         3.4          5.4         2.3 virginica
150          5.9         3.0          5.1         1.8 virginica
</code></pre><p><code>iris</code> はアヤメ属3種150個体に関する測定データ。<br>
Rに最初から入ってて、例としてよく使われる。</p>

</section>
<section>
<h2 id="dataframeを眺める">data.frameを眺める</h2>
<p>概要を掴む:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="m">6</span><span class="p">)</span>   <span class="c1"># 先頭だけ見てみる。末尾は tail()</span>
</span></span><span class="line"><span class="cl"><span class="nf">nrow</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>      <span class="c1"># 行数: Number of ROWs</span>
</span></span><span class="line"><span class="cl"><span class="nf">ncol</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>      <span class="c1"># 列数: Number of COLumns</span>
</span></span><span class="line"><span class="cl"><span class="nf">names</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>     <span class="c1"># 列名</span>
</span></span><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>   <span class="c1"># 要約</span>
</span></span><span class="line"><span class="cl"><span class="nf">View</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>      <span class="c1"># RStudioで閲覧</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">str</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>       <span class="c1"># 構造が分かる形で表示</span>
</span></span></code></pre></div><pre tabindex="0"><code>tibble [150 × 5] (S3: tbl_df/tbl/data.frame)
 $ Sepal.Length: num [1:150] 5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num [1:150] 3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: num [1:150] 1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ Petal.Width : num [1:150] 0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ Species     : Factor w/ 3 levels &#34;setosa&#34;,&#34;versicolor&#34;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre><p>🔰 ほかのデータもいろいろ見てみよう。
e.g., <code>mtcars</code>, <code>quakes</code>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/00Index.html"><code>data()</code></a></p>

</section>
<section>
<h2 id="dataframeを眺める">data.frameを眺める</h2>
<p>部分的なdata.frameを取得する:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">iris[2</span><span class="p">,</span> <span class="n">]</span>                  <span class="c1"># 2行目</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[2</span><span class="o">:</span><span class="m">5</span><span class="p">,</span> <span class="n">]</span>                <span class="c1"># 2行目から5行目まで</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[</span><span class="p">,</span> <span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="n">]</span>                <span class="c1"># 3-4列目</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[2</span><span class="o">:</span><span class="m">5</span><span class="p">,</span> <span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="n">]</span>             <span class="c1"># 2-5行目, 3-4列目</span>
</span></span></code></pre></div><p>1列をvectorとして取得する:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">iris[[3]]</span>                  <span class="c1"># 3列目</span>
</span></span><span class="line"><span class="cl"><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span>          <span class="c1"># Petal.Length列</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[[</span><span class="s">&#34;Petal.Length&#34;</span><span class="n">]]</span>     <span class="c1"># Petal.Length列</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[[</span><span class="s">&#34;Petal.Length&#34;</span><span class="n">]][2]</span>  <span class="c1"># Petal.Length列の2番目</span>
</span></span></code></pre></div><p>結果がdata.frameになるかvectorになるか曖昧で危険、非推奨:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">iris[</span><span class="p">,</span> <span class="m">3</span><span class="n">]</span>                  <span class="c1"># 3列目</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[</span><span class="p">,</span> <span class="s">&#34;Petal.Length&#34;</span><span class="n">]</span>     <span class="c1"># Petal.Length列</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[2</span><span class="p">,</span> <span class="s">&#34;Petal.Length&#34;</span><span class="n">]</span>    <span class="c1"># 2行目Petal.Length列</span>
</span></span></code></pre></div>
</section>
<section>
<h2 id="dataframeの新規作成">data.frameの新規作成</h2>
<p>同じ長さの <strong>列(column) vector</strong> を結合して作る:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;A&#34;</span><span class="p">,</span> <span class="s">&#34;B&#34;</span><span class="p">,</span> <span class="s">&#34;C&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">mydata</span> <span class="o">=</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">mydata</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>  x y
1 1 A
2 2 B
3 3 C
</code></pre><p>🔰 次のようなdata.frameを作って <code>theDF</code> と名付けよう:</p>
<pre tabindex="0"><code> i s
24 x
25 y
26 z
</code></pre><p>ヒント: <code>c()</code> 無しでクリアすることも可能。</p>

</section>
<section>
<h2 id="dataframeの読み書き">data.frameの読み書き</h2>
<p>Rには <code>read.csv()</code> とか <code>write.csv()</code> とかが標準装備されてるけど、、、</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">write.csv</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="s">&#34;iris.csv&#34;</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>&#34;&#34;,&#34;Sepal.Length&#34;,&#34;Sepal.Width&#34;,&#34;Petal.Length&#34;,&#34;Petal.Width&#34;,&#34;Species&#34;
&#34;1&#34;,5.1,3.5,1.4,0.2,&#34;setosa&#34;
&#34;2&#34;,4.9,3,1.4,0.2,&#34;setosa&#34;
&#34;3&#34;,4.7,3.2,1.3,0.2,&#34;setosa&#34;
</code></pre><a href="https://readr.tidyverse.org/">
<img src="/_img/hex-stickers/readr.webp" width="180" align="right">
</a>
<p>なんか<strong>左端の列</strong>とか <strong>&ldquo;引用符&rdquo;</strong> が勝手に作られたりいろいろ不便。</p>
<p><code>readr</code> というパッケージを使えばそういう悩みから解放される。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">readr</span><span class="o">::</span><span class="nf">write_csv</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="s">&#34;iris.csv&#34;</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>Sepal.Length,Sepal.Width,Petal.Length,Petal.Width,Species
5.1,3.5,1.4,0.2,setosa
4.9,3,1.4,0.2,setosa
4.7,3.2,1.3,0.2,setosa
</code></pre>
</section>
<section>
<h2 id="r-package">R package</h2>
<p>便利な関数やデータセットなどをひとまとめにしたもの。</p>
<dl>
<dt>Standard Packages</dt>
<dd>Rの標準機能。何もしなくても使用可能</dd>
<dt>Contributed Packages</dt>
<dd>有志により開発され、
<a href="https://cran.rstudio.com/web/packages/index.html">CRAN</a>
にまとめて公開されている。</dd>
<dd>要インストール。使う前に読み込むおまじないが必要。</dd>
</dl>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#34;readr&#34;</span><span class="p">)</span>  <span class="c1"># 一度やればOK</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span>             <span class="c1"># 読み込みはRを起動するたびに必要</span>
</span></span><span class="line"><span class="cl"><span class="nf">update.packages</span><span class="p">()</span>          <span class="c1"># たまには更新しよう</span>
</span></span></code></pre></div><dl>
<dt>素のRも覚えきってないのにいきなりパッケージ？</dt>
<dd>大丈夫。誰も覚えきってない。</dd>
<dd>パッケージを使わないR作業 = 火もナイフも使わない料理</dd>
</dl>
</section>
<section>
<h2 id="tidyverse-データ科学のためのパッケージ群">tidyverse: データ科学のためのパッケージ群</h2>
<a href="https://www.tidyverse.org/">
<img src="/slides/image/rstats/hex-badges8.png" width="33%" align="right">
</a>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#34;tidyverse&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">conflicted</span><span class="p">)</span> <span class="c1"># 安全のおまじない</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>  <span class="c1"># 一挙に読み込み</span>
</span></span></code></pre></div><pre tabindex="0"><code>── Attaching core tidyverse packages ──── tidyverse 2.0.0 ──
✔ dplyr     1.1.1     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
</code></pre><p>一貫したデザインでデータ解析の様々な工程をカバー</p>
<figure style="margin-block: 0;">
<a href="https://r4ds.had.co.nz/introduction.html">
<img src="/slides/image/r4ds/data-science.png" width="800">
<figcaption class="url">https://r4ds.had.co.nz/introduction.html</figcaption>
</a>
</figure>
</section>
<section>
<h2 id="疑問やエラーの解決方法">疑問やエラーの解決方法</h2>
<ul>
<li>エラーのほとんどは凡ミス由来。よく確認しよう。
<ul>
<li>エラー文をちゃんと読む: <code>No such file or directory</code></li>
<li>変数の中身を確かめる: <code>str(iris)</code>, <code>attributes(iris)</code></li>
<li><a href="https://comicalcommet.github.io/r-training-2022/R_training_2022_7.html">よくあるエラー集 (石川由希さん@名古屋大)</a>
をチェックする</li>
</ul>
</li>
<li>エラー文やパッケージ名をコピペしてウェブ検索<br>
→ <a href="https://stackoverflow.com/questions/tagged/r">StackOverflow</a>
や個人サイトに解決策</li>
<li>Slack <iconify-icon icon="mdi:slack"></iconify-icon>
<a href="https://github.com/tokyor/r-wakalang">r-wakalang</a>
で質問を投稿する。<br>
(質問に飢えた優しいワニが多数生息 👀   👀   👀   👀)</li>
<li>状況再現できる小さな例
<a href="https://reprex.tidyverse.org/">(reprex)</a>
を添えると回答を得やすい。<br>
(これを準備してるうちに問題が切り分けられて自己解決したり)</li>
<li>パッケージの公式ドキュメントをちゃんと読む</li>
<li>R(Studio)内のヘルプを読む: <code>?sum</code>, <code>help.start()</code></li>
</ul>

</section>
<section>
<h2 id="1時限目後半-rの基礎">1時限目後半: Rの基礎</h2>
<p>✅ Rはデータ解析に便利なプログラミング言語・環境</p>
<p>✅ <strong>プロジェクト</strong>を使ってファイルを管理</p>
<p>✅ <strong>スクリプト</strong>を書いてから<strong>コンソール</strong>で実行</p>
<p>✅ 変数には型がある: 数値、文字列、<strong>データフレーム</strong>など</p>
<p>✅ 便利な<strong>パッケージ</strong>を使っていく</p>
<p>✅ 疑問・エラーの解決方法</p>
<hr>
<p>個々の方法は覚えなくても大丈夫！<br>
忘れては調べ、を何度も繰り返しながら染み込ませていこう。</p>

</section>
<section>
<h2 id="データ解析のおおまかな流れ">データ解析のおおまかな流れ</h2>
<ol>
<li>コンピュータ環境の整備</li>
<li>データの取得、読み込み</li>
<li>探索的データ解析
<ul>
<li><strong>前処理、加工</strong> (地味。意外と重い) 👈 明日以降の主題</li>
<li><strong>可視化</strong>、仮説生成 (派手！楽しい！) 👈 本日後半の主題</li>
<li><strong>統計解析</strong>、仮説検証 (みんな勉強したがる)</li>
</ul>
</li>
<li>報告、発表</li>
</ol>
<figure>
<a href="https://r4ds.had.co.nz/introduction.html">
<img src="/slides/image/r4ds/data-science.png" width="720">
<figcaption class="url">https://r4ds.had.co.nz/introduction.html</figcaption>
</a>
</figure>
</section>
<section>
<h2 id="実習全体の予定">実習全体の予定</h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left">時間</th>
          <th style="text-align: left">4/10 Mon</th>
          <th style="text-align: left">4/11 Tue</th>
          <th style="text-align: left">4/12 Wed</th>
          <th style="text-align: left">4/13 Thu</th>
          <th style="text-align: left">4/17 Mon</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">13:00</td>
          <td style="text-align: left"><strong>導入</strong></td>
          <td style="text-align: left"><strong>構造処理1</strong></td>
          <td style="text-align: left"><strong>内容処理</strong></td>
          <td style="text-align: left"><strong>統計モデル1</strong></td>
          <td style="text-align: left">発表会</td>
      </tr>
      <tr>
          <td style="text-align: left">14:40</td>
          <td style="text-align: left"><strong>可視化</strong></td>
          <td style="text-align: left"><strong>構造処理2</strong></td>
          <td style="text-align: left"><strong>入力・解釈</strong></td>
          <td style="text-align: left"><strong>統計モデル2</strong></td>
          <td style="text-align: left">発表会</td>
      </tr>
      <tr>
          <td style="text-align: left">16:20</td>
          <td style="text-align: left">練習問題</td>
          <td style="text-align: left">練習問題</td>
          <td style="text-align: left">練習問題</td>
          <td style="text-align: left">練習問題</td>
          <td style="text-align: left">予備</td>
      </tr>
  </tbody>
</table>
<ul>
<li>毎日最後に練習問題を出します。解けた班から解散。</li>
<li>レポート課題については今日の後半にお知らせ。<br>
🔰練習問題をちゃんとこなせば半自動的にレポートもできあがる仕掛け。</li>
</ul>

</section>
<section>
<h2 id="reference">Reference</h2>
<dl>
<dt>R for Data Science &mdash; Hadley Wickham and Garrett Grolemund</dt>
<dd><a href="https://r4ds.had.co.nz/">https://r4ds.had.co.nz/</a></dd>
<dd><a href="https://amzn.to/2tbRmVc">Book</a></dd>
<dd><a href="https://amzn.to/2yyFRKt">日本語版書籍(Rではじめるデータサイエンス)</a></dd>
</dl>
<ul>
<li><a href="https://amzn.to/3uCxTKo">データ分析のための数理モデル入門</a> 江崎貴裕 2020</li>
<li><a href="https://amzn.to/3ty80Kv">統計学を哲学する</a> 大塚淳 2020</li>
<li><a href="https://amzn.to/2Q0f6JQ">科学とモデル&mdash;シミュレーションの哲学 入門</a> Michael Weisberg 2017<br>
(原著: <a href="https://amzn.to/3bdvhuI">Simulation and Similarity</a> 2013)</li>
</ul>
<dl>
<dt>Other versions</dt>
<dd>「<a href="https://heavywatal.github.io/slides/tmd2022/">Rによるデータ前処理実習</a>」
岩嵜航 2022 東京医科歯科大</dd>
<dd>「<a href="https://comicalcommet.github.io/r-training-2022/">Rを用いたデータ解析の基礎と応用</a>」
石川由希 2022 名古屋大学</dd>
</dl>
<a href="2-visualization.html" class="readmore">
2. データの可視化、レポート作成。
</a>

</section>
</div>
</div>
</body>
</html>
