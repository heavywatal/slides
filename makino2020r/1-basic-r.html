<!DOCTYPE html>
<html lang="ja">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<title>R basics — Hands-on R Lecture for Makino Lab</title>
<link rel="icon" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180">
<link rel="manifest" href="/manifest.webmanifest">
<meta name="author" content="Watal M. Iwasaki">
<meta property="og:title" content="R basics — Hands-on R Lecture for Makino Lab">
<meta property="og:type" content="article">
<meta property="og:url" content="https://heavywatal.github.io/slides/makino2020r/1-basic-r.html">
<meta property="og:image" content="https://avatars.githubusercontent.com/heavywatal">
<meta property="og:description" content="">
<meta property="og:site_name" content="Slide decks — Heavy Watal">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@heavywatal">
<meta name="twitter:creator" content="@heavywatal">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-V60H2JH0G6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-V60H2JH0G6');
</script>
<link rel="stylesheet" href="/slides/lib/reveal.js/dist/reveal.css">
<script type="module">
import { Reveal } from "/slides/lib/reveal.js/reveal.js";
</script>
<style>
html { font-size: 160%; }
</style>
<link rel="stylesheet" href="/slides/lib/katex/katex.min.css">
<script type="module" src="/slides/lib/katex/katex.min.js"></script>
<link rel="stylesheet" href="/slides/lib/iconify.css">
<script defer src="/slides/lib/reload-img-onclick.js"></script>
<link rel="stylesheet" href="/slides/css/style-reveal.css">
</head>
<body>
<div class="reveal">
<div class="slides">
<section>
<h1 id="hands-on-introduction-to-r-2020"><a href=".">Hands-on Introduction to R 2020</a></h1>
<div class="author">
岩嵜 航 (Watal M. Iwasaki)
</div>
<div class="affiliation">
東北大学 生命科学研究科 進化ゲノミクス分野
</div>
<ol start="0">
<li><a href="0-why-r.html">Why do we use R?</a>
<li class="current-deck"><a href="1-basic-r.html">R basics</a>
<li><a href="2-ggplot.html">Visualization with R</a>
<li><a href="3-tidy-data.html">Tidying and transforming data with R</a>
<li><a href="4-statistics.html">Statistical analysis with R</a>
</ol>
<div class="footnote">
資料作成協力: 石川由希 (名古屋大学 理学研究科 脳回路構造学 講師)<br>
2020-05-27
</div>

</section>
<section>
<h2 id="r-basics-index">R basics: Index</h2>
<p>🖥 Setup R environment</p>
<p>👽 Conversation with R</p>
<p>📁 Create a &ldquo;project&rdquo; and &ldquo;script&rdquo;</p>
<p>➕ Basic operations and types</p>
<p>📦 Package</p>
<p>❓ Errors and questions</p>

</section>
<section>
<h2 id="環境依存の不具合-">環境依存の不具合 🤮</h2>
<ul>
<li>
<p><strong>&quot;<img height=22 width=22 src="https://cdn.simpleicons.org/windows"> Windows + 🇯🇵日本語ユーザー名&quot;
だと不具合が生じがち。</strong><br>
英語名ユーザーを作りなおして引っ越したほうがいい。</p>
</li>
<li>
<p>OS全体の言語設定も英語にするのがオススメ。</p>
</li>
<li>
<span style="color: #999999;">
できれば <img height=22 width=22 src="https://cdn.simpleicons.org/apple"> Macを使うのが無難。<br>
<img height=22 width=22 src="https://cdn.simpleicons.org/linux/333333"> Linuxが使えるならなお良い。
</span>
</li>
</ul>

</section>
<section>
<h2 id="keyboard-shortcuts">Keyboard shortcuts</h2>
<table>
  <thead>
      <tr>
          <th>Action</th>
          <th><img height=22 width=22 src="https://cdn.simpleicons.org/apple"> Mac</th>
          <th><img height=22 width=22 src="https://cdn.simpleicons.org/windows"> Windows</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Switch apps</td>
          <td><kbd>command</kbd><kbd>tab</kbd></td>
          <td><kbd>alt</kbd><kbd>tab</kbd></td>
      </tr>
      <tr>
          <td>Quit apps</td>
          <td><kbd>command</kbd><kbd>q</kbd></td>
          <td><kbd>alt</kbd><kbd>F4</kbd></td>
      </tr>
      <tr>
          <td>Spotlight</td>
          <td><kbd>command</kbd><kbd>space</kbd></td>
          <td></td>
      </tr>
      <tr>
          <td>Cut, Copy, Paste</td>
          <td><kbd>command</kbd><kbd>x</kbd>, -<kbd>c</kbd>, -<kbd>v</kbd></td>
          <td><kbd>ctrl</kbd><kbd>x</kbd>, -<kbd>c</kbd>, -<kbd>v</kbd></td>
      </tr>
      <tr>
          <td>Select all</td>
          <td><kbd>command</kbd><kbd>a</kbd></td>
          <td><kbd>ctrl</kbd><kbd>a</kbd></td>
      </tr>
      <tr>
          <td>Undo</td>
          <td><kbd>command</kbd><kbd>z</kbd></td>
          <td><kbd>ctrl</kbd><kbd>z</kbd></td>
      </tr>
      <tr>
          <td>Find</td>
          <td><kbd>command</kbd><kbd>f</kbd></td>
          <td><kbd>ctrl</kbd><kbd>f</kbd></td>
      </tr>
      <tr>
          <td>Save</td>
          <td><kbd>command</kbd><kbd>s</kbd></td>
          <td><kbd>ctrl</kbd><kbd>s</kbd></td>
      </tr>
  </tbody>
</table>
<p>See <a href="https://support.apple.com/HT201236">https://support.apple.com/HT201236</a></p>
</section>
<section>
<h2 id="setup-mac-environment">Setup Mac environment</h2>
<ul>
<li>
<p>Set OS language to <strong>English</strong> (System Preferences → Language &amp; Region)</p>
</li>
<li>
<p>Install <strong>Command Line Tools</strong> via <strong>Terminal.app</strong>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">xcode-select --install
</span></span></code></pre></div><p>Full Xcode is not necessary, but you can have it if you like.</p>
</li>
<li>
<p>Install <a href="/mac/homebrew.html">Homebrew</a> (software manager):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">/bin/bash -c <span class="s2">&#34;</span><span class="k">$(</span>curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh<span class="k">)</span><span class="s2">&#34;</span>
</span></span></code></pre></div></li>
<li>
<p>Try installing some softwares:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">brew install wget
</span></span><span class="line"><span class="cl">wget https://cran.r-project.org/Rlogo.svg
</span></span><span class="line"><span class="cl">ls
</span></span></code></pre></div></li>
</ul>

</section>
<section>
<h2 id="setup-r-environment">Setup R environment</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sh" data-lang="sh"><span class="line"><span class="cl">brew cask install r rstudio
</span></span></code></pre></div><dl>
<dt><a href="https://cran.r-project.org/">R</a></dt>
<dd>Core software to interpret and execute commands.</dd>
<dd>Standard packages and functions are included.</dd>
<dt><a href="https://www.rstudio.com/">RStudio Desktop</a></dt>
<dd>Integrated environment to help users interact with R.</dd>
<dd>Not necessary, but many people like it.</dd>
</dl>
<img src="/slides/image/rstudio/rstudio-300x260.png">

</section>
<section>
<h2 id="launch-rstudio-and-play-with-console">Launch RStudio and play with Console</h2>
<p><strong>Workspace (Environment)</strong> = a set of temporary objects</p>
<img src="/slides/image/rstudio/console.png" class="screenshot" width="100%">
</section>
<section>
<h2 id="configure-rstudio-not-to-saveload-workspace">Configure RStudio NOT to save/load workspace</h2>
<p><img height=22 width=22 src="https://cdn.simpleicons.org/apple"> RStudio → Preferences   <kbd>command</kbd><kbd>,</kbd><br>
<img height=22 width=22 src="https://cdn.simpleicons.org/windows"> Tools → Global options</p>
<p><strong>Uncheck</strong> &ldquo;Restore &hellip;&rdquo;, Choose <strong>Never</strong> for &ldquo;Save workspace &hellip;&rdquo;.</p>
<figure style="margin: 0;">
<a href="https://r4ds.had.co.nz/workflow-projects.html">
<img src="/slides/image/rstudio/preferences-workspace.png" width="75%"
     style="object-fit: cover; object-position: top; height: 450px;">
<figcaption class="url">https://r4ds.had.co.nz/workflow-projects.html</figcaption>
</a>
</figure>

</section>
<section>
<h2 id="create-project">Create &ldquo;Project&rdquo;</h2>
<p>File → New Project&hellip; → New Directory → New Project →<br>
→ Directory name: <code>r-training-2020</code><br>
→ as subdirectory of: <code>~/project</code></p>
<img src="/slides/image/rstudio/create-new-project.png" class="screenshot" width="90%">
</section>
<section>
<h2 id="write-r-script-and-send-it-to-console">Write R script, and send it to Console</h2>
<p>File → New File → R script</p>
<img src="/slides/image/rstudio/newfile.png" width="100%">
</section>
<section>
<h2 id="write-r-script-and-send-it-to-console">Write R script, and send it to Console</h2>
<p>File → New File → R script</p>
<img src="/slides/image/rstudio/script-console.png" width="100%">
</section>
<section>
<h2 id="write-r-script-and-send-it-to-console">Write R script, and send it to Console</h2>
<p>Select text with <kbd>shift</kbd><kbd>←</kbd><kbd>↓</kbd><kbd>↑</kbd><kbd>→</kbd><br>
Execute them with <kbd>ctrl</kbd><kbd>return</kbd></p>
<img src="/slides/image/rstudio/101.png" width="100%">
</section>
<section>
<h2 id="save-r-script-in-the-project-commands">Save R script in the project: <kbd>command</kbd><kbd>s</kbd></h2>
<p>Separate data, scripts, and results, e.g.,</p>
<pre tabindex="0"><code>r-training-2020/           # プロジェクトの最上階
├── data/                  # 元データを置くところ
│   ├── iris.tsv
│   └── diamonds.xlsx
├── r-training-2020.Rproj  # これダブルクリックでRStudioを起動
├── hello.R
├── output/                # 結果の出力先
│   ├── iris-petal.png
│   └── iris-summary.tsv
├── transform.R            # データ整理・変形のスクリプト
└── visualize.R            # 作図のスクリプト
</code></pre><p>プロジェクト最上階を作業ディレクトリとし、<br>
ファイル読み書きの基準にする。(後で詳しく)</p>
<p>ほんの一例です。好きな構造に決めてください。</p>

</section>
<section>
<h2 id="rと接する上での心構え">Rと接する上での心構え</h2>
<dl>
<dt>エラー文を恐れない</dt>
<dd>熟練プログラマでも頻繁にエラーを起こす。</dd>
<dd>エラーはRからのメッセージ。意図を読み取って修正しよう。</dd>
<dt>困ったらウェブ検索</dt>
<dd>あなたの問題は全世界のRユーザーが既に通った道。</dd>
<dd>日本語で、英語で、エラー文そのもので検索すれば解決策に当たる。</dd>
</dl>
<figure style="float: right; margin: 0;">
<img src="/slides/image/rstats/error.png" height="300">
</figure>
<dl>
<dt>(コードの)コピペ推奨</dt>
<dd>打ち間違いによるエラーを防げるし、早い。</dd>
<dd>ネット上で見つけたコードもまずはコピペしてから自分用に改変。</dd>
<dd>(ただし、ライセンスには注意&hellip;)</dd>
</dl>

</section>
<section>
<h2 id="create-objectsvariables-変数">Create objects/variables (変数)</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="m">42</span>       <span class="c1"># Create x</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span>            <span class="c1"># What&#39;s in x?</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 42
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="s">&#34;24601&#34;</span>  <span class="c1"># Create y</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span>            <span class="c1"># What&#39;s in y?</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;24601&#34;
</code></pre><p>Rでは代入演算子として矢印 <code>&lt;-</code> も使えるけど私は <code>=</code> 推奨。</p>
<p>この <code>x</code> と <code>y</code> を足そうとするとエラーになる。なぜ？</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">+</span> <span class="n">y</span>        <span class="c1"># Error! Why?</span>
</span></span></code></pre></div><pre tabindex="0"><code>Error in x + y: non-numeric argument to binary operator
</code></pre>
</section>
<section>
<h2 id="object-types-型">Object types (型)</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;numeric&#34;
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">is.numeric</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] TRUE
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">is.character</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] FALSE
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">as.character</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;42&#34;
</code></pre><p>Try applying the same functions to <code>y</code>.</p>
</section>
<section>
<h2 id="object-types-型">Object types (型)</h2>
<ul>
<li><code>vector</code>: 基本型。一次元の配列。
<ul>
<li><code>logical</code>: 論理値 (<code>TRUE</code> or <code>FALSE</code>)</li>
<li><code>numeric</code>: 数値 (整数 <code>42L</code> or 実数 <code>3.1416</code>)</li>
<li><code>character</code>: 文字列 (<code>&quot;a string&quot;</code>)</li>
<li><code>factor</code>: 因子 (文字列っぽいけど微妙に違う)</li>
</ul>
</li>
<li><code>array</code>: 多次元配列。<code>vector</code>同様、全要素が同じ型。
<ul>
<li><code>matrix</code>: 行列 = 二次元の配列。</li>
</ul>
</li>
<li><code>list</code>: 異なる型でも詰め込める太っ腹ベクトル。</li>
<li><strong><code>data.frame</code>: 同じ長さのベクトルを並べた長方形のテーブル。重要。</strong> <br>
<strong><code>tibble</code></strong> とか <strong><code>tbl_df</code></strong> と呼ばれる亜種もあるけどほぼ同じ。</li>
</ul>

</section>
<section>
<h2 id="function-関数">Function (関数)</h2>
<p>変数を受け取って、何か仕事して、返す命令セット</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>  <span class="c1"># 1と3を渡すとvectorが返ってくる</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 1 2 3
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>         <span class="c1"># vectorを渡すと足し算が返ってくる</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 6
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">square</span> <span class="o">=</span> <span class="kr">function</span><span class="p">(</span><span class="n">something</span><span class="p">)</span> <span class="p">{</span>  <span class="c1"># 自分の関数を定義</span>
</span></span><span class="line"><span class="cl">  <span class="n">something</span> <span class="o">**</span> <span class="m">2</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>                       <span class="c1"># 使ってみる</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 1 4 9
</code></pre>
</section>
<section>
<h2 id="vector-1-dimensional-array"><code>vector</code>: 1-dimensional array</h2>
<p>1個の値でもベクトル扱い。<br>
同じ長さ(または長さ1)の相手との計算が得意。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">9</span><span class="p">)</span>  <span class="c1"># 長さ3の数値ベクトル</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">+</span> <span class="n">x</span>           <span class="c1"># 同じ長さ同士の計算</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1]  2  4 18
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="m">10</span>          <span class="c1"># 長さ1の数値ベクトル</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">+</span> <span class="n">y</span>           <span class="c1"># 長さ3 + 長さ1 = 長さ3 (それぞれ足し算)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 11 12 19
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>         <span class="c1"># square root</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 1.000000 1.414214 3.000000
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># We don&#39;t have to write for-loop like this</span>
</span></span><span class="line"><span class="cl"><span class="n">z</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="kr">for</span> <span class="p">(</span><span class="n">i</span> <span class="kr">in</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">z[i]</span> <span class="o">=</span> <span class="nf">sqrt</span><span class="p">(</span><span class="n">x[i]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div>
</section>
<section>
<h2 id="matrix-2-dimensional-array-行列"><code>matrix</code>: 2-dimensional array (行列)</h2>
<p>1本の <code>vector</code> を折り曲げて長方形にしたもの。<br>
中身は全て同じ型。機械学習とか画像処理とかで使う。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">v</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">8</span><span class="p">)</span>              <span class="c1"># c(1, 2, 3, 4, 5, 6, 7, 8)</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">matrix</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>    <span class="c1"># 2行に畳む。列ごとに詰める</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span>
</span></span></code></pre></div><pre tabindex="0"><code>     [,1] [,2] [,3] [,4]
[1,]    1    3    5    7
[2,]    2    4    6    8
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="nf">matrix</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">byrow</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>  <span class="c1"># 行ごとに詰める</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span>
</span></span></code></pre></div><pre tabindex="0"><code>     [,1] [,2] [,3] [,4]
[1,]    1    2    3    4
[2,]    5    6    7    8
</code></pre><p>Let&rsquo;s try <code>x + y</code>, <code>dim(x)</code>, <code>nrow(x)</code>, <code>ncol(x)</code>.</p>

</section>
<section>
<h2 id="行-row-列-column-の憶え方">行 (row), 列 (column) の憶え方</h2>
<div class="column-container">
  <div class="column">
    <figure>
    <a href="https://commons.wikimedia.org/wiki/File:2012_Super_GT_Sugo_starting_grid.jpg">
    <img src="/slides/image/free/front-row.jpg" height="480">
    <figcaption class="url">https://commons.wikimedia.org/wiki/File:2012_Super_GT_Sugo_starting_grid.jpg</figcaption>
    </a>
    </figure>
  </div>
  <div class="column">
    <figure>
    <a href="https://en.wikipedia.org/wiki/Rhodes">
    <img src="/slides/image/free/apollon-columns.jpg" height="480">
    <figcaption class="url">https://en.wikipedia.org/wiki/Rhodes</figcaption>
    </a>
    </figure>
  </div>
</div>

</section>
<section>
<h2 id="dataframe-rectangle-table-important"><code>data.frame</code>: rectangle table (IMPORTANT!)</h2>
<p>同じ長さの列 <code>vector</code> を複数束ねた長方形の表。<br>
e.g., 長さ150の数値ベクトル4本と因子ベクトル1本:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>    Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;     &lt;fct&gt;
  1          5.1         3.5          1.4         0.2    setosa
  2          4.9         3.0          1.4         0.2    setosa
  3          4.7         3.2          1.3         0.2    setosa
  4          4.6         3.1          1.5         0.2    setosa
 --                                                            
147          6.3         2.5          5.0         1.9 virginica
148          6.5         3.0          5.2         2.0 virginica
149          6.2         3.4          5.4         2.3 virginica
150          5.9         3.0          5.1         1.8 virginica
</code></pre><p><code>iris</code> はアヤメ属3種150個体に関する測定データ。<br>
Rに最初から入ってて、例としてよく使われる。</p>

</section>
<section>
<h2 id="dataframeを眺める">data.frameを眺める</h2>
<p>概要を掴む:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">head</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="m">6</span><span class="p">)</span>   <span class="c1"># 先頭だけ見てみる</span>
</span></span><span class="line"><span class="cl"><span class="nf">nrow</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>      <span class="c1"># 行数: Number of ROWs</span>
</span></span><span class="line"><span class="cl"><span class="nf">ncol</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>      <span class="c1"># 列数: Number of COLumns</span>
</span></span><span class="line"><span class="cl"><span class="nf">names</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>     <span class="c1"># 列名</span>
</span></span><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>   <span class="c1"># 要約</span>
</span></span><span class="line"><span class="cl"><span class="nf">View</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>      <span class="c1"># RStudioで閲覧</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">str</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>       <span class="c1"># 構造が分かる形で表示</span>
</span></span></code></pre></div><pre tabindex="0"><code>tibble [150 × 5] (S3: tbl_df/tbl/data.frame)
 $ Sepal.Length: num [1:150] 5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num [1:150] 3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: num [1:150] 1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ Petal.Width : num [1:150] 0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ Species     : Factor w/ 3 levels &#34;setosa&#34;,&#34;versicolor&#34;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre><p>ほかのデータもいろいろ見てみよう, e.g., <code>mtcars</code>, <code>quakes</code>, <code>data()</code></p>

</section>
<section>
<h2 id="dataframeを眺める">data.frameを眺める</h2>
<p>部分的なdata.frameを取得する:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">iris[2</span><span class="p">,</span> <span class="n">]</span>                  <span class="c1"># 2行目</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[2</span><span class="o">:</span><span class="m">5</span><span class="p">,</span> <span class="n">]</span>                <span class="c1"># 2行目から5行目まで</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[</span><span class="p">,</span> <span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="n">]</span>                <span class="c1"># 3-4列目</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[2</span><span class="o">:</span><span class="m">5</span><span class="p">,</span> <span class="m">3</span><span class="o">:</span><span class="m">4</span><span class="n">]</span>             <span class="c1"># 2-5行目, 3-4列目</span>
</span></span></code></pre></div><p>vectorとして取得する:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">iris[[3]]</span>                  <span class="c1"># 3列目</span>
</span></span><span class="line"><span class="cl"><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span>          <span class="c1"># Petal.Length列</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[[</span><span class="s">&#34;Petal.Length&#34;</span><span class="n">]]</span>     <span class="c1"># Petal.Length列</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[[</span><span class="s">&#34;Petal.Length&#34;</span><span class="n">]][2]</span>  <span class="c1"># Petal.Length列の2番目</span>
</span></span></code></pre></div><p>結果がdata.frameになるかvectorになるか微妙:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">iris[</span><span class="p">,</span> <span class="m">3</span><span class="n">]</span>                  <span class="c1"># 3列目</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[</span><span class="p">,</span> <span class="s">&#34;Petal.Length&#34;</span><span class="n">]</span>     <span class="c1"># Petal.Length列</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[2</span><span class="p">,</span> <span class="m">3</span><span class="n">]</span>                 <span class="c1"># 2行目3列目</span>
</span></span><span class="line"><span class="cl"><span class="n">iris[2</span><span class="p">,</span> <span class="s">&#34;Petal.Length&#34;</span><span class="n">]</span>    <span class="c1"># 2行目Petal.Length列</span>
</span></span></code></pre></div>
</section>
<section>
<h2 id="dataframeの新規作成">data.frameの新規作成</h2>
<p>同じ長さの <strong>列(column) vector</strong> を結合して作る:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;A&#34;</span><span class="p">,</span> <span class="s">&#34;B&#34;</span><span class="p">,</span> <span class="s">&#34;C&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">mydata</span> <span class="o">=</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">mydata</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>  x y
1 1 A
2 2 B
3 3 C
</code></pre>
</section>
<section>
<h2 id="dataframeの読み書き">data.frameの読み書き</h2>
<ul>
<li>
<p>readxlパッケージを使えば <code>.xlsx</code> ファイルも読める、けど</p>
</li>
<li>
<p>カンマ区切り(CSV)とかタブ区切り(TSV)のテキストが無難。</p>
</li>
<li>
<p>ファイル名は<strong>作業ディレクトリ</strong>からの<strong>相対パス</strong>で指定。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#34;readr&#34;</span><span class="p">)</span> <span class="c1"># R標準の read.table() とかは難しいので</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span>            <span class="c1"># パッケージのやつを使うよ</span>
</span></span><span class="line"><span class="cl"><span class="nf">write_tsv</span><span class="p">(</span><span class="n">iris</span><span class="p">,</span> <span class="s">&#34;data/iris.tsv&#34;</span><span class="p">)</span>   <span class="c1"># 書き出し</span>
</span></span><span class="line"><span class="cl"><span class="n">iris2</span> <span class="o">=</span> <span class="nf">read_tsv</span><span class="p">(</span><span class="s">&#34;data/iris.tsv&#34;</span><span class="p">)</span>  <span class="c1"># 読み込み</span>
</span></span></code></pre></div></li>
<li>
<p>現在の作業ディレクトリとその中身を確認しておこう:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">getwd</span><span class="p">()</span>               <span class="c1"># Get Working Directory</span>
</span></span><span class="line"><span class="cl"><span class="nf">list.files</span><span class="p">(</span><span class="s">&#34;.&#34;</span><span class="p">)</span>       <span class="c1"># List files in &#34;.&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nf">list.files</span><span class="p">(</span><span class="s">&#34;data&#34;</span><span class="p">)</span>    <span class="c1"># List files in &#34;./data&#34;</span>
</span></span></code></pre></div></li>
</ul>
<p>R組み込みデータや自作データを読み書きしてみよう</p>

</section>
<section>
<h2 id="r-package">R package</h2>
<p>便利な関数やデータセットなどをひとまとめにしたもの。</p>
<dl>
<dt>Standard Packages</dt>
<dd>Rの標準機能。何もしなくても使用可能</dd>
<dt>Contributed Packages</dt>
<dd>有志により開発され、
<a href="https://cran.rstudio.com/web/packages/index.html">CRAN</a>
にまとめて公開されている。</dd>
<dd>要インストール。使う前に読み込むおまじないが必要。</dd>
</dl>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#34;readr&#34;</span><span class="p">)</span>  <span class="c1"># 一度やればOK</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">readr</span><span class="p">)</span>             <span class="c1"># 読み込みはRを起動するたびに必要</span>
</span></span><span class="line"><span class="cl"><span class="nf">update.packages</span><span class="p">()</span>          <span class="c1"># たまには更新しよう</span>
</span></span></code></pre></div><dl>
<dt>素のRも覚えきってないのにいきなりパッケージ？</dt>
<dd>大丈夫。誰も覚えきってない。</dd>
<dd>パッケージを使わないR作業 = 火もナイフも使わない料理</dd>
</dl>
</section>
<section>
<h2 id="tidyverse">tidyverse</h2>
<a href="https://www.tidyverse.org/">
<img src="/slides/image/rstats/hex-badges.png" width="260" align="right">
</a>
<p>Rでデータを上手に扱うためのパッケージ群</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#34;tidyverse&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 関連パッケージが一挙に読み込まれる</span>
</span></span></code></pre></div><ul>
<li>統一的な使い勝手</li>
<li>暗黙の処理をなるべくしない安全設計</li>
<li>シンプルな関数を繋げて使うデザイン</li>
</ul>
<figure>
<a href="https://r4ds.had.co.nz/introduction.html">
<img src="/slides/image/r4ds/data-science.png">
<figcaption class="url">https://r4ds.had.co.nz/introduction.html</figcaption>
</a>
</figure>
</section>
<section>
<h2 id="tidyverse">tidyverse</h2>
<a href="https://www.tidyverse.org/">
<img src="/slides/image/rstats/hex-badges.png" width="260" align="right">
</a>
<p>Rでデータを上手に扱うためのパッケージ群</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#34;tidyverse&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 関連パッケージが一挙に読み込まれる</span>
</span></span></code></pre></div><ul>
<li><code>Conflicts ❌</code> とか表示されて不安だけど<br>
これは大丈夫なやつ:</li>
</ul>
<pre tabindex="0"><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──
✔ ggplot2 3.3.0     ✔ purrr   0.3.4
✔ tibble  3.0.1     ✔ dplyr   0.8.5
✔ tidyr   1.1.0     ✔ stringr 1.4.0
✔ readr   1.3.1     ✔ forcats 0.5.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
</code></pre>
</section>
<section>
<h2 id="many-other-useful-packages">Many other useful packages</h2>
<a href="https://readxl.tidyverse.org/">
<img src="/_img/hex-stickers/readxl.webp" width="120" align="right">
</a>
<a href="https://stringr.tidyverse.org/">
<img src="/_img/hex-stickers/stringr.webp" width="120" align="right">
</a>
<ul>
<li><a href="https://readxl.tidyverse.org/">readxl</a>: エクセル形式の読み込み</li>
<li><a href="https://stringr.tidyverse.org/">stringr</a>: 文字列の処理</li>
<li><a href="https://www.bioconductor.org/">Bioconductor</a>: バイオインフォマティクス関連</li>
<li><a href="https://igraph.org/r/">igraph</a>: グラフ(ネットワーク)関連</li>
<li><a href="https://cran.r-project.org/package=rgl">rgl</a>: 3Dの作図</li>
<li><a href="https://rmarkdown.rstudio.com/">R Markdown</a>:
Rコマンドと結果を埋め込んだPDFやHTMLを作る。<br>
この発表スライドもそうやって作った。<br>
レポート作成や共同研究者への報告にも便利！</li>
</ul>

</section>
<section>
<h2 id="how-to-solve-problems">How to solve problems</h2>
<ul>
<li>RStudio内にヘルプを表示: <code>?sum</code>, <code>help.start()</code></li>
<li>変数の構造を確かめる: <code>str(iris)</code>, <code>attributes(iris)</code></li>
<li>エラー文をちゃんと読む: <code>No such file or directory</code></li>
<li>エラー文やパッケージ名をコピペしてウェブ検索<br>
→ <a href="https://stackoverflow.com/questions/tagged/r">StackOverflow</a>
や個人サイトに解決策</li>
<li>Slack <img height=22 width=22 src="https://cdn.simpleicons.org/slack">
<a href="https://github.com/tokyor/r-wakalang">r-wakalang</a>
で質問を投稿する。<br>
(質問に飢えた優しいワニが多数生息 👀   👀   👀   👀)</li>
<li>状況再現できる小さな例
<a href="https://reprex.tidyverse.org/">(reprex)</a>
を添えると回答を得やすい。<br>
(これを準備してるうちに問題が切り分けられて自己解決したり)</li>
<li>パッケージの公式ドキュメントをちゃんと読む</li>
</ul>

</section>
<section>
<h2 id="r-basics-summary">R basics: Summary</h2>
<p>✅ Write <strong>R script</strong>, and send it to <strong>Console</strong>.</p>
<p>✅ Object types: numeric <strong>vector</strong>, <strong>data.frame</strong>, etc.</p>
<p>✅ Use <strong>packages</strong>.</p>
<p>✅ <strong>Relax.</strong> You know how to solve problems.</p>

</section>
<section>
<h2 id="reference">Reference</h2>
<dl>
<dt>R for Data Science &mdash; Hadley Wickham and Garrett Grolemund</dt>
<dd><a href="https://r4ds.had.co.nz/">https://r4ds.had.co.nz/</a></dd>
<dd><a href="https://amzn.to/2tbRmVc">Book</a></dd>
<dd><a href="https://amzn.to/2yyFRKt">日本語版書籍(Rではじめるデータサイエンス)</a></dd>
<dt>Older versions</dt>
<dd>「<a href="https://heavywatal.github.io/slides/nagoya2018/">Rにやらせて楽しよう — データの可視化と下ごしらえ</a>」
岩嵜航 2018</dd>
<dd>「Rを用いたデータ解析の基礎と応用」石川由希 2019 名古屋大学</dd>
<dd>「<a href="https://heavywatal.github.io/slides/tmd2019/">Rによるデータ前処理実習</a>」
岩嵜航 2019 東京医科歯科大</dd>
</dl>
<a href="2-ggplot.html" rel="next" class="readmore">
2. Visualization with R
</a>

</section>
</div>
</div>
</body>
</html>
