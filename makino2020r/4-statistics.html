<!DOCTYPE html>
<html lang="ja">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<title>Statistical analysis with R â€” Hands-on R Lecture for Makino Lab</title>
<meta name="author" content="Watal M. Iwasaki">
<meta property="og:title" content="Statistical analysis with R â€” Hands-on R Lecture for Makino Lab">
<meta property="og:type" content="article">
<meta property="og:url" content="https://heavywatal.github.io/slides/makino2020r/4-statistics.html">
<meta property="og:image" content="https://avatars.githubusercontent.com/heavywatal">
<meta property="og:description" content="">
<meta property="og:site_name" content="Slide decks â€” Heavy Watal">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@heavywatal">
<meta name="twitter:creator" content="@heavywatal">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-V60H2JH0G6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-V60H2JH0G6');
</script>
<link rel="stylesheet" href="/slides/lib/reveal.js/reveal.css">
<script type="module">
import { Reveal } from "/slides/lib/reveal.js/reveal.js";
</script>
<style>
html { font-size: 160%; }
</style>
<link rel="stylesheet" href="/slides/lib/katex/katex.min.css">
<script type="module" src="/slides/lib/katex/katex.min.js"></script>
<link rel="stylesheet" href="/slides/lib/iconify.css">
<script defer src="/slides/lib/reload-img-onclick.js"></script>
<link rel="stylesheet" href="/slides/css/style-reveal.css">
</head>
<body>
<div class="reveal">
<div class="slides">
<section>
<link rel="stylesheet" href="style.css">
<h1 id="hands-on-introduction-to-r-2020"><a href=".">Hands-on Introduction to R 2020</a></h1>
<div class="author">
å²©åµœ èˆª (Watal M. Iwasaki)
</div>
<div class="affiliation">
æ±åŒ—å¤§å­¦ ç”Ÿå‘½ç§‘å­¦ç ”ç©¶ç§‘ é€²åŒ–ã‚²ãƒãƒŸã‚¯ã‚¹åˆ†é‡
</div>
<ol start="0">
<li><a href="0-why-r.html">Why do we use R?</a>
<li><a href="1-basic-r.html">R basics</a>
<li><a href="2-ggplot.html">Visualization with R</a>
<li><a href="3-tidy-data.html">Tidying and transforming data with R</a>
<li class="current-deck"><a href="4-statistics.html">Statistical analysis with R</a>
</ol>
<div class="footnote">
è³‡æ–™ä½œæˆå”åŠ›: çŸ³å·ç”±å¸Œ (åå¤å±‹å¤§å­¦ ç†å­¦ç ”ç©¶ç§‘ è„³å›è·¯æ§‹é€ å­¦ è¬›å¸«)<br>
2020-06-03
</div>

</section>
<section>
<h2 id="todays-topic">Today&rsquo;s topic</h2>
<ul>
<li><strike>Theoretical background of statistical analysis</strike></li>
<li>How to perform statistical analysis with R</li>
</ul>
<p><br><br>
Launch RStudio, and load <code>tidyverse</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>
</span></span></code></pre></div>
</section>
<section>
<h2 id="relationship-between-cty-ç‡ƒè²»--displ-æ’æ°—é‡">Relationship between <code>cty</code> (ç‡ƒè²») &amp; <code>displ</code> (æ’æ°—é‡)?</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">mpg</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">displ</span><span class="p">,</span> <span class="n">cty</span><span class="p">)</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">()</span>
</span></span></code></pre></div><p><img src="figure/plot-displ-cty-1.png" alt="plot of chunk plot-displ-cty"></p>
</section>
<section>
<h2 id="basic-form">Basic form</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Get the result as an object</span>
</span></span><span class="line"><span class="cl"><span class="n">formula</span> <span class="o">=</span> <span class="n">Y</span> <span class="o">~</span> <span class="n">X</span>
</span></span><span class="line"><span class="cl"><span class="n">model_object</span> <span class="o">=</span> <span class="nf">model_function</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">MYDATA</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># View its summary</span>
</span></span><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">model_object</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Get the estimated coefficients</span>
</span></span><span class="line"><span class="cl"><span class="nf">coef</span><span class="p">(</span><span class="n">model_object</span><span class="p">)</span>
</span></span></code></pre></div><p>where</p>
<ul>
<li><code>DATA</code>: data.frame, e.g., <code>iris</code>, <code>diamonds</code>, <strong><code>mpg</code></strong></li>
<li><code>Y</code>: response variable (a column in <code>DATA</code>), e.g., <strong><code>cty</code></strong></li>
<li><code>X</code>: explanatory variable (a column in <code>DATA</code>), e.g., <strong><code>displ</code></strong></li>
</ul>
</section>
<section>
<h2 id="general-linear-model-ä¸€èˆ¬ç·šå½¢ãƒ¢ãƒ‡ãƒ«">General Linear Model (ä¸€èˆ¬ç·šå½¢ãƒ¢ãƒ‡ãƒ«)</h2>
<p>Estimates the coefficients (ä¿‚æ•°) and intercept (åˆ‡ç‰‡).<br></p>
<p>$\text{cty} = - 2.63 \times \text{displ} + 25.99$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fit</span> <span class="o">=</span> <span class="nf">lm</span><span class="p">(</span><span class="n">cty</span> <span class="o">~</span> <span class="n">displ</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## 
## Call:
## lm(formula = cty ~ displ, data = mpg)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -6.3109 -1.4695 -0.2566  1.1087 14.0064 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  25.9915     0.4821   53.91   &lt;2e-16 ***
## displ        -2.6305     0.1302  -20.20   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.567 on 232 degrees of freedom
## Multiple R-squared:  0.6376,	Adjusted R-squared:  0.6361 
## F-statistic: 408.2 on 1 and 232 DF,  p-value: &lt; 2.2e-16
</code></pre>
</section>
<section>
<h2 id="general-linear-model-ä¸€èˆ¬ç·šå½¢ãƒ¢ãƒ‡ãƒ«">General Linear Model (ä¸€èˆ¬ç·šå½¢ãƒ¢ãƒ‡ãƒ«)</h2>
<p>Estimates the coefficients (ä¿‚æ•°) and intercept (åˆ‡ç‰‡).<br></p>
<p>$\text{cty} = - 2.63 \times \text{displ} + 25.99$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">a</span> <span class="o">=</span> <span class="nf">coef</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="n">[[1]]</span>
</span></span><span class="line"><span class="cl"><span class="n">b</span> <span class="o">=</span> <span class="nf">coef</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="n">[[2]]</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">mpg</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">displ</span><span class="p">,</span> <span class="n">cty</span><span class="p">)</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_abline</span><span class="p">(</span><span class="n">intercept</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;blue&#34;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="figure/lm-abline-1.png" alt="plot of chunk lm-abline"></p>

</section>
<section>
<h2 id="general-linear-model-ä¸€èˆ¬ç·šå½¢ãƒ¢ãƒ‡ãƒ«">General Linear Model (ä¸€èˆ¬ç·šå½¢ãƒ¢ãƒ‡ãƒ«)</h2>
<p>Estimates the coefficients (ä¿‚æ•°) and intercept (åˆ‡ç‰‡).<br></p>
<p>$\text{cty} = - 2.63 \times \text{displ} + 25.99$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">Y</span> <span class="o">=</span> <span class="nf">predict</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">mpg</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">displ</span><span class="p">,</span> <span class="n">cty</span><span class="p">)</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">Y</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;blue&#34;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="figure/lm-predict-1.png" alt="plot of chunk lm-predict"></p>

</section>
<section>
<h2 id="general-linear-model-ä¸€èˆ¬ç·šå½¢ãƒ¢ãƒ‡ãƒ«">General Linear Model (ä¸€èˆ¬ç·šå½¢ãƒ¢ãƒ‡ãƒ«)</h2>
<p>Estimates the coefficients (ä¿‚æ•°) and intercept (åˆ‡ç‰‡).<br></p>
<p>$\text{cty} = - 2.63 \times \text{displ} + 25.99$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">mpg</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">displ</span><span class="p">,</span> <span class="n">cty</span><span class="p">)</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stat_smooth</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">lm</span><span class="p">,</span> <span class="n">formula</span> <span class="o">=</span> <span class="n">y</span> <span class="o">~</span> <span class="n">x</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="figure/lm-smooth-1.png" alt="plot of chunk lm-smooth"></p>

</section>
<section>
<h2 id="generalized-linear-model-ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«">General<u>ized</u> Linear Model (ä¸€èˆ¬<u>åŒ–</u>ç·šå½¢ãƒ¢ãƒ‡ãƒ«)</h2>
<div>\[\begin{aligned}
\text{link}(Y) &= c_0 + c_1 x_1 + c_2 x_2 + \ldots + \epsilon \\
\epsilon &\sim \text{error}(\ldots)
\end{aligned}\]</div>
<ul>
<li><code>formula</code>: linear predictor (ç·šå½¢äºˆæ¸¬å­), e.g., <code>cty ~ displ</code></li>
<li><code>family</code>: error structure (èª¤å·®æ§‹é€ ), e.g., <code>gaussian</code>, <code>poisson</code>, <code>Gamma</code></li>
<li><code>link</code>: link function (ãƒªãƒ³ã‚¯é–¢æ•°), e.g., <code>&quot;identity&quot;</code>, <code>&quot;log&quot;</code>, <code>&quot;inverse&quot;</code></li>
</ul>
<p>LM is a special case of GLM:<br>
<code>glm(..., family = gaussian(&quot;identity&quot;))</code></p>
</section>
<section>
<h2 id="generalized-linear-model-ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«">General<u>ized</u> Linear Model (ä¸€èˆ¬<u>åŒ–</u>ç·šå½¢ãƒ¢ãƒ‡ãƒ«)</h2>
<p>$\log(\text{cty}) = -0.0155 \times \text{displ} + 3.344 + \epsilon$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fit</span> <span class="o">=</span> <span class="nf">glm</span><span class="p">(</span><span class="n">cty</span> <span class="o">~</span> <span class="n">displ</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="nf">Gamma</span><span class="p">(</span><span class="n">link</span> <span class="o">=</span> <span class="s">&#34;log&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## 
## Call:
## glm(formula = cty ~ displ, family = Gamma(link = &#34;log&#34;), data = mpg)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.40399  -0.08744  -0.01253   0.07447   0.55328  
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  3.344162   0.027644  120.97   &lt;2e-16 ***
## displ       -0.155497   0.007464  -20.83   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.02166931)
## 
##     Null deviance: 14.4350  on 233  degrees of freedom
## Residual deviance:  4.8065  on 232  degrees of freedom
## AIC: 1069.3
## 
## Number of Fisher Scoring iterations: 5
</code></pre>
</section>
<section>
<h2 id="generalized-linear-model-ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«">General<u>ized</u> Linear Model (ä¸€èˆ¬<u>åŒ–</u>ç·šå½¢ãƒ¢ãƒ‡ãƒ«)</h2>
<p>$\log(\text{cty}) = -0.0155 \times \text{displ} + 3.344 + \epsilon$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">mpg</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">displ</span><span class="p">,</span> <span class="n">cty</span><span class="p">)</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="nf">exp</span><span class="p">(</span><span class="nf">predict</span><span class="p">(</span><span class="n">fit</span><span class="p">))),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;blue&#34;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="figure/glm-gamma-log-plot-1.png" alt="plot of chunk glm-gamma-log-plot"></p>

</section>
<section>
<h2 id="generalized-linear-model-ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«">General<u>ized</u> Linear Model (ä¸€èˆ¬<u>åŒ–</u>ç·šå½¢ãƒ¢ãƒ‡ãƒ«)</h2>
<p>$(\text{cty})^{-1} = 0.010 \times \text{displ} + 0.027 + \epsilon$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fit</span> <span class="o">=</span> <span class="nf">glm</span><span class="p">(</span><span class="n">cty</span> <span class="o">~</span> <span class="n">displ</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="nf">Gamma</span><span class="p">(</span><span class="n">link</span> <span class="o">=</span> <span class="s">&#34;inverse&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## 
## Call:
## glm(formula = cty ~ displ, family = Gamma(link = &#34;inverse&#34;), 
##     data = mpg)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -0.38558  -0.08389  -0.01432   0.06985   0.51518  
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.026528   0.001471   18.04   &lt;2e-16 ***
## displ       0.010207   0.000461   22.14   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Gamma family taken to be 0.01922307)
## 
##     Null deviance: 14.4350  on 233  degrees of freedom
## Residual deviance:  4.3425  on 232  degrees of freedom
## AIC: 1045.5
## 
## Number of Fisher Scoring iterations: 4
</code></pre>
</section>
<section>
<h2 id="generalized-linear-model-ä¸€èˆ¬åŒ–ç·šå½¢ãƒ¢ãƒ‡ãƒ«">General<u>ized</u> Linear Model (ä¸€èˆ¬<u>åŒ–</u>ç·šå½¢ãƒ¢ãƒ‡ãƒ«)</h2>
<p>$(\text{cty})^{-1} = 0.010 \times \text{displ} + 0.027 + \epsilon$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">mpg</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">displ</span><span class="p">,</span> <span class="n">cty</span><span class="p">)</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="m">1</span> <span class="o">/</span> <span class="nf">predict</span><span class="p">(</span><span class="n">fit</span><span class="p">)),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;blue&#34;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="figure/glm-gamma-inverse-plot-1.png" alt="plot of chunk glm-gamma-inverse-plot"></p>

</section>
<section>
<h2 id="non-linear-least-square-éç·šå½¢æœ€å°äºŒä¹—æ³•">Non-linear Least-Square (éç·šå½¢æœ€å°äºŒä¹—æ³•)</h2>
<p>$\text{cty} = {28.7} / {\text{displ}} + 7.33$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fit</span> <span class="o">=</span> <span class="nf">nls</span><span class="p">(</span><span class="n">cty</span> <span class="o">~</span> <span class="n">k</span> <span class="o">/</span> <span class="n">displ</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="m">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## 
## Formula: cty ~ k/displ + b
## 
## Parameters:
##   Estimate Std. Error t value Pr(&gt;|t|)    
## k  28.7243     1.2000   23.94   &lt;2e-16 ***
## b   7.3309     0.4253   17.24   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.29 on 232 degrees of freedom
## 
## Number of iterations to convergence: 1 
## Achieved convergence tolerance: 7.471e-09
</code></pre>
</section>
<section>
<h2 id="non-linear-least-square-éç·šå½¢æœ€å°äºŒä¹—æ³•">Non-linear Least-Square (éç·šå½¢æœ€å°äºŒä¹—æ³•)</h2>
<p>$\text{cty} = {28.7} / {\text{displ}} + 7.33$</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">mpg</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">displ</span><span class="p">,</span> <span class="n">cty</span><span class="p">)</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_line</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="nf">predict</span><span class="p">(</span><span class="n">fit</span><span class="p">)),</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;blue&#34;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">0.8</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="figure/nls-plot-1.png" alt="plot of chunk nls-plot"></p>

</section>
<section>
<h2 id="model-comparison">Model comparison</h2>
<p>There are many statistics, e.g., AIC, BIC, WAIC, etc.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fit1</span> <span class="o">=</span> <span class="nf">lm</span><span class="p">(</span><span class="n">cty</span> <span class="o">~</span> <span class="n">displ</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">)</span> <span class="c1">#family = gaussian(&#34;identity&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">fit2</span> <span class="o">=</span> <span class="nf">glm</span><span class="p">(</span><span class="n">cty</span> <span class="o">~</span> <span class="n">displ</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="nf">Gamma</span><span class="p">(</span><span class="n">link</span> <span class="o">=</span> <span class="s">&#34;log&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">fit3</span> <span class="o">=</span> <span class="nf">glm</span><span class="p">(</span><span class="n">cty</span> <span class="o">~</span> <span class="n">displ</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="nf">Gamma</span><span class="p">(</span><span class="n">link</span> <span class="o">=</span> <span class="s">&#34;inverse&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">fit4</span> <span class="o">=</span> <span class="nf">nls</span><span class="p">(</span><span class="n">cty</span> <span class="o">~</span> <span class="n">k</span> <span class="o">/</span> <span class="n">displ</span> <span class="o">+</span> <span class="n">b</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">k</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="m">0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">AIC</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span> <span class="n">fit2</span><span class="p">,</span> <span class="n">fit3</span><span class="p">,</span> <span class="n">fit4</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>##      df      AIC
## fit1  3 1109.336
## fit2  3 1069.301
## fit3  3 1045.469
## fit4  3 1055.754
</code></pre>
</section>
<section>
<h2 id="model-comparison">Model comparison</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">MASS</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">full_model</span> <span class="o">=</span> <span class="nf">glm</span><span class="p">(</span><span class="n">cty</span> <span class="o">~</span> <span class="n">displ</span> <span class="o">+</span> <span class="n">cyl</span> <span class="o">+</span> <span class="n">drv</span> <span class="o">+</span> <span class="n">class</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">mpg</span><span class="p">,</span> <span class="n">family</span> <span class="o">=</span> <span class="nf">Gamma</span><span class="p">(</span><span class="n">link</span> <span class="o">=</span> <span class="s">&#34;inverse&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">stepAIC</span><span class="p">(</span><span class="n">full_model</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## Start:  AIC=943.41
## cty ~ displ + cyl + drv + class
## 
##         Df Deviance    AIC
## &lt;none&gt;       2.6029 943.41
## - displ  1   2.6322 943.90
## - drv    2   2.7778 954.27
## - cyl    1   2.9533 971.19
## - class  6   3.1371 976.80
## 
## Call:  glm(formula = cty ~ displ + cyl + drv + class, family = Gamma(link = &#34;inverse&#34;), 
##     data = mpg)
## 
## Coefficients:
##     (Intercept)            displ              cyl             drvf  
##        0.018435         0.002071         0.004419        -0.005448  
##            drvr     classcompact     classmidsize     classminivan  
##       -0.001596         0.010735         0.011227         0.017691  
##     classpickup  classsubcompact         classsuv  
##        0.019051         0.008377         0.016891  
## 
## Degrees of Freedom: 233 Total (i.e. Null);  223 Residual
## Null Deviance:	    14.43 
## Residual Deviance: 2.603 	AIC: 943.4
</code></pre>
</section>
<section>
<h2 id="tidymodels-meta-package"><code>tidymodels</code> meta-package</h2>
<p>For modeling and statistical analysis that share the underlying design philosophy, grammar, and data structures of the tidyverse.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">install.packages</span><span class="p">(</span><span class="s">&#34;tidymodels&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidymodels</span><span class="p">)</span>
</span></span></code></pre></div><ul>
<li><a href="https://broom.tidyverse.org/"><code>broom</code></a></li>
<li><a href="https://dplyr.tidyverse.org"><code>dplyr</code></a></li>
<li><a href="https://ggplot2.tidyverse.org"><code>ggplot2</code></a></li>
<li><a href="https://infer.netlify.com/"><code>infer</code></a></li>
<li><a href="https://purrr.tidyverse.org"><code>purrr</code></a></li>
<li><a href="https://tidymodels.github.io/recipes/"><code>recipes</code></a></li>
<li><a href="https://tidymodels.github.io/rsample/"><code>rsample</code></a></li>
<li><a href="https://tibble.tidyverse.org"><code>tibble</code></a></li>
<li><a href="https://tidymodels.github.io/yardstick/"><code>yardstick</code></a></li>
</ul>
</section>
<section>
<h2 id="broom-package"><code>broom</code> package</h2>
<p>Transfroms the messy output of R stats functions to tidy data.frames.</p>
<p><a href="https://broom.tidyverse.org/articles/available-methods.html">Available methods</a></p>

</section>
<section>
<h2 id="extract-results-from-fit">Extract results from <code>fit</code></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fit</span> <span class="o">=</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Sepal.Width</span> <span class="o">~</span> <span class="n">Petal.Length</span> <span class="o">+</span> <span class="n">Petal.Width</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">iris</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">summary</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## 
## Call:
## lm(formula = Sepal.Width ~ Petal.Length + Petal.Width, data = iris)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.06198 -0.23389  0.01982  0.20580  1.13488 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   3.58705    0.09373  38.272  &lt; 2e-16 ***
## Petal.Length -0.25714    0.06691  -3.843  0.00018 ***
## Petal.Width   0.36404    0.15496   2.349  0.02014 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3893 on 147 degrees of freedom
## Multiple R-squared:  0.2131,	Adjusted R-squared:  0.2024 
## F-statistic:  19.9 on 2 and 147 DF,  p-value: 2.238e-08
</code></pre>
</section>
<section>
<h2 id="extract-results-from-fit">Extract results from <code>fit</code></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fit</span> <span class="o">=</span> <span class="nf">lm</span><span class="p">(</span><span class="n">Sepal.Width</span> <span class="o">~</span> <span class="n">Petal.Length</span> <span class="o">+</span> <span class="n">Petal.Width</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">iris</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">tidy</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## # A tibble: 3 x 5
##   term         estimate std.error statistic  p.value
##   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)     3.59     0.0937     38.3  2.51e-78
## 2 Petal.Length   -0.257    0.0669     -3.84 1.80e- 4
## 3 Petal.Width     0.364    0.155       2.35 2.01e- 2
</code></pre>
</section>
<section>
<h2 id="tests-ä»®èª¬æ¤œå®š">Tests ä»®èª¬æ¤œå®š</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">chisq.test</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">fisher.test</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">kruskal.test</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">ks.test</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">t.test</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">var.test</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">wilcox.test</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># etc.</span>
</span></span></code></pre></div><p>See <a href="https://stat.ethz.ch/R-manual/R-patched/library/stats/html/00Index.html"><code>stats</code> package</a> for more details.</p>
</section>
<section>
<h2 id="probability-distributions-ç¢ºç‡åˆ†å¸ƒ">Probability distributions ç¢ºç‡åˆ†å¸ƒ</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># ç¢ºç‡å¯†åº¦é–¢æ•° (PDF)</span>
</span></span><span class="line"><span class="cl"><span class="nf">dnorm</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1.96</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 0.39894228 0.05844094
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># ç´¯ç©åˆ†å¸ƒé–¢æ•° (CDF)</span>
</span></span><span class="line"><span class="cl"><span class="nf">pnorm</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1.96</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 0.5000000 0.9750021
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># ç´¯ç©åˆ†å¸ƒé–¢æ•°ã®é€†é–¢æ•°</span>
</span></span><span class="line"><span class="cl"><span class="nf">qnorm</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span> <span class="m">0.975</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 0.000000 1.959964
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># ä¹±æ•°ç”Ÿæˆ</span>
</span></span><span class="line"><span class="cl"><span class="nf">rnorm</span><span class="p">(</span><span class="m">4</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] -0.2561510  0.5834819  0.4735194 -1.8780212
</code></pre>
</section>
<section>
<h2 id="è¨ˆç®—æ©Ÿã®é™ç•Œã«æ³¨æ„">è¨ˆç®—æ©Ÿã®é™ç•Œã«æ³¨æ„</h2>
<p><code>1 - pnorm(...)</code>ã‚„<code>log(pnorm(...))</code>ã®ã»ã†ãŒç›´æ„Ÿçš„ã«åˆ†ã‹ã‚Šã‚„ã™ã„ã®ã§ã€
<code>lower.tail = FALSE</code>ã‚„<code>log.p = TRUE</code>ã¯ä¸è¦ãªã‚ˆã†ã«ã‚‚æ€ã‚ã‚Œã‚‹ãŒã€
ã“ã‚Œã‚‰ã®å¼•æ•°ã§å†…éƒ¨å‡¦ç†ã•ã›ãŸã»ã†ãŒæµ®å‹•å°æ•°ç‚¹å‹ã®é™ç•Œä»˜è¿‘ã§ã®è¨ˆç®—ãŒæ­£ç¢ºã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># complementary</span>
</span></span><span class="line"><span class="cl"><span class="m">1</span> <span class="o">-</span> <span class="nf">pnorm</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>                  <span class="c1"># 0</span>
</span></span><span class="line"><span class="cl"><span class="nf">pnorm</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">lower.tail</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span>  <span class="c1"># 7.619853e-24</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># log</span>
</span></span><span class="line"><span class="cl"><span class="nf">log</span><span class="p">(</span><span class="nf">pnorm</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">))</span>                 <span class="c1"># 0</span>
</span></span><span class="line"><span class="cl"><span class="nf">pnorm</span><span class="p">(</span><span class="m">10</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">log.p</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>        <span class="c1"># -7.619853e-24</span>
</span></span></code></pre></div>
</section>
<section>
<h2 id="discrete-é›¢æ•£">Discrete é›¢æ•£</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">_binom</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_geom</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_hyper</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_nbinom</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">prob</span><span class="p">,</span> <span class="n">mu</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_pois</span><span class="p">(</span><span class="n">lambda</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_signrank</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_wilcox</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
</span></span></code></pre></div>
</section>
<section>
<h2 id="continuous-é€£ç¶š">Continuous é€£ç¶š</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">_beta</span><span class="p">(</span><span class="n">shape1</span><span class="p">,</span> <span class="n">shape2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_cauchy</span><span class="p">(</span><span class="n">location</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_chisq</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_exp</span><span class="p">(</span><span class="n">rate</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_f</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_gamma</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">rate</span> <span class="o">=</span> <span class="m">1</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="m">1</span> <span class="o">/</span> <span class="n">rate</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_lnorm</span><span class="p">(</span><span class="n">meanlog</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">sdlog</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_logis</span><span class="p">(</span><span class="n">location</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_norm</span><span class="p">(</span><span class="n">mean</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_t</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_unif</span><span class="p">(</span><span class="n">min</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">max</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">_weibull</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="m">1</span><span class="p">)</span>
</span></span></code></pre></div>
</section>
<section>
<h2 id="reference">Reference</h2>
<p><a href="https://stat.ethz.ch/R-manual/R-patched/library/stats/html/00Index.html"><code>stats</code> package</a></p>
<p><a href="https://github.com/tidymodels/tidymodels"><code>tidymodels</code></a></p>
<p><a href="https://broom.tidyverse.org/"><code>broom</code></a></p>
<p><a href="http://caret.r-forge.r-project.org/"><code>caret</code> package</a>
for machine learning</p>
<p><a href="https://mc-stan.org/rstan/"><code>stan</code> package</a>
for Bayesian modeling and inference.</p>
<a href="./" class="readmore">
ç›®æ¬¡ã«æˆ»ã‚‹
</a>

</section>
<section>
<h2 id="ç‰§é‡ç ”è¼ªèª­ä¼š-è£œéº">ç‰§é‡ç ”è¼ªèª­ä¼š è£œéº</h2>
<p><a href="https://amzn.to/2TpZFJv">&ldquo;Rã¨Stanã§ã¯ã˜ã‚ã‚‹ ãƒ™ã‚¤ã‚ºçµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿åˆ†æå…¥é–€&rdquo;</a>
ç¬¬2éƒ¨ ç¬¬1&ndash;3ç« </p>
</section>
<section>
<h2 id="ts-time-series-æ™‚ç³»åˆ—å‹"><code>ts</code>: time series (æ™‚ç³»åˆ—å‹)</h2>
<p><span style="float: right">2.1.13</span></p>
<p><code>vector</code> with labels and print format.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">timeser</span> <span class="o">=</span> <span class="nf">ts</span><span class="p">(</span><span class="kc">LETTERS</span><span class="p">,</span> <span class="n">start</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">2020</span><span class="p">,</span> <span class="m">5</span><span class="p">),</span> <span class="n">freq</span> <span class="o">=</span> <span class="m">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">timeser</span>
</span></span></code></pre></div><pre tabindex="0"><code>##      Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
## 2020                   A   B   C   D   E   F   G   H
## 2021   I   J   K   L   M   N   O   P   Q   R   S   T
## 2022   U   V   W   X   Y   Z
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">is</span><span class="p">(</span><span class="n">timeser</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] &#34;ts&#34;        &#34;structure&#34; &#34;oldClass&#34;  &#34;vector&#34;
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">is.character</span><span class="p">(</span><span class="n">timeser</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] TRUE
</code></pre>
</section>
<section>
<h2 id="random-number-generator-ä¹±æ•°ç”Ÿæˆå™¨">Random Number Generator (ä¹±æ•°ç”Ÿæˆå™¨)</h2>
<p><span style="float: right">2.1.15</span></p>
<p><code>r</code> + åˆ†å¸ƒã®åå‰ + <code>(length, parameters, ...)</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">set.seed</span><span class="p">(</span><span class="m">24601</span><span class="p">)</span>  <span class="c1"># ä¹±æ•°ã‚·ãƒ¼ãƒ‰ã‚’ã‚»ãƒƒãƒˆ</span>
</span></span><span class="line"><span class="cl"><span class="c1"># å¹³å‡50ã€æ¨™æº–åå·®10ã®æ­£è¦åˆ†å¸ƒã‹ã‚‰5å€‹ç”Ÿæˆ</span>
</span></span><span class="line"><span class="cl"><span class="nf">rnorm</span><span class="p">(</span><span class="m">5L</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="m">50</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 47.43849 55.83482 54.73519 31.21979 47.25679
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># ã‚‚ã†1å›å®Ÿè¡Œã™ã‚‹ã¨é•ã†çµæœ</span>
</span></span><span class="line"><span class="cl"><span class="nf">rnorm</span><span class="p">(</span><span class="m">5L</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="m">50</span><span class="p">,</span> <span class="n">sd</span> <span class="o">=</span> <span class="m">10</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 43.63798 52.56991 47.42713 37.70879 17.77750
</code></pre><dl>
<dt>ç–‘ä¼¼ä¹±æ•°</dt>
<dd>å†…éƒ¨çŠ¶æ…‹ã«ä¾å­˜ã—ã¦<strong>æ±ºå®šè«–çš„ã«</strong>ç”Ÿæˆã•ã‚Œã‚‹æ•°åˆ—ã€‚</dd>
<dd><strong>ä¹±æ•°ã‚·ãƒ¼ãƒ‰</strong>ã¯ã€å†…éƒ¨çŠ¶æ…‹ã‚’æŒ‡å®šã™ã‚‹ã€Œå¾©æ´»ã®å‘ªæ–‡ğŸ°ã€</dd>
</dl>

</section>
<section>
<h2 id="random-number-generator-ä¹±æ•°ç”Ÿæˆå™¨">Random Number Generator (ä¹±æ•°ç”Ÿæˆå™¨)</h2>
<p><span style="float: right">2.1.15</span></p>
<p>å†…éƒ¨çŠ¶æ…‹ãŒåŒã˜ãªã‚‰ã€ç”Ÿæˆã•ã‚Œã‚‹ä¹±æ•°ã‚‚åŒã˜ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">set.seed</span><span class="p">(</span><span class="m">24601</span><span class="p">)</span>  <span class="c1"># å†…éƒ¨çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ</span>
</span></span><span class="line"><span class="cl"><span class="nf">rnorm</span><span class="p">(</span><span class="m">5L</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>  <span class="c1"># ç”Ÿæˆã™ã‚‹ã¨ãã«å†…éƒ¨çŠ¶æ…‹ãŒå¤‰åŒ–ã™ã‚‹ã‘ã©</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] -0.2561510  0.5834819  0.4735194 -1.8780212 -0.2743209
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">set.seed</span><span class="p">(</span><span class="m">24601</span><span class="p">)</span>  <span class="c1"># å†…éƒ¨çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ</span>
</span></span><span class="line"><span class="cl"><span class="nf">rnorm</span><span class="p">(</span><span class="m">5L</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>  <span class="c1"># åŒã˜çµæœ</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] -0.2561510  0.5834819  0.4735194 -1.8780212 -0.2743209
</code></pre><p>ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚„è§£æã«å†ç¾æ€§ã‚’æ±‚ã‚ã‚‹å ´åˆã¯è¨­å®šå¿…é ˆã€‚<br>
(ã©ã‚“ãªã‚·ãƒ¼ãƒ‰ã§ã‚‚åŒã˜çµè«–ã«ãªã‚‹ã€ãŒç†æƒ³ã§ã¯ã‚ã‚‹ã‘ã©)</p>
<p>ã€Œã»ã—ã„çµæœãŒå‡ºã‚‹ã‚ˆã†ãªä¹±æ•°ã‚·ãƒ¼ãƒ‰ã‚’æ¢ã™ã€
ã¨ã‹ã‚„ã£ã¡ã‚ƒ<strong>ãƒ€ãƒ¡çµ¶å¯¾â€¼ï¸</strong></p>

</section>
<section>
<h2 id="for-loop">For-loop</h2>
<p><span style="float: right">2.1.16</span></p>
<p>Rã§ã¯ã»ã¼ä½¿ã‚ãªã„ã‘ã©ã€ã“ã®æ•™ç§‘æ›¸ã§ã¯ä½¿ã„ãŸã„ã‚‰ã—ã„ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="kr">for</span> <span class="p">(</span><span class="n">i</span> <span class="kr">in</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 1
## [1] 2
## [1] 3
</code></pre>
</section>
<section>
<h2 id="histogram">Histogram</h2>
<p><span style="float: right">2.2.2</span></p>
<p>é€£ç¶šå€¤ã‚’ã„ãã¤ã‹ã®binã«åŒºåˆ‡ã£ã¦æ•°ãˆãŸã‚‚ã®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_histogram</span><span class="p">(</span><span class="n">bins</span> <span class="o">=</span> <span class="m">40L</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="figure/histogram-1.png" alt="plot of chunk histogram"></p>

</section>
<section>
<h2 id="kernel-density-estimation-ã‚«ãƒ¼ãƒãƒ«å¯†åº¦æ¨å®š">Kernel Density Estimation (ã‚«ãƒ¼ãƒãƒ«å¯†åº¦æ¨å®š)</h2>
<p><span style="float: right">2.2.3</span></p>
<p>ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã‚’æ­£è¦åˆ†å¸ƒã§æ»‘ã‚‰ã‹ã«ã—ãŸã‚‚ã®</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_rug</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">0.1</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.05</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_density</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_density</span><span class="p">(</span><span class="n">adjust</span> <span class="o">=</span> <span class="m">1</span> <span class="o">/</span> <span class="m">4</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;red&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_density</span><span class="p">(</span><span class="n">adjust</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s">&#34;blue&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="figure/kde-1.png" alt="plot of chunk kde"></p>

</section>
<section>
<h2 id="summary-statistics-è¦ç´„çµ±è¨ˆé‡">Summary Statistics (è¦ç´„çµ±è¨ˆé‡)</h2>
<p><span style="float: right">2.2.4, 5</span></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># å¹³å‡å€¤: æ™®é€šã®ç®—è¡“å¹³å‡ã€‚tailã«å¼•ã£å¼µã‚‰ã‚Œã‚‹ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="nf">mean</span><span class="p">(</span><span class="n">diamonds[[</span><span class="s">&#34;price&#34;</span><span class="n">]]</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 3932.8
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># ä¸­å¤®å€¤: é †ä½ã§çœŸã‚“ä¸­ã«ã‚ã‚‹å€¤ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="nf">median</span><span class="p">(</span><span class="n">diamonds[[</span><span class="s">&#34;price&#34;</span><span class="n">]]</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 2401
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># å››åˆ†ä½ç‚¹: ä¸Šä½ãƒ»ä¸‹ä½25%ã«ã‚ã‚‹å€¤ã€‚</span>
</span></span><span class="line"><span class="cl"><span class="nf">quantile</span><span class="p">(</span><span class="n">diamonds[[</span><span class="s">&#34;price&#34;</span><span class="n">]]</span><span class="p">,</span> <span class="n">probs</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.25</span><span class="p">,</span> <span class="m">0.75</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>##     25%     75% 
##  950.00 5324.25
</code></pre>
</section>
<section>
<h2 id="correlation-ç›¸é–¢">Correlation (ç›¸é–¢)</h2>
<p><span style="float: right">2.2.6</span></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># Covariance (å…±åˆ†æ•£) &gt; 0 ãªã‚‰ã€</span>
</span></span><span class="line"><span class="cl"><span class="c1"># carat ãŒå¤§ãããªã‚‹ã»ã© price ã‚‚å¤§ãããªã‚‹</span>
</span></span><span class="line"><span class="cl"><span class="nf">cov</span><span class="p">(</span><span class="n">diamonds[[</span><span class="s">&#34;carat&#34;</span><span class="n">]]</span><span class="p">,</span> <span class="n">diamonds[[</span><span class="s">&#34;price&#34;</span><span class="n">]]</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 1742.765
</code></pre><p>â†‘ã“ã®å€¤ã ã‘è¦‹ã¦ã‚‚ãã®åº¦åˆã„ã¯æƒ³åƒã—ã«ãã„ã®ã§ã€<br>
å€¤ãŒ [-1, 1] ã«ãªã‚‹ã‚ˆã†ã«æ­£è¦åŒ–ã—ãŸã‚‚ã®ãŒç›¸é–¢ä¿‚æ•°â†“</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">cor</span><span class="p">(</span><span class="n">diamonds[[</span><span class="s">&#34;carat&#34;</span><span class="n">]]</span><span class="p">,</span> <span class="n">diamonds[[</span><span class="s">&#34;price&#34;</span><span class="n">]]</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>## [1] 0.9215913
</code></pre><p>çµæ§‹å¼·ã„ç›¸é–¢ã ãªã€‚</p>

</section>
<section>
<h2 id="autocorrelation-è‡ªå·±ç›¸é–¢">Autocorrelation (è‡ªå·±ç›¸é–¢)</h2>
<p><span style="float: right">2.2.7</span></p>
<p>æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã«ãŠã„ã¦ã€næ™‚ç‚¹å‰ã®å€¤ã¨ã®ç›¸é–¢ã‚’å–ã£ãŸã‚‚ã®ã€‚<br>
1æ¬¡ã®è‡ªå·±ç›¸é–¢ = 1æ™‚ç‚¹å‰ã¨ã®ç›¸é–¢</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">ac</span> <span class="o">=</span> <span class="nf">acf</span><span class="p">(</span><span class="n">Nile</span><span class="p">,</span> <span class="n">lag.max</span> <span class="o">=</span> <span class="m">10</span><span class="p">,</span> <span class="n">plot</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="n">broom</span><span class="o">::</span><span class="nf">tidy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">ac</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">lag</span><span class="p">,</span> <span class="n">acf</span><span class="p">)</span> <span class="o">+</span> <span class="nf">geom_col</span><span class="p">()</span> <span class="o">+</span> <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">n.breaks</span> <span class="o">=</span> <span class="m">10L</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="figure/acf-1.png" alt="plot of chunk acf"></p>

</section>
</div>
</div>
</body>
</html>
