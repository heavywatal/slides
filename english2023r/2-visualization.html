<!DOCTYPE html>
<html>
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<title>2. Data visualization and reporting ‚Äî Hands-on Introduction to R 2023</title>
<meta name="author" content="Watal M. Iwasaki">
<meta property="og:title" content="2. Data visualization and reporting ‚Äî Hands-on Introduction to R 2023">
<meta property="og:type" content="article">
<meta property="og:url" content="https://heavywatal.github.io/slides/english2023r/2-visualization.html">
<meta property="og:image" content="https://avatars.githubusercontent.com/heavywatal">
<meta property="og:description" content="">
<meta property="og:site_name" content="Slide decks ‚Äî Heavy Watal">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@heavywatal">
<meta name="twitter:creator" content="@heavywatal">
<link rel="stylesheet" href="/lib/katex/katex.min.css">
<script defer src="/lib/katex/katex.min.js"></script>
<script defer src="/lib/katex/contrib/auto-render.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  renderMathInElement(document.body, {
    delimiters: [
      {left: "\\[", right: "\\]", display: true},
      {left: "$", right: "$", display: false}
    ]
  });
});
</script>
<style>
.katex {
  font-size: 1.12em;
}

.katex-display > .katex {
  text-align: left;
  padding-left: 2rem;
}
</style>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-V60H2JH0G6"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-V60H2JH0G6', { 'anonymize_ip': false });
}
</script>
<link rel="stylesheet" href="/slides/lib/reveal.js/reveal.css">
<script defer src="/slides/lib/reveal.js/reveal.js"></script>
<script defer src="/slides/lib/reveal.js/plugin/notes/notes.js"></script>
<script defer src="/slides/lib/reveal.js/plugin/search/search.js"></script>
<script defer src="/slides/lib/reveal-initialize.js"></script>
<script>
window.addEventListener('DOMContentLoaded', function() {
  Reveal.configure({width: 1440, height: 1080});
  document.querySelector('html').style.fontSize = '240%';
})
</script>
<script defer src="/slides/lib/reload-img-onclick.js"></script>
<link rel="stylesheet" href="/slides/css/style-reveal.css">
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="reveal">
<div class="slides">
<section>
<h1 id="hands-on-introduction-to-r-2023"><a href=".">Hands-on Introduction to R 2023</a></h1>
<div class="author">
Â≤©Âµú Ëà™ (Watal M. Iwasaki, PhD)
</div>
<div class="affiliation">
Graduate School of Life Sciences, Tohoku University
</div>
<ol>
<li><a href="1-introduction.html">Introduction: what is data analysis and R basics</a>
<li class="current-deck"><a href="2-visualization.html">Data visualization and reporting</a>
<li><a href="3-structure1.html">Data transformation 1: extract, summarize</a>
<li><a href="4-structure2.html">Data transformation 2: join, pivot</a>
<li><a href="5-content.html">Data cleansing and conversion: numbers, text</a>
<li><a href="6-input.html">Data input and interpretation</a>
<li><a href="7-distribution.html">Statistical modeling 1: probability distribution, likelihood</a>
<li><a href="8-glm.html">Statistical modeling 2: linear regression</a>
</ol>
<div class="footnote">
2023-11-28 Tohoku University<br>
<a href="https://heavywatal.github.io/slides/english2023r/">https://heavywatal.github.io/slides/english2023r/</a>
</div>

</section>
<section>
<h2 id="outline-of-data-analysis">Outline of data analysis</h2>
<ol>
<li>Setup computer environment</li>
<li>Get and read input data</li>
<li>Exploratory data analysis
<ul>
<li><strong>Preparation</strong> (harder than it seems) üëà lecture #3&ndash;5</li>
<li><strong>Visualization</strong>, generating hypotheses (fun!) üëà today</li>
<li><strong>Statistical analysis</strong>, testing hypotheses</li>
</ul>
</li>
<li>Report</li>
</ol>
<figure>
<a href="https://r4ds.hadley.nz/intro">
<img src="/slides/image/r4ds/data-science.png" width="720">
<figcaption class="url">https://r4ds.hadley.nz/intro</figcaption>
</a>
</figure>
</section>
<section>
<h2 id="visualization-helps-overviewing-data-structure">Visualization helps overviewing data structure</h2>
<p>Reduction and reorganization of information ‚Üí <strong>intuitive understanding</strong></p>
<img src="figure/simplify-diamonds-1.png" alt="plot of chunk simplify-diamonds">
<p>The larger <code>carat</code>, the higher <code>price</code>.<br>
The slope seems to differ by <code>clarity</code>.</p>

</section>
<section>
<h2 id="never-trust-summary-statics-alone">Never trust summary statics alone</h2>
<p>Interesting relationships may be overlooked without visualization.</p>
<figure style="position: relative;">
<a href="https://www.autodesk.com/research/publications/same-stats-different-graphs">
<img src="/slides/image/rstats/datasaurus.png" width="86%">
<figcaption class="url">https://www.autodesk.com/research/publications/same-stats-different-graphs</figcaption>
</a>
<img src="/slides/image/rstats/DataDino-600x455.gif" width="20%"
     style="position: absolute; left: 0; top: 0; z-index: 255;">
</figure>
</section>
<section>
<h2 id="visualization-requires-an-innate-sense-of-beauty">Visualization requires an innate sense of beauty?</h2>
<figure style="float: right; width: 670px; margin: 1rem 0;">
<a href="https://tsutawarudesign.com/">
<img src="/slides/image/tsutawaru/title-13.svg" style="margin: 0 -20px 0 0;">
<img src="/slides/image/tsutawaru/hajimeni-03.svg" style="margin: 0 -20px 0 0;">
<figcaption class="url">https://tsutawarudesign.com/</figcaption>
</a>
</figure>
<p>NO!</p>
<p>To some extent,<br>
it is about knowledge and skills.</p>
<p>You can improve it<br>
once you know the basic design rules.</p>

</section>
<section>
<h2 id="todays-lesson-data-visualization-and-reporting-with-r">Today&rsquo;s lesson: data visualization and reporting with R</h2>
<h3 id="-deloutline-of-data-analysis-visualization-is-importantdel">‚úÖ <del>Outline of data analysis: visualization is important</del></h3>
<h3 id="-draw-graphs-in-a-consistent-manner-with-ggplot2">‚¨ú Draw graphs in a consistent manner with ggplot2</h3>
<h3 id="-embed-r-code-and-results-into-a-report-with-quarto">‚¨ú Embed R code and results into a report with Quarto</h3>

</section>
<section>
<h2 id="iris-an-example-dataset"><code>iris</code>: an example dataset</h2>
<p>4 numeric and 1 factor vectors with the length of 150:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">iris</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>    Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
  1          5.1         3.5          1.4         0.2    setosa
  2          4.9         3.0          1.4         0.2    setosa
  3          4.7         3.2          1.3         0.2    setosa
  4          4.6         3.1          1.5         0.2    setosa
 --                                                            
147          6.3         2.5          5.0         1.9 virginica
148          6.5         3.0          5.2         2.0 virginica
149          6.2         3.4          5.4         2.3 virginica
150          5.9         3.0          5.1         1.8 virginica
</code></pre>
</section>
<section>
<h2 id="base-r-graphics">Base R graphics</h2>
<p><strong>inconsistent</strong> and <strong>difficult to customize</strong> details.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">boxplot</span><span class="p">(</span><span class="n">Petal.Width</span> <span class="o">~</span> <span class="n">Species</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">iris</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">plot</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Length</span><span class="p">,</span> <span class="n">iris</span><span class="o">$</span><span class="n">Sepal.Width</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">hist</span><span class="p">(</span><span class="n">iris</span><span class="o">$</span><span class="n">Petal.Length</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="./figure/base-plot-iris-1.png" alt="plot of chunk base-plot-iris"><img src="./figure/base-plot-iris-2.png" alt="plot of chunk base-plot-iris"><img src="./figure/base-plot-iris-3.png" alt="plot of chunk base-plot-iris"></p>
<p>Any useful package to draw beautiful graphs easily?</p>

</section>
<section>
<h2 id="ggplot2-a-tidyverse-member-in-charge-of-graphics">ggplot2: a tidyverse member in charge of graphics</h2>
<a href="https://ggplot2.tidyverse.org/">
<img src="/_img/hex-stickers/ggplot2.webp" width="180" align="right">
</a>
<ul>
<li>can draw many types of graphs in a <strong>rational</strong> and <strong>consistent</strong> manner.</li>
<li>based on &ldquo;The <strong><u>G</u></strong>rammar of <strong><u>G</u></strong>raphics&rdquo; (Wilkinson 2005).</li>
</ul>
<br>
<p><img src="./figure/ggplot-iris-1.png" alt="plot of chunk ggplot-iris"><img src="./figure/ggplot-iris-2.png" alt="plot of chunk ggplot-iris"><img src="./figure/ggplot-iris-3.png" alt="plot of chunk ggplot-iris"></p>
</section>
<section>
<h2 id="ggplot2-a-tidyverse-member-in-charge-of-graphics">ggplot2: a tidyverse member in charge of graphics</h2>
<a href="https://ggplot2.tidyverse.org/">
<img src="/_img/hex-stickers/ggplot2.webp" width="180" align="right">
</a>
<ul>
<li>can draw many types of graphs in a <strong>rational</strong> and <strong>consistent</strong> manner.</li>
<li>based on &ldquo;The <strong><u>G</u></strong>rammar of <strong><u>G</u></strong>raphics&rdquo; (Wilkinson 2005).</li>
</ul>
<figure>
<!--
<img src="/slides/image/nagoya/iris.png" width="24%">
<img src="/slides/image/nagoya/binhex.png" width="24%">
<img src="/slides/image/nagoya/faithful.png" width="24%">
-->
<img src="/slides/image/tumopp/paper/Fig1.png" height="400">
<img src="/slides/image/tumopp/param-p.png" height="400">
<img src="/slides/image/tumopp/param-k.png" height="400"><br>
<img src="/slides/image/tumopp/paper/Fig3.png" height="200">
<img src="/slides/image/tumopp/Cmoore_Lconst.gif" height="200">
<img src="/slides/image/tumopp/Cmoore_Llinear.gif" height="200">
<img src="/slides/image/tumopp/Chex_Lconst.gif" height="200">
<img src="/slides/image/tumopp/Chex_Llinear.gif" height="200">
<figcaption class="url">Iwasaki and Innan (2017)</figcaption>
</figure>
</section>
<section>
<h2 id="learn-ggplot2-without-knowing-base-r-graphics">Learn ggplot2 without knowing base R graphics</h2>
<p>No problem. Underlying systems are fundamentally different:</p>
<figure>
<img src="/slides/image/rstats/r-graphics.svg" height="600">
<figcaption><cite>„ÄåR„Ç∞„É©„Éï„Ç£„ÉÉ„ÇØ„Çπ„ÄçMurrellËëó ‰πÖ‰øùË®≥ „Çà„ÇäÊîπÂ§â</cite></figcaption>
</figure>
</section>
<section>
<h2 id="basic-usage-join-layers-with--operator">Basic usage: join layers with <code>+</code> operator</h2>
<img src="/slides/image/rstats/ggplot-layers.png" height="930">
</section>
<section>
<h2 id="basic-usage-join-layers-with--operator">Basic usage: join layers with <code>+</code> operator</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">diamonds</span><span class="p">)</span>             <span class="c1"># prepare canvas with diamonds data</span>
</span></span><span class="line"><span class="cl"><span class="c1"># aes(x = carat, y = price) +       # map (carat, price) to (x, y) axes</span>
</span></span><span class="line"><span class="cl"><span class="c1"># geom_point() +                    # draw scatter plot</span>
</span></span><span class="line"><span class="cl"><span class="c1"># facet_wrap(vars(clarity)) +       # split panels according to clarity</span>
</span></span><span class="line"><span class="cl"><span class="c1"># stat_smooth(method = lm) +        # add linear regression</span>
</span></span><span class="line"><span class="cl"><span class="c1"># coord_cartesian(ylim = c(0, 2e4)) + # adjust y-axis range</span>
</span></span><span class="line"><span class="cl"><span class="c1"># theme_classic(base_size = 20)     # adjust non-data components</span>
</span></span></code></pre></div><p><img src="./figure/ggplot-plus1-1.png" alt="plot of chunk ggplot-plus1"></p>
</section>
<section>
<h2 id="basic-usage-join-layers-with--operator">Basic usage: join layers with <code>+</code> operator</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span>           <span class="c1"># prepare canvas with diamonds data</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">carat</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span>         <span class="c1"># map (carat, price) to (x, y) axes</span>
</span></span><span class="line"><span class="cl"><span class="c1"># geom_point() +                    # draw scatter plot</span>
</span></span><span class="line"><span class="cl"><span class="c1"># facet_wrap(vars(clarity)) +       # split panels according to clarity</span>
</span></span><span class="line"><span class="cl"><span class="c1"># stat_smooth(method = lm) +        # add linear regression</span>
</span></span><span class="line"><span class="cl"><span class="c1"># coord_cartesian(ylim = c(0, 2e4)) + # adjust y-axis range</span>
</span></span><span class="line"><span class="cl"><span class="c1"># theme_classic(base_size = 20)     # adjust non-data components</span>
</span></span></code></pre></div><p><img src="./figure/ggplot-plus2-1.png" alt="plot of chunk ggplot-plus2"></p>
</section>
<section>
<h2 id="basic-usage-join-layers-with--operator">Basic usage: join layers with <code>+</code> operator</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span>           <span class="c1"># prepare canvas with diamonds data</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">carat</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>       <span class="c1"># map (carat, price) to (x, y) axes</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">()</span>                      <span class="c1"># draw scatter plot</span>
</span></span><span class="line"><span class="cl"><span class="c1"># facet_wrap(vars(clarity)) +       # split panels according to clarity</span>
</span></span><span class="line"><span class="cl"><span class="c1"># stat_smooth(method = lm) +        # add linear regression</span>
</span></span><span class="line"><span class="cl"><span class="c1"># coord_cartesian(ylim = c(0, 2e4)) + # adjust y-axis range</span>
</span></span><span class="line"><span class="cl"><span class="c1"># theme_classic(base_size = 20)     # adjust non-data components</span>
</span></span></code></pre></div><p><img src="./figure/ggplot-plus3-1.png" alt="plot of chunk ggplot-plus3"></p>
</section>
<section>
<h2 id="basic-usage-join-layers-with--operator">Basic usage: join layers with <code>+</code> operator</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span>           <span class="c1"># prepare canvas with diamonds data</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">carat</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>       <span class="c1"># map (carat, price) to (x, y) axes</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>                    <span class="c1"># draw scatter plot</span>
</span></span><span class="line"><span class="cl">  <span class="nf">facet_wrap</span><span class="p">(</span><span class="nf">vars</span><span class="p">(</span><span class="n">clarity</span><span class="p">))</span>         <span class="c1"># split panels according to clarity</span>
</span></span><span class="line"><span class="cl"><span class="c1"># stat_smooth(method = lm) +        # add linear regression</span>
</span></span><span class="line"><span class="cl"><span class="c1"># coord_cartesian(ylim = c(0, 2e4)) + # adjust y-axis range</span>
</span></span><span class="line"><span class="cl"><span class="c1"># theme_classic(base_size = 20)     # adjust non-data components</span>
</span></span></code></pre></div><p><img src="./figure/ggplot-plus4-1.png" alt="plot of chunk ggplot-plus4"></p>
</section>
<section>
<h2 id="basic-usage-join-layers-with--operator">Basic usage: join layers with <code>+</code> operator</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span>           <span class="c1"># prepare canvas with diamonds data</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">carat</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>       <span class="c1"># map (carat, price) to (x, y) axes</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>                    <span class="c1"># draw scatter plot</span>
</span></span><span class="line"><span class="cl">  <span class="nf">facet_wrap</span><span class="p">(</span><span class="nf">vars</span><span class="p">(</span><span class="n">clarity</span><span class="p">))</span> <span class="o">+</span>       <span class="c1"># split panels according to clarity</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stat_smooth</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">lm</span><span class="p">)</span>          <span class="c1"># add linear regression</span>
</span></span><span class="line"><span class="cl"><span class="c1"># coord_cartesian(ylim = c(0, 2e4)) + # adjust y-axis range</span>
</span></span><span class="line"><span class="cl"><span class="c1"># theme_classic(base_size = 20)     # adjust non-data components</span>
</span></span></code></pre></div><p><img src="./figure/ggplot-plus5-1.png" alt="plot of chunk ggplot-plus5"></p>
</section>
<section>
<h2 id="basic-usage-join-layers-with--operator">Basic usage: join layers with <code>+</code> operator</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span>           <span class="c1"># prepare canvas with diamonds data</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">carat</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>       <span class="c1"># map (carat, price) to (x, y) axes</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>                    <span class="c1"># draw scatter plot</span>
</span></span><span class="line"><span class="cl">  <span class="nf">facet_wrap</span><span class="p">(</span><span class="nf">vars</span><span class="p">(</span><span class="n">clarity</span><span class="p">))</span> <span class="o">+</span>       <span class="c1"># split panels according to clarity</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stat_smooth</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">lm</span><span class="p">)</span> <span class="o">+</span>        <span class="c1"># add linear regression</span>
</span></span><span class="line"><span class="cl">  <span class="nf">coord_cartesian</span><span class="p">(</span><span class="n">ylim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">2e4</span><span class="p">))</span>   <span class="c1"># adjust y-axis range</span>
</span></span><span class="line"><span class="cl"><span class="c1"># theme_classic(base_size = 20)     # adjust non-data components</span>
</span></span></code></pre></div><p><img src="./figure/ggplot-plus6-1.png" alt="plot of chunk ggplot-plus6"></p>
</section>
<section>
<h2 id="basic-usage-join-layers-with--operator">Basic usage: join layers with <code>+</code> operator</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span>           <span class="c1"># prepare canvas with diamonds data</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">carat</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>       <span class="c1"># map (carat, price) to (x, y) axes</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>                    <span class="c1"># draw scatter plot</span>
</span></span><span class="line"><span class="cl">  <span class="nf">facet_wrap</span><span class="p">(</span><span class="nf">vars</span><span class="p">(</span><span class="n">clarity</span><span class="p">))</span> <span class="o">+</span>       <span class="c1"># split panels according to clarity</span>
</span></span><span class="line"><span class="cl">  <span class="nf">stat_smooth</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="n">lm</span><span class="p">)</span> <span class="o">+</span>        <span class="c1"># add linear regression</span>
</span></span><span class="line"><span class="cl">  <span class="nf">coord_cartesian</span><span class="p">(</span><span class="n">ylim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">2e4</span><span class="p">))</span> <span class="o">+</span> <span class="c1"># adjust y-axis range</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_classic</span><span class="p">(</span><span class="n">base_size</span> <span class="o">=</span> <span class="m">20</span><span class="p">)</span>     <span class="c1"># adjust non-data components</span>
</span></span></code></pre></div><p><img src="./figure/ggplot-plus7-1.png" alt="plot of chunk ggplot-plus7"></p>
</section>
<section>
<h2 id="basic-usage-join-layers-with--operator">Basic usage: join layers with <code>+</code> operator</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span>           <span class="c1"># prepare canvas with diamonds data</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">carat</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>       <span class="c1"># map (carat, price) to (x, y) axes</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>                    <span class="c1"># draw scatter plot</span>
</span></span><span class="line"><span class="cl"><span class="c1"># facet_wrap(vars(clarity)) +       # split panels according to clarity</span>
</span></span><span class="line"><span class="cl"><span class="c1"># stat_smooth(method = lm) +        # add linear regression</span>
</span></span><span class="line"><span class="cl"><span class="c1"># coord_cartesian(ylim = c(0, 2e4)) + # adjust y-axis range</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_classic</span><span class="p">(</span><span class="n">base_size</span> <span class="o">=</span> <span class="m">20</span><span class="p">)</span>     <span class="c1"># adjust non-data components</span>
</span></span></code></pre></div><p><img src="./figure/ggplot-plus8-1.png" alt="plot of chunk ggplot-plus8"></p>
</section>
<section>
<h2 id="intermediate-states-can-be-saved-as-objects">Intermediate states can be saved as objects</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">p1</span> <span class="o">=</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">diamonds</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p2</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">carat</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p3</span> <span class="o">=</span> <span class="n">p2</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">p4</span> <span class="o">=</span> <span class="n">p3</span> <span class="o">+</span> <span class="nf">facet_wrap</span><span class="p">(</span><span class="nf">vars</span><span class="p">(</span><span class="n">clarity</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">p3</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="./figure/ggplot-object-1.png" alt="plot of chunk ggplot-object"></p>
<p>We are going to use this <code>p3</code> later.</p>

</section>
<section>
<h2 id="lets-try-ggplot">Let&rsquo;s try ggplot</h2>
<p>using <code>mpg</code>, a dataset of fuel economy:</p>
<pre tabindex="0"><code>    manufacturer  model displ year cyl      trans drv cty hwy fl   class
  1         audi     a4   1.8 1999   4   auto(l5)   f  18  29  p compact
  2         audi     a4   1.8 1999   4 manual(m5)   f  21  29  p compact
 --                                                                     
233   volkswagen passat   2.8 1999   6 manual(m5)   f  18  26  p midsize
234   volkswagen passat   3.6 2008   6   auto(s6)   f  17  26  p midsize
</code></pre><p>üî∞ Scatter-plot the relationship of <code>displ</code> and <code>cty</code><br>
(engine <strong>displacement</strong> in litres and <strong>city</strong> miles per gallon)</p>
<p><img src="./figure/ggplot-mpg-1.png" alt="plot of chunk ggplot-mpg"></p>

</section>
<section>
<h2 id="common-errors">Common errors</h2>
<p>No function is named <code>ggplot2</code>:</p>
<pre tabindex="0"><code>&gt; ggplot2(diamonds)
Error in ggplot2(diamonds) : could not find function &#34;ggplot2&#34;
</code></pre><p><code>ggplot2</code> is a package, which has a function named <code>ggplot</code>.<br>
OK, but still R cannot find the function:</p>
<pre tabindex="0"><code>&gt; ggplot(diamonds)
Error in ggplot(diamonds) : could not find function &#34;ggplot&#34;
</code></pre><p>Don&rsquo;t forget to load the package every time you launch R/RStudio:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">conflicted</span><span class="p">)</span> <span class="c1"># charm for safe coding</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>  <span class="c1"># load packages including ggplot2</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span>    <span class="c1"># OK!</span>
</span></span></code></pre></div>
</section>
<section>
<h2 id="ggplot-requires-tidy-data"><code>ggplot()</code> requires &ldquo;tidy data&rdquo;</h2>
<ul>
<li>Each column is a variable.</li>
<li>Each row is an observation.</li>
<li>Each cell is a single value.</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>      carat       cut color clarity depth table price    x    y    z
    1  0.23     Ideal     E     SI2  61.5    55   326 3.95 3.98 2.43
    2  0.21   Premium     E     SI1  59.8    61   326 3.89 3.84 2.31
    3  0.23      Good     E     VS1  56.9    65   327 4.05 4.07 2.31
    4  0.29   Premium     I     VS2  62.4    58   334 4.20 4.23 2.63
   --                                                               
53937  0.72      Good     D     SI1  63.1    55  2757 5.69 5.75 3.61
53938  0.70 Very Good     D     SI1  62.8    60  2757 5.66 5.68 3.56
53939  0.86   Premium     H     SI2  61.0    58  2757 6.15 6.12 3.74
53940  0.75     Ideal     D     SI2  62.2    55  2757 5.83 5.87 3.64
</code></pre><cite>
<a class="url" href="https://r4ds.hadley.nz/data-tidy.html">https://r4ds.hadley.nz/data-tidy.html</a>
</cite>

</section>
<section>
<h2 id="map-variables-to-aesthetics">Map variables to aesthetics</h2>
<p>by specifying column names in <code>aes()</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">carat</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">(</span><span class="n">mapping</span> <span class="o">=</span> <span class="nf">aes</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">clarity</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">cut</span><span class="p">))</span>
</span></span></code></pre></div><p><img src="./figure/aes-map-1.png" alt="plot of chunk aes-map"></p>

</section>
<section>
<h2 id="set-constantindependent-aesthetics">Set constant/independent aesthetics</h2>
<p>by specifying values out of <code>aes()</code>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">carat</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#34;darkorange&#34;</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="m">6</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.4</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="./figure/aes-nomap-1.png" alt="plot of chunk aes-nomap"></p>

</section>
<section>
<h2 id="outer-aes-propagates-to-all-geom_">Outer <code>aes()</code> propagates to all <code>geom_*()</code></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">carat</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">clarity</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_line</span><span class="p">()</span>             <span class="c1"># NO color</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">carat</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">price</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">clarity</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">()</span> <span class="o">+</span>          <span class="c1"># color</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_line</span><span class="p">()</span>             <span class="c1"># color</span>
</span></span></code></pre></div><p><img src="./figure/aes-global-local-1.png" alt="plot of chunk aes-global-local"><img src="./figure/aes-global-local-2.png" alt="plot of chunk aes-global-local"></p>
</section>
<section>
<h2 id="aestheticshttpsggplot2tidyverseorgarticlesggplot2-specshtml-list"><a href="https://ggplot2.tidyverse.org/articles/ggplot2-specs.html">aesthetics</a> list</h2>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/aes_colour_fill_alpha.html">Color related</a>
<ul>
<li><code>color</code>: outline color of points, lines, and characters</li>
<li><code>fill</code>: fill color of shapes</li>
<li><a href="https://ggplot2.tidyverse.org/reference/scale_alpha.html"><code>alpha</code></a>: opacity (0 = transparent, 1 = opaque)</li>
</ul>
</li>
<li><a href="https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html">Differentiation related</a>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/scale_size.html"><code>size</code></a>,
<a href="https://ggplot2.tidyverse.org/reference/scale_shape.html"><code>shape</code></a>: of points and shapes</li>
<li><a href="https://ggplot2.tidyverse.org/reference/scale_linewidth.html"><code>linewidth</code></a>,
<a href="https://ggplot2.tidyverse.org/reference/scale_linetype.html"><code>linetype</code></a></li>
</ul>
</li>
<li><a href="https://ggplot2.tidyverse.org/reference/aes_group_order.html">Grouping</a>
<ul>
<li><code>group</code>: to separate lines and polygons</li>
</ul>
</li>
<li><a href="https://ggplot2.tidyverse.org/reference/aes_position.html">Position related</a>
<ul>
<li><strong><code>x</code></strong>, <strong><code>y</code></strong>, <code>xmin</code>, <code>xmax</code>, <code>ymin</code>, <code>ymax</code>, <code>xend</code>, <code>yend</code></li>
</ul>
</li>
</ul>

</section>
<section>
<h2 id="color-for-points-lines-characters-fill-for-areas"><code>color</code> for points, lines, characters; <code>fill</code> for areas</h2>
<p><code>alpha</code> for opacity.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">cut</span><span class="p">,</span> <span class="n">carat</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#34;royalblue&#34;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&#34;gold&#34;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.5</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="m">2</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="./figure/fill-1.png" alt="plot of chunk fill"></p>

</section>
<section>
<h2 id="practice-to-change-colors">Practice to change colors</h2>
<p>using <code>mpg</code>, a dataset of fuel economy:</p>
<pre tabindex="0"><code>    manufacturer  model displ year cyl      trans drv cty hwy fl   class
  1         audi     a4   1.8 1999   4   auto(l5)   f  18  29  p compact
  2         audi     a4   1.8 1999   4 manual(m5)   f  21  29  p compact
 --                                                                     
233   volkswagen passat   2.8 1999   6 manual(m5)   f  18  26  p midsize
234   volkswagen passat   3.6 2008   6   auto(s6)   f  17  26  p midsize
</code></pre><p>üî∞ Draw scatter plot of <code>displ</code> and <code>cty</code> with <strong>blue points</strong>.<br>
üî∞ <strong>Color-code</strong> points according to <code>drv</code> and <code>cyl</code> (drive train and # of cylinders).</p>
<p><img src="./figure/ggplot-mpg-color-1.png" alt="plot of chunk ggplot-mpg-color"></p>

</section>
<section>
<h2 id="diversity-in-color-vision">Diversity in color vision</h2>
<p>The previous graph with 3 colors,
<span style="color: #F8766D;">red</span>
<span style="color: #00BA38;">green</span>
<span style="color: #619CFF;">blue</span>, is no problem for many people.<br>
But for ~5% people, it looks like two-color:
<span style="color: #B6A86A;">red</span>
<span style="color: #AC9C45;">green</span>
<span style="color: #5A96FD;">blue</span> or
<span style="color: #FF6074;">red</span>
<span style="color: #00B5A0;">green</span>
<span style="color: #00B2C1;">blue</span>.</p>
<p><img src="./figure/color-vision-diversity-1.png" alt="plot of chunk color-vision-diversity"><img src="./figure/color-vision-diversity-2.png" alt="plot of chunk color-vision-diversity"><img src="./figure/color-vision-diversity-3.png" alt="plot of chunk color-vision-diversity"></p>
<p>You can simulate color vision with a Mac/iOS app, <a href="https://michelf.ca/projects/sim-daltonism/">Sim Daltonism</a>.<br>
<a href="https://colororacle.org/">Color Oracle</a> is a Windows app.</p>

</section>
<section>
<h2 id="some-palettes-are-designed-with-consideration">Some palettes are designed with consideration</h2>
<p>Sequential palette:<br>
<img src="./figure/palette-sequential-1.png" alt="plot of chunk palette-sequential"><img src="./figure/palette-sequential-2.png" alt="plot of chunk palette-sequential"><img src="./figure/palette-sequential-3.png" alt="plot of chunk palette-sequential"></p>
<p>Diverging palette:<br>
<img src="./figure/palette-diverging-1.png" alt="plot of chunk palette-diverging"><img src="./figure/palette-diverging-2.png" alt="plot of chunk palette-diverging"><img src="./figure/palette-diverging-3.png" alt="plot of chunk palette-diverging"></p>
<p>Qualitative (categorical, discrete) palette:<br>
<img src="./figure/palette-qualitative-1.png" alt="plot of chunk palette-qualitative"><img src="./figure/palette-qualitative-2.png" alt="plot of chunk palette-qualitative"><img src="./figure/palette-qualitative-3.png" alt="plot of chunk palette-qualitative"></p>

</section>
<section>
<h2 id="change-color-palette-with-scale_color_">Change color palette with <code>scale_color_*()</code></h2>
<p><a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html">viridis</a>
and
<a href="https://colorbrewer2.org/#type=diverging&amp;scheme=RdYlBu&amp;n=5">ColorBrewer</a>
are included in ggplot2.<br>
Find names from the link above, and specify it with <code>option =</code> or <code>palette =</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">carat</span><span class="p">,</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">(</span><span class="n">mapping</span> <span class="o">=</span> <span class="nf">aes</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">clarity</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_viridis_d</span><span class="p">(</span><span class="n">option</span> <span class="o">=</span> <span class="s">&#34;inferno&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># scale_color_brewer(palette = &#34;YlGnBu&#34;)</span>
</span></span></code></pre></div><p><img src="./figure/scale-color-1.png" alt="plot of chunk scale-color"><img src="./figure/scale-color-2.png" alt="plot of chunk scale-color"></p>

</section>
<section>
<h2 id="distinguish-continuous-and-discrete-variables">Distinguish continuous and discrete variables</h2>
<p>and choose a <code>scale_*</code> function accordingly, or you will get<br>
<code>Error: Continuous value supplied to discrete scale</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">carat</span><span class="p">,</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">(</span><span class="n">mapping</span> <span class="o">=</span> <span class="nf">aes</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">price</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_viridis_c</span><span class="p">(</span><span class="n">option</span> <span class="o">=</span> <span class="s">&#34;inferno&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># scale_color_distiller(palette = &#34;YlGnBu&#34;)</span>
</span></span></code></pre></div><p><img src="./figure/scale-color-continuous-1.png" alt="plot of chunk scale-color-continuous"><img src="./figure/scale-color-continuous-2.png" alt="plot of chunk scale-color-continuous"></p>
<ul>
<li>discrete: <code>scale_color_viridis_d()</code>, <code>scale_color_brewer()</code></li>
<li>continuous: <code>scale_color_viridis_c()</code>, <code>scale_color_distiller()</code></li>
<li>binned: <code>scale_color_viridis_b()</code>, <code>scale_color_fermenter()</code></li>
</ul>

</section>
<section>
<h2 id="useful-palettes-other-than-viridis-and-brewer">Useful palettes other than viridis and brewer</h2>
<p>Try built-in <code>palette.colors()</code> and
<a href="https://colorspace.r-forge.r-project.org/articles/ggplot2_color_scales.html">colorspace package</a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">okabe_ito</span> <span class="o">=</span> <span class="nf">palette.colors</span><span class="p">(</span><span class="m">9L</span><span class="p">,</span> <span class="s">&#34;Okabe-Ito&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">mpg</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">displ</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">cty</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">drv</span><span class="p">),</span> <span class="n">size</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.66</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_discrete</span><span class="p">(</span><span class="n">type</span> <span class="o">=</span> <span class="nf">unname</span><span class="p">(</span><span class="n">okabe_ito</span><span class="p">)</span><span class="n">[</span><span class="m">-1</span><span class="n">]</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># scale_color_discrete(type = palette.colors(8L, &#34;R4&#34;)[-1])</span>
</span></span><span class="line"><span class="cl"><span class="c1"># colorspace::scale_colour_discrete_divergingx(&#34;Zissou 1&#34;)</span>
</span></span></code></pre></div><p><img src="./figure/other-palettes-1.png" alt="plot of chunk other-palettes"><img src="./figure/other-palettes-2.png" alt="plot of chunk other-palettes"><img src="./figure/other-palettes-3.png" alt="plot of chunk other-palettes"></p>
<p>These palettes are carefully designed.</p>

</section>
<section>
<h2 id="global-options-to-omit-scale_color_">Global options to omit <code>scale_color_*</code></h2>
<p>An example setting to use viridis and Okabe-ito by default:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">grDevices</span><span class="o">::</span><span class="nf">palette</span><span class="p">(</span><span class="s">&#34;Okabe-Ito&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">options</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">ggplot2.continuous.colour</span> <span class="o">=</span> <span class="s">&#34;viridis&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">ggplot2.continuous.fill</span> <span class="o">=</span> <span class="s">&#34;viridis&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">ggplot2.discrete.colour</span> <span class="o">=</span> <span class="n">grDevices</span><span class="o">::</span><span class="nf">palette</span><span class="p">()</span><span class="n">[</span><span class="m">-1</span><span class="n">]</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="n">ggplot2.discrete.fill</span> <span class="o">=</span> <span class="n">grDevices</span><span class="o">::</span><span class="nf">palette</span><span class="p">()</span><span class="n">[</span><span class="m">-1</span><span class="n">]</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><p>Settings by <code>options()</code> are effective until an R session ends.</p>

</section>
<section>
<h2 id="facet-splitting-a-plot-into-a-sequence-of-panels">Facet: splitting a plot into a sequence of panels</h2>
<p>One of the biggest benefits of using ggplot!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">p3</span> <span class="o">+</span> <span class="nf">facet_wrap</span><span class="p">(</span><span class="nf">vars</span><span class="p">(</span><span class="n">clarity</span><span class="p">),</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">4L</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="./figure/facet-wrap-1.png" alt="plot of chunk facet-wrap"></p>

</section>
<section>
<h2 id="facet-splitting-a-plot-into-a-2d-grid-of-panels">Facet: splitting a plot into a 2d grid of panels</h2>
<p>One of the biggest benefits of using ggplot!</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">p3</span> <span class="o">+</span> <span class="nf">facet_grid</span><span class="p">(</span><span class="nf">vars</span><span class="p">(</span><span class="n">clarity</span><span class="p">),</span> <span class="nf">vars</span><span class="p">(</span><span class="n">cut</span><span class="p">))</span>
</span></span></code></pre></div><p><img src="./figure/facet-grid-1.png" alt="plot of chunk facet-grid"></p>

</section>
<section>
<h2 id="overviewing-multivariate-data-with-aes--facet">Overviewing multivariate data with &ldquo;aes&rdquo; + &ldquo;facet&rdquo;</h2>
<p><img src="./figure/facet-diamonds-1.png" alt="plot of chunk facet-diamonds"></p>
</section>
<section>
<h2 id="practice-of-faceting">Practice of faceting</h2>
<p>using <code>mpg</code>, a dataset of fuel economy:</p>
<pre tabindex="0"><code>    manufacturer  model displ year cyl      trans drv cty hwy fl   class
  1         audi     a4   1.8 1999   4   auto(l5)   f  18  29  p compact
  2         audi     a4   1.8 1999   4 manual(m5)   f  21  29  p compact
 --                                                                     
233   volkswagen passat   2.8 1999   6 manual(m5)   f  18  26  p midsize
234   volkswagen passat   3.6 2008   6   auto(s6)   f  17  26  p midsize
</code></pre><p>üî∞ Try faceting by <code>drv</code>, <code>cyl</code>, and both.</p>
<p><img src="./figure/ggplot-mpg-facet-1.png" alt="plot of chunk ggplot-mpg-facet"></p>

</section>
<section>
<h2 id="modify-coordinate-axes-with-scale_httpsggplot2tidyverseorgreferencesection-scales-coord_httpsggplot2tidyverseorgreferencesection-coordinate-systems">Modify coordinate axes with <a href="https://ggplot2.tidyverse.org/reference/#section-scales"><code>scale_*</code></a>, <a href="https://ggplot2.tidyverse.org/reference/#section-coordinate-systems"><code>coord_*</code></a></h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">carat</span><span class="p">,</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="m">0.25</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_x_log10</span><span class="p">()</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_y_log10</span><span class="p">(</span><span class="n">breaks</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span> <span class="o">*</span> <span class="m">1000</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">coord_cartesian</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.1</span><span class="p">,</span> <span class="m">10</span><span class="p">),</span> <span class="n">ylim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">800</span><span class="p">,</span> <span class="m">12000</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">labs</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Diamonds&#34;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Size (carat)&#34;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&#34;Price (USD)&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="./figure/scale-axis-1.png" alt="plot of chunk scale-axis"></p>
</section>
<section>
<h2 id="customize-non-data-components-with-theme">Customize non-data components with <code>theme</code></h2>
<p>Choose <a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">a complete <code>theme_*()</code></a>,
and adjust each element with <a href="https://ggplot2.tidyverse.org/reference/theme.html"><code>theme()</code></a>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">p3</span> <span class="o">+</span> <span class="nf">theme_bw</span><span class="p">(</span><span class="n">base_size</span> <span class="o">=</span> <span class="m">18</span><span class="p">)</span> <span class="o">+</span> <span class="nf">theme</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">panel.background</span> <span class="o">=</span> <span class="nf">element_rect</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="s">&#34;khaki&#34;</span><span class="p">),</span>      <span class="c1"># box</span>
</span></span><span class="line"><span class="cl">  <span class="n">panel.grid</span>       <span class="o">=</span> <span class="nf">element_line</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s">&#34;royalblue&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">axis.title.x</span>     <span class="o">=</span> <span class="nf">element_text</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="m">32</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="n">axis.text.y</span>      <span class="o">=</span> <span class="nf">element_blank</span><span class="p">()</span>                    <span class="c1"># remove</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span></code></pre></div><p><img src="./figure/theme-1.png" alt="plot of chunk theme"></p>

</section>
<section>
<h2 id="basic-usage-join-layers-with--operator">Basic usage: join layers with <code>+</code> operator</h2>
<img src="/slides/image/rstats/ggplot-layers.png" height="930">
</section>
<section>
<h2 id="combine-separate-plots-into-one-as-in-papers">Combine separate plots into one as in papers</h2>
<p>with the help of another package such as
<a href="https://wilkelab.org/cowplot/">cowplot</a>
and
<a href="https://patchwork.data-imaginist.com/">patchwork</a>:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">pAB</span> <span class="o">=</span> <span class="n">cowplot</span><span class="o">::</span><span class="nf">plot_grid</span><span class="p">(</span><span class="n">p3</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;A&#34;</span><span class="p">,</span> <span class="s">&#34;B&#34;</span><span class="p">),</span> <span class="n">nrow</span> <span class="o">=</span> <span class="m">1L</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">cowplot</span><span class="o">::</span><span class="nf">plot_grid</span><span class="p">(</span><span class="n">pAB</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;&#34;</span><span class="p">,</span> <span class="s">&#34;C&#34;</span><span class="p">),</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">1L</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="./figure/cowplot-1.png" alt="plot of chunk cowplot"></p>

</section>
<section>
<h2 id="save-plots-in-a-reproducible-way">Save plots in a reproducible way</h2>
<p>RStudio&rsquo;s &ldquo;Export&rdquo; button is affected by the window size.<br>
Adjust and fix the size with <code>ggsave()</code>.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># 7 inch x 300 dpi = 2100 px square (default)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="s">&#34;dia1.png&#34;</span><span class="p">,</span> <span class="n">p3</span><span class="p">)</span> <span class="c1"># width = 7, height = 7, dpi = 300</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 4      x 300     = 1200  (Zoom in x7/4)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="s">&#34;dia2.png&#34;</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">4</span><span class="p">)</span> <span class="c1"># dpi = 300</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2      x 600     = 1200  (Zoom in x7/2)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="s">&#34;dia3.png&#34;</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">2</span><span class="p">,</span> <span class="n">dpi</span> <span class="o">=</span> <span class="m">600</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 4      x 300     = 1200  (Magnify characters in theme components)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="s">&#34;dia4.png&#34;</span><span class="p">,</span> <span class="n">p3</span> <span class="o">+</span> <span class="nf">theme_bw</span><span class="p">(</span><span class="n">base_size</span> <span class="o">=</span> <span class="m">22</span><span class="p">),</span> <span class="n">width</span> <span class="o">=</span> <span class="m">4</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">4</span><span class="p">)</span>
</span></span></code></pre></div><figure>
<img src="../sendair2/image/dia1.png" width="24%">
<img src="../sendair2/image/dia2.png" width="24%">
<img src="../sendair2/image/dia3.png" width="24%">
<img src="../sendair2/image/dia4.png" width="24%">
</figure>
</section>
<section>
<h2 id="show-multi-byte-characters-properly-not-tofu-">Show multi-byte characters properly, not tofu ‚óª‚óª</h2>
<p>Preferences ‚Üí General ‚Üí Graphics ‚Üí Backend: <a href="https://ragg.r-lib.org/"><strong>AGG</strong></a></p>
<figure>
<img src="/slides/image/rstudio/options-graphics-agg.png" width="80%">
</figure>
<p>(Using non-ASCII characters should be avoided in the first place&hellip;)</p>

</section>
<section>
<h2 id="what-kind-of-geom_-are-available">What kind of <code>geom_*()</code> are available?</h2>
<p>See <a href="https://ggplot2.tidyverse.org/reference/index.html">the official document</a>.</p>
<figure>
<img src="/slides/image/rstats/ggplot2-reference-geoms.png" width="80%">
</figure>
</section>
<section>
<figure style="margin: 0;">
<a href="https://ggplot2.tidyverse.org/">
<img src="/slides/image/cheatsheet/data-visualization.png" width="100%">
<figcaption class="url">https://ggplot2.tidyverse.org/</figcaption>
</a>
</figure>
</section>
<section>
<h2 id="final-code-can-be-overwhelmingly-long">Final code can be overwhelmingly long&hellip;</h2>
<p>Yes. But you can validate and reuse it later.</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="nf">ggplot</span><span class="p">(</span><span class="n">diamonds</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">cut</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">price</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_jitter</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">cut</span><span class="p">),</span> <span class="n">height</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="m">0.2</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="m">0.1</span><span class="p">,</span> <span class="n">stroke</span> <span class="o">=</span> <span class="m">0</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_boxplot</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="kc">NA</span><span class="p">,</span> <span class="n">outlier.shape</span> <span class="o">=</span> <span class="kc">NA</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">scale_color_viridis_d</span><span class="p">(</span><span class="n">option</span> <span class="o">=</span> <span class="s">&#34;plasma&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">facet_wrap</span><span class="p">(</span><span class="nf">vars</span><span class="p">(</span><span class="n">clarity</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">coord_flip</span><span class="p">(</span><span class="n">xlim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0.5</span><span class="p">,</span> <span class="m">5.5</span><span class="p">),</span> <span class="n">ylim</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">20000</span><span class="p">),</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">FALSE</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">labs</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s">&#34;Diamonds&#34;</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="s">&#34;Cut&#34;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&#34;Price (USD)&#34;</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_bw</span><span class="p">(</span><span class="n">base_size</span> <span class="o">=</span> <span class="m">20</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme</span><span class="p">(</span><span class="n">legend.position</span> <span class="o">=</span> <span class="s">&#34;none&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="n">axis.ticks</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel.grid.major.y</span> <span class="o">=</span> <span class="nf">element_blank</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">        <span class="n">panel.spacing.x</span> <span class="o">=</span> <span class="n">grid</span><span class="o">::</span><span class="nf">unit</span><span class="p">(</span><span class="m">3</span><span class="p">,</span> <span class="s">&#34;lines&#34;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">        <span class="n">plot.margin</span> <span class="o">=</span> <span class="n">grid</span><span class="o">::</span><span class="nf">unit</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">0.5</span><span class="p">,</span> <span class="m">0.5</span><span class="p">),</span> <span class="s">&#34;lines&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggsave</span><span class="p">(</span><span class="s">&#34;diamonds-cut-price.png&#34;</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="m">12</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="m">9</span><span class="p">)</span>
</span></span></code></pre></div>
</section>
<section>
<h2 id="advanced-usage">Advanced usage</h2>
<dl>
<dt><a href="https://exts.ggplot2.tidyverse.org/">ggplot2 extensions</a></dt>
<dd><a href="https://gganimate.com/">gganimate</a>: Animation</dd>
<dd><a href="https://ggrepel.slowkow.com/">ggrepel</a>: Repel overlapping text labels away</dd>
<dd><a href="https://ggraph.data-imaginist.com/">ggraph</a>: Networks</dd>
<dd><a href="https://github.com/YuLab-SMU/ggtree">ggtree</a>: Phylogenetic trees</dd>
<dd><a href="https://github.com/kassambara/ggpubr">ggpubr</a>: Academic publication</dd>
</dl>
<img src="/slides/image/tumopp/driver.gif" align="right" height="320">
<dl>
<dt>ggplot2 does not support 3D plotting.</dt>
<dd>Really need 3D? Aes and facet will do in most cases.</dd>
<dd>Try other packages:
<a href="https://cran.r-project.org/web/packages/rgl/vignettes/rgl.html">rgl</a>,
<a href="https://plotly.com/r/3d-charts/">plotly</a>,
<a href="https://www.rayshader.com">rayshader</a>, etc.</dd>
</dl>

</section>
<section>
<h2 id="-todays-challenge-1-reproduction">üî∞ Today&rsquo;s challenge 1: reproduction</h2>
<p>Draw the same figures as follows:</p>
<p><img src="./figure/ggplot-homework-1.png" alt="plot of chunk ggplot-homework"></p>
<p>Take a close look at the details üëÄ</p>

</section>
<section>
<h2 id="todays-lesson-data-visualization-and-reporting-with-r">Today&rsquo;s lesson: data visualization and reporting with R</h2>
<h3 id="-deloutline-of-data-analysis-visualization-is-importantdel">‚úÖ <del>Outline of data analysis: visualization is important</del></h3>
<h3 id="-draw-graphs-in-a-consistent-manner-with-ggplot2">‚úÖ Draw graphs in a consistent manner with ggplot2</h3>
<a href="https://ggplot2.tidyverse.org/">
<img src="/_img/hex-stickers/ggplot2.webp" width="180" align="right">
</a>
<ul>
<li>Aesthetic mapping and faceting play key roles</li>
<li>Diversity in color vision</li>
<li>Save images in a reproducible way</li>
</ul>
<h3 id="-embed-r-code-and-results-into-a-report-with-quarto">‚¨ú Embed R code and results into a report with Quarto</h3>

</section>
<section>
<h2 id="if-you-want-to-see-the-results-of-an-r-script">If you want to see the results of an R script</h2>
<p>Execute lines in the script again ‚Äî <strong>cumbersome</strong></p>
<p>See the image files written by <code>ggsave()</code> ‚Äî <strong>which is from which code?</strong></p>
<p>‚Üí Any format to take a glace at code and its result at the same time?</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="m">3</span> <span class="o">*</span> <span class="m">14</span>
</span></span><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">mpg</span><span class="p">)</span> <span class="o">+</span> <span class="nf">aes</span><span class="p">(</span><span class="n">displ</span><span class="p">,</span> <span class="n">hwy</span><span class="p">)</span> <span class="o">+</span> <span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="n">drv</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 42
</code></pre><p><img src="./figure/hello-1.png" alt="plot of chunk hello"></p>

</section>
<section>
<h2 id="quarto-document">Quarto Document</h2>
<a href="https://quarto.org/">
<img src="/_img/hex-stickers/quarto.webp" width="160" align="right">
</a>
<p>You can unify management of programming and reporting.</p>
<ul>
<li>Create a text file (.qmd) with body text and R code.</li>
<li>Translate it to a rich format such as HTML and PDF
<ul>
<li><strong>Figures</strong> and <strong>tables</strong> can be embedded as well as R code.</li>
</ul>
</li>
</ul>
<hr>
<a href="https://rmarkdown.rstudio.com/">
<img src="/_img/hex-stickers/rmarkdown.webp" width="160" align="right">
</a>
<dl>
<dt>Quarto Markdown (<code>.qmd</code>)</dt>
<dd>A subspecies of <strong>Markdown</strong>; <code>.Rmd</code> is almost the same.</dd>
<dd>Can execute R code and embed the results.</dd>
<dt>Markdown (<code>.md</code>)</dt>
<dd>The most popular <strong>lightweight markup language</strong>.</dd>
<dd>There are some different flavors. Quarto uses Pandoc Markdown.</dd>
</dl>
<p>(See <a href="https://quarto.org/docs/gallery/">the gallery</a> for examples.)</p>

</section>
<section>
<h2 id="markup-languages">Markup languages</h2>
<p>Set of rules to express document structures and layouts.<br>
e.g., <strong>HTML</strong>+CSS, XML, LaTeX</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">h3</span><span class="p">&gt;</span>Heading level 3<span class="p">&lt;/</span><span class="nt">h3</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>This is a paragraph.
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">em</span><span class="p">&gt;</span>emphasis (italic)<span class="p">&lt;/</span><span class="nt">em</span><span class="p">&gt;</span>,
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>strong (bold)<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span>,
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://www.lifesci.tohoku.ac.jp/&#34;</span><span class="p">&gt;</span>link<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>, etc.
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span></code></pre></div><div style="border: solid 1px #888888; padding: 0 4px;">
<h3>Heading level 3</h3>
<p>This is a paragraph.
<em>emphasis (italic)</em>,
<strong>strong (bold)</strong>,
<a href="https://www.lifesci.tohoku.ac.jp/">link</a>, etc.
</p>
</div>
<p>Expressive and powerful, but too complex for humans to read/write.</p>
<p>(Try viewing the source code of your favorite websites.)</p>

</section>
<section>
<h2 id="lightweight-markup-languages">Lightweight markup languages</h2>
<p><strong>Markup languages</strong> that are easy for humans to read and write.<br>
e.g., <strong>Markdown</strong>, reStructuredText, various wiki notations</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-md" data-lang="md"><span class="line"><span class="cl"><span class="gu">### Heading level 3
</span></span></span><span class="line"><span class="cl"><span class="gu"></span>
</span></span><span class="line"><span class="cl">This is a paragraph.
</span></span><span class="line"><span class="cl"><span class="ge">*emphasis (italic)*</span>,
</span></span><span class="line"><span class="cl"><span class="gs">**strong (bold)**</span>,
</span></span><span class="line"><span class="cl">[<span class="nt">link</span>](<span class="na">https://www.lifesci.tohoku.ac.jp/</span>), etc.
</span></span></code></pre></div><div style="border: solid 1px #888888; padding: 0 4px;">
<h3>Heading level 3</h3>
<p>This is a paragraph.
<em>emphasis (italic)</em>,
<strong>strong (bold)</strong>,
<a href="https://www.lifesci.tohoku.ac.jp/">link</a>, etc.
</p>
</div>

</section>
<section>
<h2 id="you-already-have-quarto-environment">You already have Quarto environment</h2>
<ul>
<li><strong>R (‚â• 4.3.2)</strong>: &ldquo;Latest ‚Äì 0.1&rdquo; is acceptable.</li>
<li><strong>RStudio (‚â• 2023.09.1+494)</strong>: including Quarto CLI</li>
<li><strong>tidyverse (‚â• 2.0.0)</strong>: installs the following two:
<ul>
<li>rmarkdown (‚â• 2.25)</li>
<li>knitr (‚â• 1.45)</li>
</ul>
</li>
</ul>
<p>(The versions shown above are not requirement, but my current values.)</p>
<hr>
<ul>
<li><a href="https://quarto.org/docs/get-started/">Quarto CLI</a>:
if you really want the bleeding edge version.</li>
<li><a href="https://github.com/quarto-dev/quarto-r"><code>install.packages(&quot;quarto&quot;)</code></a>:
unnecessary for most people;
just provides R functions to call Quarto CLI.</li>
<li><a href="https://pandoc.org/">pandoc</a>: installed along with Quarto CLI.
not sure if the manually installed version is used by RStudio+Quarto.</li>
</ul>
</section>
<section>
<h2 id="try-writing-and-translating-markdown">Try writing and translating Markdown</h2>
<ol>
<li>RStudio &gt; New File &gt; Markdown File
<img src="/slides/image/rstudio/new-markdown.png" width="60%"></li>
<li><a href="https://duckduckgo.com/?q=markdown+syntax">Search &ldquo;markdown syntax&rdquo;</a> and write something.
Include the following elements at least:
<ul>
<li>Heading level 1, 2, 3</li>
<li>Code blocks, inline code</li>
<li>Bullet lists (with and without item number)</li>
</ul>
</li>
<li>Push <kbd>Preview</kbd> button and check the result.</li>
</ol>

</section>
<section>
<h2 id="try-writing-a-quarto-document">Try writing a Quarto Document</h2>
<p>RStudio &gt; New File &gt; Quarto Document&hellip;<br>
Select &ldquo;Document&rdquo; and &ldquo;HTML&rdquo;; fill &ldquo;Title&rdquo; and &ldquo;Author&rdquo;; create.</p>
<img src="/slides/image/rstudio/new-quarto-document.png" width="100%">
</section>
<section>
<h2 id="new-features-in-qmd-not-in-md">New features in qmd, not in md</h2>
<dl>
<dt>Header (front matter)</dt>
<dd>Surrounded by <code>---</code> at the top.
Metadata of a whole document.</dd>
<dd>Options differ depending on output formats.
e.g., <a href="https://quarto.org/docs/output-formats/html-basics.html"><code>html</code></a></dd>
<dt>R code chunks</dt>
<dd>Code blocks that start like <code>```{r}</code>.</dd>
<dd>The result of the code is also embedded into the product.</dd>
<dd><a href="https://quarto.org/docs/computations/execution-options.html">Many options</a>„ÄÇe.g.,
<ul>
<li><code>echo: false</code>: Hide code, but execute and show its results.</li>
<li><code>eval: false</code>: Show code without execution.</li>
<li><code>include: false</code>: Execute code, but hide it and its results.</li>
<li><code>fig.width: 7</code>, <code>fig.height: 7</code>: Adjust image size.</li>
</ul>
</dd>
</dl>
<p>Don&rsquo;t care about the details for now.</p>
</section>
<section>
<h2 id="try-translating-qmd-to-html">Try translating qmd to HTML</h2>
<p>qmd on the left is a source code. HTML on the right is its product.</p>
<div>
<img src="/slides/image/rstudio/quarto-viewer.png" width="100%">
</div>
</section>
<section>
<h2 id="try-translating-qmd-to-html">Try translating qmd to HTML</h2>
<ol>
<li>Save a source code with <kbd>command</kbd><kbd>s</kbd><br>
e.g., <code>report.qmd</code></li>
<li>Push <kbd>‚öôÔ∏è</kbd> button, and select &ldquo;Preview in Viewer Pane&rdquo;</li>
<li>Push <kbd>‚ÜíRender</kbd> button.
<ul>
<li>Embedded R code is executed.</li>
<li>Markdown with the results is generated.</li>
<li>Markdown is translated to HTML, e.g., <code>report.html</code></li>
<li>Preview is shown on the right automatically.</li>
</ul>
</li>
<li>Repeat editing ‚Üí saving ‚Üí &ldquo;Render&rdquo; to make a satisfactory report.</li>
</ol>

</section>
<section>
<h2 id="an-example-of-reports">An example of reports</h2>
<p>Create qmd on the left; push &ldquo;Render&rdquo; and submit HTML on the right.</p>
<div>
<img src="../tohoku2023r/image/report-example.webp" width="90%"></img>
</div>
</section>
<section>
<h2 id="ÂèÇËÄÉ">ÂèÇËÄÉ</h2>
<dl>
<dt>R for Data Science &mdash; Hadley Wickham et al.</dt>
<dd><a href="https://r4ds.hadley.nz">https://r4ds.hadley.nz</a></dd>
<dd><a href="https://amzn.to/2tbRmVc">Book</a></dd>
<dd><a href="https://amzn.to/2yyFRKt">Êó•Êú¨Ë™ûÁâàÊõ∏Á±ç(R„Åß„ÅØ„Åò„ÇÅ„Çã„Éá„Éº„Çø„Çµ„Ç§„Ç®„É≥„Çπ)</a></dd>
<dt>Older versions</dt>
<dd>„Äå<a href="https://heavywatal.github.io/slides/nagoya2018/">R„Å´„ÇÑ„Çâ„Åõ„Å¶Ê•Ω„Åó„Çà„ÅÜ ‚Äî „Éá„Éº„Çø„ÅÆÂèØË¶ñÂåñ„Å®‰∏ã„Åî„Åó„Çâ„Åà</a>„Äç
Â≤©ÂµúËà™ 2018</dd>
<dd>„ÄåR„ÇíÁî®„ÅÑ„Åü„Éá„Éº„ÇøËß£Êûê„ÅÆÂü∫Á§é„Å®ÂøúÁî®„ÄçÁü≥Â∑ùÁî±Â∏å 2019 ÂêçÂè§Â±ãÂ§ßÂ≠¶</dd>
<dd>„Äå<a href="https://heavywatal.github.io/slides/tmd2022/">R„Å´„Çà„Çã„Éá„Éº„ÇøÂâçÂá¶ÁêÜÂÆüÁøí</a>„Äç
Â≤©ÂµúËà™ 2022 Êù±‰∫¨ÂåªÁßëÊ≠ØÁßëÂ§ß</dd>
<dd>„Äå<a href="https://comicalcommet.github.io/r-training-2023/">R„ÇíÁî®„ÅÑ„Åü„Éá„Éº„ÇøËß£Êûê„ÅÆÂü∫Á§é„Å®ÂøúÁî®</a>„Äç
Áü≥Â∑ùÁî±Â∏å 2023 ÂêçÂè§Â±ãÂ§ßÂ≠¶</dd>
<dt>ggplot2 official document</dt>
<dd><a href="https://ggplot2.tidyverse.org/">https://ggplot2.tidyverse.org/</a></dd>
</dl>
<a href="3-structure1.html" class="readmore">
3. Data transformation 1: extract, summarize
</a>

</section>
</div>
</div>
</body>
</html>
