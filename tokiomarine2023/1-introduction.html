<!DOCTYPE html>
<html lang="ja">
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<title>1. 導入 — 統計モデリング概論 DSHC 2023</title>
<meta name="author" content="Watal M. Iwasaki">
<meta property="og:title" content="1. 導入 — 統計モデリング概論 DSHC 2023">
<meta property="og:type" content="article">
<meta property="og:url" content="https://heavywatal.github.io/slides/tokiomarine2023/1-introduction.html">
<meta property="og:image" content="https://avatars.githubusercontent.com/heavywatal">
<meta property="og:description" content="">
<meta property="og:site_name" content="Slide decks — Heavy Watal">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@heavywatal">
<meta name="twitter:creator" content="@heavywatal">
<link rel="stylesheet" href="/slides/lib/katex/katex.min.css">
<script defer src="/slides/lib/katex/katex.min.js"></script>
<script defer src="/slides/lib/katex/contrib/auto-render.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  renderMathInElement(document.body, {
    delimiters: [
      {left: "\\[", right: "\\]", display: true},
      {left: "$", right: "$", display: false}
    ]
  });
});
</script>
<style>
.katex {
  font-size: 1.06em;
}

.katex-display > .katex {
  text-align: left;
  padding-left: 2rem;
}
</style>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-V60H2JH0G6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-V60H2JH0G6');
</script>
<link rel="stylesheet" href="/slides/lib/reveal.js/reveal.css">
<script defer src="/slides/lib/reveal.js/reveal.js"></script>
<script defer src="/slides/lib/reveal.js/plugin/notes/notes.js"></script>
<script defer src="/slides/lib/reveal.js/plugin/search/search.js"></script>
<script defer src="/slides/lib/reveal-initialize.js"></script>
<script>
window.addEventListener('DOMContentLoaded', function() {
  Reveal.configure({width: 1333, height: 1000});
  document.querySelector('html').style.fontSize = '222%';
})
</script>
<script defer src="/slides/lib/reload-img-onclick.js"></script>
<link rel="stylesheet" href="/slides/css/style-reveal.css">
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="reveal">
<div class="slides">
<section>
<h1 id="統計モデリング概論-dshc-2023"><a href=".">統計モデリング概論 DSHC 2023</a></h1>
<div class="author">
岩嵜 航 (Watal M. Iwasaki, PhD)
</div>
<div class="affiliation">
東北大学 生命科学研究科 進化ゲノミクス分野 特任助教<br>
(Graduate School of Life Sciences, Tohoku University)
</div>
<ol>
<li class="current-deck"><a href="1-introduction.html">導入</a>
<li><a href="2-distribution.html">直線回帰、確率分布、擬似乱数生成</a>
<li><a href="3-likelihood.html">尤度、最尤推定</a>
<li><a href="4-glm.html">一般化線形モデル(GLM)</a>
<li><a href="5-glmm.html">個体差、一般化線形混合モデル(GLMM)</a>
<li><a href="6-bayesian.html">ベイズの定理、事後分布、MCMC</a>
<li><a href="7-stan.html">StanでGLM</a>
<li><a href="8-hbm.html">階層ベイズモデル(HBM)</a>
</ol>
<div class="footnote">
2023-08-23 東京海上 Data Science Hill Climb<br>
<a href="https://heavywatal.github.io/slides/tokiomarine2023/">https://heavywatal.github.io/slides/tokiomarine2023/</a>
</div>

</section>
<section>
<h2 id="データを使ってやりたいこと">データを使ってやりたいこと</h2>
<ul>
<li>現象を<strong>理解</strong>したい</li>
<li>将来を<strong>予測</strong>したい</li>
<li>ものを<strong>分類・判別</strong>したい</li>
<li>挙動を<strong>制御</strong>したい</li>
<li>新しい何かを<strong>生成</strong>したい</li>
</ul>
<p>そのために解析は必要？
未加工の生データこそ宝？</p>
</section>
<section>
<h2 id="データ解析って必要-生データ見ればいいべ">データ解析って必要？ 生データ見ればいいべ？</h2>
<p>往々にして複雑過ぎ、情報多すぎ、そのままでは手に負えない</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">ggplot2</span><span class="o">::</span><span class="n">diamonds</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>      carat       cut color clarity depth table price    x    y    z
    1  0.23     Ideal     E     SI2  61.5    55   326 3.95 3.98 2.43
    2  0.21   Premium     E     SI1  59.8    61   326 3.89 3.84 2.31
    3  0.23      Good     E     VS1  56.9    65   327 4.05 4.07 2.31
    4  0.29   Premium     I     VS2  62.4    58   334 4.20 4.23 2.63
   --                                                               
53937  0.72      Good     D     SI1  63.1    55  2757 5.69 5.75 3.61
53938  0.70 Very Good     D     SI1  62.8    60  2757 5.66 5.68 3.56
53939  0.86   Premium     H     SI2  61.0    58  2757 6.15 6.12 3.74
53940  0.75     Ideal     D     SI2  62.2    55  2757 5.83 5.87 3.64
</code></pre><p>ダイヤモンド53,940個について10項目の値を持つデータセット</p>

</section>
<section>
<h2 id="要約統計量を見てみよう">要約統計量を見てみよう</h2>
<p>各列の<strong>平均</strong>とか<strong>標準偏差</strong>とか:</p>
<pre tabindex="0"><code>  stat carat depth table    price
1 mean  0.80 61.75 57.46  3932.80
2   sd  0.47  1.43  2.23  3989.44
3  max  5.01 79.00 95.00 18823.00
4  min  0.20 43.00 43.00   326.00
</code></pre><p>大きさ <code>carat</code> と価格 <code>price</code> の<strong>相関係数</strong>はかなり高い:</p>
<pre tabindex="0"><code>      carat depth table price
carat  1.00                  
depth  0.03  1.00            
table  0.18 -0.30  1.00      
price  0.92 -0.01  0.13  1.00
</code></pre><hr>
<p><strong>生のままよりは把握しやすい</strong>かも。</p>
<p>しかし要注意&hellip;</p>

</section>
<section>
<h2 id="要約統計量だけ見て可視化を怠ると構造を見逃す">要約統計量だけ見て可視化を怠ると構造を見逃す</h2>
<figure style="position: relative;">
<a href="https://www.autodesk.com/research/publications/same-stats-different-graphs">
<img src="/slides/image/rstats/datasaurus.png" width="95%">
<figcaption class="url">https://www.autodesk.com/research/publications/same-stats-different-graphs</figcaption>
</a>
<img src="/slides/image/rstats/DataDino-600x455.gif" width="22%"
     style="position: absolute; left: 0; top: 0; z-index: 255;">
</figure>

</section>
<section>
<h2 id="データ可視化は理解の第一歩">データ可視化は理解の第一歩</h2>
<p>情報をうまく絞って整理 → <strong>直感的にわかる</strong></p>
<p><img src="./figure/simplify-diamonds-1.png" alt="plot of chunk simplify-diamonds"></p>
<p><code>carat</code> が大きいほど <code>price</code> も高いらしい。<br>
その度合いは <code>clarity</code> によって異なるらしい。</p>

</section>
<section>
<h2 id="統計とは">統計とは</h2>
<p>データをうまくまとめ、それに基づいて推論するための手法。</p>
<ul>
<li><strong>記述統計</strong>: データそのものを要約する
<ul>
<li>要約統計量 (e.g., 平均、標準偏差、etc.)</li>
<li>作図、作表</li>
</ul>
</li>
<li><strong>推測統計</strong>: データの背後にある母集団・生成過程を考える
<ul>
<li>数理モデル</li>
<li>確率分布</li>
<li>パラメータ(母数)</li>
</ul>
</li>
</ul>
<p>「グラフを眺めてなんとなく分かる」以上の分析には<strong>モデル</strong>が必要</p>

</section>
<section>
<h2 id="モデルとは">モデルとは</h2>
<p>対象システムを単純化・理想化して扱いやすくしたもの</p>
<dl>
<dt>Mathematical Model 数理モデル<img src="../tokiomarine2021/image/hill-equation.png" width="210" align="right" style="margin: 0 -5px;"></dt>
<dd>数学的な方程式として記述されるもの。</dd>
<dd>e.g., Lotka-Volterra eq., <span style="color: #888;">Hill eq.</span></dd>
<dd><br>
</dd>
<dt>Computational Model 数値計算モデル<img src="/slides/image/tumopp/Chex_Lconst.gif" width="210" align="right"></dt>
<dd>数値計算の手続きとして記述されるもの。</dd>
<dd>e.g., Schelling’s Segregation Model, <span style="color: #888;"><em>tumopp</em></span></dd>
<dd><br>
</dd>
<dt>Concrete Model 具象モデル<img src="../tokiomarine2021/image/weisberg-sfbay.jpg" width="330" align="right"></dt>
<dd>具体的な事物で作られるもの。</dd>
<dd>e.g., San Francisco Bay-Delta Model</dd>
</dl>
<cite>
Weisberg 2012 "Simulation and Similarity" (科学とモデル)
</cite>
</section>
<section>
<h2 id="データ科学における数理モデル">データ科学における数理モデル</h2>
<p>データ生成をうまく真似できそうな仮定の数式表現。<br>
 </p>
<figure>
<img src="../tokiomarine2021/math-model.drawio.svg" width="1100"><br>
<figcaption><cite>「データ分析のための数理モデル入門」江崎貴裕 2020 より改変</cite></figcaption>
</figure>
</section>
<section>
<h2 id="データ科学における数理モデル">データ科学における数理モデル</h2>
<p>データ生成をうまく真似できそうな仮定の数式表現。<br>
e.g., 大きいほど高く売れる: $\text{price} = A \times \text{carat} + B + \epsilon$</p>
<p><img src="./figure/lm-diamonds-1.png" alt="plot of chunk lm-diamonds"></p>
<p>新しく採れたダイヤモンドの価格予想とかにも使える。</p>
<p>このように「YをXの関数として表す」ようなモデルを<strong>回帰</strong>と呼ぶ。</p>

</section>
<section>
<h2 id="本講義の主題-回帰">本講義の主題: 回帰</h2>
<p>単純な直線あてはめから出発し、ちょっとずつ統計モデリング。</p>
<figure>
<a href="https://kuboweb.github.io/-kubo/ce/LinksGlm.html">
<img src="../tokiomarine2021/image/kubo-p2.png" width="1100">
<figcaption class="url">久保さん https://kuboweb.github.io/-kubo/ce/LinksGlm.html</figcaption>
</a>
</figure>
</section>
<section>
<h2 id="何でもかんでも直線あてはめではよろしくない">何でもかんでも直線あてはめではよろしくない</h2>
<img src="figure/glm-better-1.png" alt="plot of chunk glm-better">
<ul>
<li>観察データは常に<strong>正の値</strong>なのに予測が負に突入してない？</li>
<li><strong>縦軸は整数</strong>。しかもの<strong>ばらつき</strong>が横軸に応じて変化？</li>
<li><strong>データに合わせた統計モデルを使うとマシ</strong></li>
</ul>

</section>
<section>
<h2 id="回帰は教師あり機械学習の一種とも言える">回帰は教師あり機械学習の一種とも言える</h2>
<figure>
<img src="../tokiomarine2021/regression-in-ml.drawio.svg" width="1000">
</figure>
<p>でも統計モデリングはいわゆる“機械学習”とは違う気もする&hellip;?</p>
</section>
<section>
<h2 id="モデリングにおける2つのアプローチ">モデリングにおける2つのアプローチ</h2>
<figure>
<img src="../tokiomarine2021/model-approaches.drawio.svg" width="1100"><br>
<figcaption><cite>「データ分析のための数理モデル入門」江崎貴裕 2020 より改変</cite></figcaption>
</figure>
</section>
<section>
<h2 id="どっちも知っておいて使い分けたい">どっちも知っておいて使い分けたい</h2>
<table>
<thead>
<tr>
<th>項目</th>
<th>統計モデリング</th>
<th>近年の機械学習</th>
</tr>
</thead>
<tbody>
<tr>
<td>モデル構造</td>
<td>単純化したい</td>
<td>性能のためなら複雑化</td>
</tr>
<tr>
<td>モデル解釈</td>
<td><strong>ここが強み</strong></td>
<td>難しい。重視しない。途上。</td>
</tr>
<tr>
<td>予測・生成</td>
<td>うまくすれば頑健</td>
<td><strong>主目的</strong>。強力。高精度</td>
</tr>
<tr>
<td>データ量</td>
<td>少なくてもそれなり</td>
<td>大量に必要</td>
</tr>
<tr>
<td>計算量</td>
<td>場合による</td>
<td>場合による</td>
</tr>
<tr>
<td>例</td>
<td>一般化線形モデル<br>階層ベイズモデル</td>
<td>ランダムフォレスト<br>ニューラルネットワーク</td>
</tr>
</tbody>
</table>
<p>教科書的には概ねこんな感じとして、実際の仕事ではどうだろう？</p>
</section>
<section>
<h2 id="現役データサイエンティスト2人に聞きました">現役データサイエンティスト2人に聞きました</h2>
<ul>
<li>統計モデルはデータ加工など事前の手続きが多め。<br>
機械学習は事前の決定が少ないので楽ちん。</li>
<li>「要因の効果はどれくらい？」<br>
意思決定をするのは結局人間。物事を分かった上で判断したい。<br>
<strong>実務の人への説明</strong>や<strong>意思決定</strong>の場面で解析の解釈性が重要。<br></li>
<li><strong>仮説があるなら</strong>、それに基づいて統計モデリング。<br>
何もないところからまず機械学習で要因抽出・仮説生成するのもあり。</li>
<li>統計モデル縛り・実行環境縛りなどの案件もある。</li>
<li>分析方針を決める立場の上級職になるつもりなら統計モデルも必要。</li>
</ul>
<p>協力: <a href="https://twitter.com/kato_kohaku"><code>@kato_kohaku</code></a>さん、<a href="https://twitter.com/teuder"><code>@teuder</code></a>さん</p>
</section>
<section>
<h2 id="本講義のお品書き">本講義のお品書き</h2>
<figure style="float: right;">
<a href="https://kuboweb.github.io/-kubo/ce/IwanamiBook.html">
<img src="../tokiomarine2021/image/kubo-book.jpg" width="400" alt="データ解析のための統計モデリング入門 久保拓弥 2012">
</a>
</figure>
<p>久保先生の&quot;緑本&quot;こと<br>
「データ解析のための統計モデリング入門」<br>
をベースに回帰分析の概要を紹介。</p>
<ol>
<li>イントロ 👈 いまここ</li>
<li>統計モデルの基本
<ul>
<li>直線回帰</li>
<li>確率変数・<strong>確率分布</strong> 👈 次回の主役</li>
<li>尤度・最尤推定</li>
</ul>
</li>
<li>一般化線形モデル、混合モデル</li>
<li>ベイズ統計、階層ベイズモデル</li>
</ol>
<p>回帰のキモは<strong>線ではなく分布</strong></p>

</section>
<section>
<h2 id="参考文献">参考文献</h2>
<ul>
<li><a href="https://amzn.to/33suMIZ">データ解析のための統計モデリング入門</a> 久保拓弥 2012</li>
<li><a href="https://amzn.to/3uwx7Pb">StanとRでベイズ統計モデリング</a> 松浦健太郎 2016</li>
<li><a href="https://amzn.to/3o1eCzP">RとStanではじめる ベイズ統計モデリングによるデータ分析入門</a> 馬場真哉 2019</li>
<li><a href="https://amzn.to/3uCxTKo">データ分析のための数理モデル入門</a> 江崎貴裕 2020</li>
<li><a href="https://amzn.to/3uznzCK">分析者のためのデータ解釈学入門</a> 江崎貴裕 2020</li>
<li><a href="https://amzn.to/3ty80Kv">統計学を哲学する</a> 大塚淳 2020</li>
<li><a href="https://amzn.to/2Q0f6JQ">科学とモデル&mdash;シミュレーションの哲学 入門</a> Michael Weisberg 2017<br>
(原著: <a href="https://amzn.to/3bdvhuI">Simulation and Similarity</a> 2013)</li>
</ul>
<a href="2-distribution.html" class="readmore">
2. 直線回帰、確率分布、擬似乱数生成
</a>

</section>
</div>
</div>
</body>
</html>
