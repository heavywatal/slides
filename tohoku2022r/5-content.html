<!DOCTYPE html>
<html>
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<title>5. ãƒ‡ãƒ¼ã‚¿å†…å®¹ã®å‡¦ç†: æ•°å€¤ã€æ–‡å­—åˆ—ã€æ—¥æ™‚ãªã© â€” é€²åŒ–å­¦å®Ÿç¿’ 2022 ç‰§é‡ç ”</title>
<link rel="stylesheet" href="/slides/lib/reveal.js/reveal.css">
<link rel="stylesheet" href="/slides/css/theme-reveal.css">
<meta name="author" content="Watal M. Iwasaki">
<meta property="og:title" content="5. ãƒ‡ãƒ¼ã‚¿å†…å®¹ã®å‡¦ç†: æ•°å€¤ã€æ–‡å­—åˆ—ã€æ—¥æ™‚ãªã© â€” é€²åŒ–å­¦å®Ÿç¿’ 2022 ç‰§é‡ç ”">
<meta property="og:type" content="article">
<meta property="og:url" content="https://heavywatal.github.io/slides/tohoku2022r/5-content.html">
<meta property="og:image" content="https://avatars.githubusercontent.com/heavywatal">
<meta property="og:description" content="">
<meta property="og:site_name" content="Slide decks â€” Heavy Watal">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@heavywatal">
<meta name="twitter:creator" content="@heavywatal">
<meta name="generator" content="Hugo 0.96.0" />
<link rel="stylesheet" href="/lib/katex/katex.min.css">
<script defer src="/lib/katex/katex.min.js"></script>
<script defer src="/lib/katex/contrib/auto-render.min.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  renderMathInElement(document.body, {
    delimiters: [
      {left: "\\[", right: "\\]", display: true},
      {left: "$", right: "$", display: false}
    ]
  });
});
</script>
<style>
.katex {
  font-size: 1.12em;
}

.katex-display > .katex {
  text-align: left;
  padding-left: 2rem;
}
</style>

<script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>

<script async src="https://www.googletagmanager.com/gtag/js?id=G-V60H2JH0G6"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-V60H2JH0G6', { 'anonymize_ip': false });
}
</script>

</head>
<body>
<div class="reveal">
<div class="slides">
<section>
<link rel="stylesheet" href="style.css">
<h1 id="é€²åŒ–å­¦å®Ÿç¿’-2022-ç‰§é‡ç ”"><a href=".">é€²åŒ–å­¦å®Ÿç¿’ 2022 ç‰§é‡ç ”</a></h1>
<h3 id="5-ãƒ‡ãƒ¼ã‚¿å†…å®¹ã®å‡¦ç†-æ•°å€¤æ–‡å­—åˆ—æ—¥æ™‚ãªã©">5. ãƒ‡ãƒ¼ã‚¿å†…å®¹ã®å‡¦ç†: æ•°å€¤ã€æ–‡å­—åˆ—ã€æ—¥æ™‚ãªã©ã€‚</h3>
<div class="author">
å²©åµœèˆª
</div>
<div class="affiliation">
æ±åŒ—å¤§å­¦ ç”Ÿå‘½ç§‘å­¦ç ”ç©¶ç§‘ é€²åŒ–ã‚²ãƒãƒŸã‚¯ã‚¹åˆ†é‡ ç‰§é‡ç ”
</div>
<div class="footnote">
2022-04-11 æ±åŒ—å¤§å­¦ ç†å­¦éƒ¨ç”Ÿç‰©å­¦ç§‘ é€²åŒ–å­¦å®Ÿç¿’
<a href="https://heavywatal.github.io/slides/tohoku2022r/">https://heavywatal.github.io/slides/tohoku2022r/</a>
</div>

</section>
<section>
<h2 id="å‰å›ã¾ã§ã®ã¾ã¨ã‚">å‰å›ã¾ã§ã®ã¾ã¨ã‚</h2>
<h3 id="-rã®åŸºç¤">âœ… Rã®åŸºç¤</h3>
<ul>
<li>èª¿ã¹æ–¹ã•ãˆã‚ã‹ã‚Œã°ã€å…¨éƒ¨è¦šãˆãªãã¦ã‚‚å¤§ä¸ˆå¤«</li>
<li>ã‚¨ãƒ©ãƒ¼ã¯æ—¥å¸¸èŒ¶é£¯äº‹ã€‚è½ã¡ç€ã„ã¦èª­ã¿å–ã‚ã†</li>
<li>ã¾ãš<strong>Rã‚¹ã‚¯ãƒªãƒ—ãƒˆ</strong>ã«æ›¸ã„ã¦ã‹ã‚‰ã€<strong>ã‚³ãƒ³ã‚½ãƒ¼ãƒ«</strong>ã§å®Ÿè¡Œ</li>
<li>ä¾¿åˆ©ãª<strong>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸</strong>ã‚’ä½¿ãŠã†</li>
</ul>
<h3 id="-ãƒ‡ãƒ¼ã‚¿è§£æå…¨ä½“ã®æµã‚Œå¯è¦–åŒ–ã ã„ã˜">âœ… ãƒ‡ãƒ¼ã‚¿è§£æå…¨ä½“ã®æµã‚Œã€‚å¯è¦–åŒ–ã ã„ã˜</h3>
<h3 id="-ä¸€è²«æ€§ã®ã‚ã‚‹æ–‡æ³•ã§åˆç†çš„ã«æã‘ã‚‹ggplot2">âœ… ä¸€è²«æ€§ã®ã‚ã‚‹æ–‡æ³•ã§åˆç†çš„ã«æã‘ã‚‹ggplot2</h3>
<h3 id="-ä½¿ãˆã‚‹æ•´ç„¶ãƒ‡ãƒ¼ã‚¿ã«ã™ã‚‹ãŸã‚ã®å‰å‡¦ç†ãŒãŸã„ã¸ã‚“">âœ… ä½¿ãˆã‚‹æ•´ç„¶ãƒ‡ãƒ¼ã‚¿ã«ã™ã‚‹ãŸã‚ã®å‰å‡¦ç†ãŒãŸã„ã¸ã‚“</h3>

</section>
<section>
<h2 id="ãƒ‡ãƒ¼ã‚¿è§£æã®ãŠãŠã¾ã‹ãªæµã‚Œ">ãƒ‡ãƒ¼ã‚¿è§£æã®ãŠãŠã¾ã‹ãªæµã‚Œ</h2>
<ol>
<li>ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ç’°å¢ƒã®æ•´å‚™</li>
<li>ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã€èª­ã¿è¾¼ã¿</li>
<li>æ¢ç´¢çš„ãƒ‡ãƒ¼ã‚¿è§£æ
<ul>
<li><strong>å‰å‡¦ç†ã€åŠ å·¥</strong> (åœ°å‘³ã€‚æ„å¤–ã¨é‡ã„) ğŸ‘ˆ æœ¬å®Ÿç¿’ã®ä¸»é¡Œ</li>
<li>å¯è¦–åŒ–ã€ä»®èª¬ç”Ÿæˆ (æ´¾æ‰‹ï¼ã ã„ã˜ï¼)</li>
<li>çµ±è¨ˆè§£æã€ä»®èª¬æ¤œè¨¼ (ã¿ã‚“ãªå‹‰å¼·ã—ãŸãŒã‚‹)</li>
</ul>
</li>
<li>å ±å‘Šã€ç™ºè¡¨</li>
</ol>
<figure>
<a href="https://r4ds.had.co.nz/introduction.html">
<img src="/slides/image/r4ds/data-science.png">
<figcaption class="url">https://r4ds.had.co.nz/introduction.html</figcaption>
</a>
</figure>
</section>
<section>
<h2 id="å‰å‡¦ç†ã¯å¤§ãã2ã¤ã«åˆ†ã‘ã‚‰ã‚Œã‚‹">å‰å‡¦ç†ã¯å¤§ãã2ã¤ã«åˆ†ã‘ã‚‰ã‚Œã‚‹</h2>
<div style="float: right;">
<a href="https://dplyr.tidyverse.org/">
<img src="/slides/image/hex-stickers/dplyr.png" width="120">
</a><br>
<a href="https://tidyr.tidyverse.org/">
<img src="/slides/image/hex-stickers/tidyr.png" width="120">
</a>
</div>
<ul>
<li>ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å¯¾è±¡ã¨ã™ã‚‹å‡¦ç† &mdash; ç¬¬3, 4å›
<ul>
<li>ä½¿ã„ãŸã„éƒ¨åˆ†ã ã‘æŠ½å‡º &mdash; <code>select()</code>, <code>filter()</code></li>
<li>ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã«ç‰¹å¾´ã‚’è¦ç´„ &mdash; <code>group_by()</code>, <code>summarize()</code></li>
<li>ä½•ã‹ã®é †ã«ä¸¦ã¹æ›¿ãˆ &mdash; <code>arrange()</code></li>
<li>ç•°ãªã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã®çµåˆ &mdash; <code>*_join()</code></li>
<li>å¤‰å½¢: ç¸¦é•· â†” æ¨ªåºƒ &mdash; <code>pivot_longer()</code>, <code>pivot_wider()</code></li>
</ul>
</li>
<li><strong>ãƒ‡ãƒ¼ã‚¿å†…å®¹ã‚’å¯¾è±¡ã¨ã™ã‚‹å‡¦ç†</strong> ğŸ‘ˆ ç¬¬5å› æœ¬æ—¥ã®è©±é¡Œ
<ul>
<li>æ•°å€¤ã®å¤‰æ›: å¯¾æ•°ã€æ­£è¦åŒ–</li>
<li>å¤–ã‚Œå€¤ãƒ»æ¬ æå€¤ã¸ã®å¯¾å‡¦</li>
<li>å‹å¤‰æ›: é€£ç¶šå¤‰æ•°ã€ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã€æŒ‡ç¤ºå¤‰æ•°ã€å› å­ã€æ—¥æ™‚</li>
<li>æ–‡å­—åˆ—å‡¦ç†: æ­£è¦è¡¨ç¾ã«ã‚ˆã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒ</li>
</ul>
</li>
</ul>
<p><cite style="display: block; text-align: right;"><a href="https://www.amazon.co.jp/dp/4774196479/ref=as_li_ss_tl?ie=UTF8&linkCode=ll1&tag=heavywatal-22&linkId=8a3fd4e9a0c944b1b41242bbab8d147b">
æœ¬æ©‹æ™ºå…‰ã€Œå‰å‡¦ç†å¤§å…¨ã€
</a></cite>
</section>
<section>
<h2 id="tidyverse-ãƒ‡ãƒ¼ã‚¿ç§‘å­¦ã®ãŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç¾¤">tidyverse: ãƒ‡ãƒ¼ã‚¿ç§‘å­¦ã®ãŸã‚ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç¾¤</h2>
<ul>
<li>çµ±ä¸€çš„ãªä½¿ã„å‹æ‰‹</li>
<li>ã‚·ãƒ³ãƒ—ãƒ«ãªé–¢æ•°ã‚’ç¹‹ã’ã¦ä½¿ã†ãƒ‡ã‚¶ã‚¤ãƒ³</li>
</ul>
<a href="https://www.tidyverse.org/">
<img src="/slides/image/rstats/hex-badges8.png" width="320" align="right">
</a>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># install.packages(&#34;tidyverse&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="nf">library</span><span class="p">(</span><span class="n">tidyverse</span><span class="p">)</span>  <span class="c1"># ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸èª­ã¿è¾¼ã¿</span>
</span></span></code></pre></div><pre tabindex="0"><code>â”€â”€ Attaching packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 1.3.1 â”€â”€
âœ” ggplot2 3.3.5     âœ” purrr   0.3.4
âœ” tibble  3.1.6     âœ” dplyr   1.0.7
âœ” tidyr   1.2.0     âœ” stringr 1.4.0
âœ” readr   2.1.2     âœ” forcats 0.5.1
â”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
âœ– dplyr::filter() masks stats::filter()
âœ– dplyr::lag()    masks stats::lag()
</code></pre><p>ãŸã¾ã«ã¯æ›´æ–°ã—ã‚ˆã†:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">update.packages</span><span class="p">(</span><span class="n">ask</span> <span class="o">=</span> <span class="s">&#34;no&#34;</span><span class="p">,</span> <span class="n">type</span> <span class="o">=</span> <span class="s">&#34;binary&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ã„ã¡ã„ã¡ç¢ºèªã›ãšã«ãƒ“ãƒ«ãƒ‰æ¸ˆã¿å®‰å®šç‰ˆã‚’å…¥ã‚Œã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€‚ç„¡ãã¦ã‚‚ã€‚</span>
</span></span></code></pre></div>
</section>
<section>
<h2 id="å¤‰æ•°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å‹-å¾©ç¿’">å¤‰æ•°/ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å‹ (å¾©ç¿’)</h2>
<ul>
<li><strong><code>vector</code>: åŸºæœ¬å‹ã€‚ä¸€æ¬¡å…ƒã®é…åˆ—ã€‚</strong> (ğŸ‘ˆä»Šå›ã®ä¸»å½¹)
<ul>
<li><code>logical</code>: è«–ç†å€¤ (<code>TRUE</code> or <code>FALSE</code>)</li>
<li><code>numeric</code>: æ•°å€¤ (æ•´æ•° <code>42L</code> or å®Ÿæ•° <code>3.1416</code>)</li>
<li><code>character</code>: æ–‡å­—åˆ— (<code>&quot;a string&quot;</code>)</li>
<li><code>factor</code>: å› å­ (æ–‡å­—åˆ—ã£ã½ã„ã‘ã©å¾®å¦™ã«é•ã†)</li>
</ul>
</li>
<li><code>array</code>: å¤šæ¬¡å…ƒé…åˆ—ã€‚<code>vector</code>åŒæ§˜ã€å…¨è¦ç´ ãŒåŒã˜å‹ã€‚
<ul>
<li><code>matrix</code>: è¡Œåˆ— = äºŒæ¬¡å…ƒã®é…åˆ—ã€‚</li>
</ul>
</li>
<li><code>list</code>: ç•°ãªã‚‹å‹ã§ã‚‚è©°ã‚è¾¼ã‚ã‚‹å¤ªã£è…¹ãƒ™ã‚¯ãƒˆãƒ«ã€‚</li>
<li><strong><code>data.frame</code>: åŒã˜é•·ã•ã®ãƒ™ã‚¯ãƒˆãƒ«ã‚’ä¸¦ã¹ãŸé•·æ–¹å½¢ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã€‚é‡è¦ã€‚</strong> <br>
<code>tibble</code> ã¨ã‹ <code>tbl_df</code> ã¨å‘¼ã°ã‚Œã‚‹äºœç¨®ã‚‚ã‚ã‚‹ã‘ã©ã»ã¼åŒã˜ã€‚</li>
</ul>

</section>
<section>
<h2 id="vector-ä¸€æ¬¡å…ƒã®é…åˆ—-å¾©ç¿’">vector: ä¸€æ¬¡å…ƒã®é…åˆ— (å¾©ç¿’)</h2>
<p>1å€‹ã®å€¤ã§ã‚‚ãƒ™ã‚¯ãƒˆãƒ«æ‰±ã„ã€‚<br>
ãƒ™ã‚¯ãƒˆãƒ«ã®å„è¦ç´ ã«ä¸€æ°—ã«è¨ˆç®—ã‚’é©ç”¨ã§ãã‚‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">9</span><span class="p">)</span>  <span class="c1"># é•·ã•3ã®æ•°å€¤ãƒ™ã‚¯ãƒˆãƒ«</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">+</span> <span class="n">x</span>           <span class="c1"># åŒã˜é•·ã•åŒå£«ã®è¨ˆç®—</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1]  2  4 18
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="m">10</span>          <span class="c1"># é•·ã•1ã®æ•°å€¤ãƒ™ã‚¯ãƒˆãƒ«</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">+</span> <span class="n">y</span>           <span class="c1"># é•·ã•3 + é•·ã•1 = é•·ã•3 (ãã‚Œãã‚Œè¶³ã—ç®—)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 11 12 19
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>         <span class="c1"># square root</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 1.000000 1.414214 3.000000
</code></pre>
</section>
<section>
<h2 id="æ•°å€¤-numericå‹">æ•°å€¤: numericå‹</h2>
<p>æ™®é€šã¯å€ç²¾åº¦æµ®å‹•å°æ•°ç‚¹å‹ <code>double</code> ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">answer</span> <span class="o">=</span> <span class="m">42</span>
</span></span><span class="line"><span class="cl"><span class="nf">typeof</span><span class="p">(</span><span class="n">answer</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;double&#34;
</code></pre><p>æ˜ç¤ºçš„ã«å¤‰æ›ã—ãŸã‚Šæœ«å°¾ã«Lã‚’ä»˜ã‘ã‚‹ã“ã¨ã§æ•´æ•°æ‰±ã„ã‚‚ã§ãã‚‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">typeof</span><span class="p">(</span><span class="nf">as.integer</span><span class="p">(</span><span class="n">answer</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;integer&#34;
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">whoami</span> <span class="o">=</span> <span class="m">24601L</span>
</span></span><span class="line"><span class="cl"><span class="nf">typeof</span><span class="p">(</span><span class="n">whoami</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;integer&#34;
</code></pre>
</section>
<section>
<h2 id="æ§˜ã€…ãªæ•°å­¦é–¢æ•°">æ§˜ã€…ãªæ•°å­¦é–¢æ•°</h2>
<p>ãƒ™ã‚¯ãƒˆãƒ«ã‚’å—ã‘å–ã‚Šã€ãã‚Œãã‚Œã®è¦ç´ ã«é©ç”¨</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">sqrt</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 1.000000 1.414214 1.732051
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">log</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 0.0000000 0.6931472 1.0986123
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">log10</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 0.0000000 0.3010300 0.4771213
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1]  2.718282  7.389056 20.085537
</code></pre><div style="text-align: right;"><a class="url" href="https://stat.ethz.ch/R-manual/R-patched/library/base/html/00Index.html">
https://stat.ethz.ch/R-manual/R-patched/library/base/html/00Index.html
</a></div>
</section>
<section>
<h2 id="dataframeã¯åˆ—vectorã®é›†ã¾ã‚Š">data.frameã¯åˆ—vectorã®é›†ã¾ã‚Š</h2>
<p>å†…å®¹ã‚’å¤‰æ›´ã™ã‚‹æ–¹æ³•ã¯ã„ãã¤ã‹ã‚ã‚‹ã€‚<br>
<code>diamonds</code> ã® <code>price</code> åˆ—ã‚’ãƒ‰ãƒ«ã‹ã‚‰å††ã«å¤‰æ›ã™ã‚‹ä¾‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">dia</span> <span class="o">=</span> <span class="n">diamonds</span>    <span class="c1"># åˆ¥åã‚³ãƒ”ãƒ¼</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># dollaræ¼”ç®—å­ $ ã§æŒ‡å®š</span>
</span></span><span class="line"><span class="cl"><span class="n">dia</span><span class="o">$</span><span class="n">price</span> <span class="o">=</span> <span class="m">105.59</span> <span class="o">*</span> <span class="n">dia</span><span class="o">$</span><span class="n">price</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># åå‰ã‚’ [[æ–‡å­—åˆ—]] ã§æŒ‡å®š</span>
</span></span><span class="line"><span class="cl"><span class="n">dia[[</span><span class="s">&#34;price&#34;</span><span class="n">]]</span> <span class="o">=</span> <span class="m">105.59</span> <span class="o">*</span> <span class="n">dia[[</span><span class="s">&#34;price&#34;</span><span class="n">]]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># dplyr::mutate with pipe</span>
</span></span><span class="line"><span class="cl"><span class="n">dia</span> <span class="o">=</span> <span class="n">diamonds</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">price</span> <span class="o">=</span> <span class="m">105.59</span> <span class="o">*</span> <span class="n">price</span><span class="p">)</span>
</span></span></code></pre></div><p>1ç™ºãªã‚‰ã©ã‚Œã§ã‚‚ã„ã„ã€‚æµã‚Œä½œæ¥­ã«ã¯ <code>mutate()</code> ãŒä¾¿åˆ©ã€‚</p>

</section>
<section>
<h2 id="æ­£è¦åŒ–-min-max-normalization">æ­£è¦åŒ– (min-max normalization)</h2>
<p>æœ€å°=0ã€æœ€å¤§=1ã€ã«ãªã‚‹ã‚ˆã†ã«:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">normalized_minmax</span> <span class="o">=</span> <span class="n">diamonds</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">price</span> <span class="o">=</span> <span class="p">(</span><span class="n">price</span> <span class="o">-</span> <span class="nf">min</span><span class="p">(</span><span class="n">price</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">price</span><span class="p">)</span> <span class="o">-</span> <span class="nf">min</span><span class="p">(</span><span class="n">price</span><span class="p">)))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>      carat       cut color clarity depth table        price     x     y     z
      &lt;dbl&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
    1  0.23     Ideal     E     SI2  61.5    55 0.000000e+00  3.95  3.98  2.43
    2  0.21   Premium     E     SI1  59.8    61 0.000000e+00  3.89  3.84  2.31
    3  0.23      Good     E     VS1  56.9    65 5.406282e-05  4.05  4.07  2.31
    4  0.29   Premium     I     VS2  62.4    58 4.325026e-04  4.20  4.23  2.63
   --                                                                         
53937  0.72      Good     D     SI1  63.1    55 1.314267e-01  5.69  5.75  3.61
53938  0.70 Very Good     D     SI1  62.8    60 1.314267e-01  5.66  5.68  3.56
53939  0.86   Premium     H     SI2  61.0    58 1.314267e-01  6.15  6.12  3.74
53940  0.75     Ideal     D     SI2  62.2    55 1.314267e-01  5.83  5.87  3.64
</code></pre><p>å¤–ã‚Œå€¤ã®å½±éŸ¿ã‚’å¤§ããå—ã‘ã‚‹ã“ã¨ã«æ³¨æ„ã€‚</p>

</section>
<section>
<h2 id="æ­£è¦åŒ–-z-score-normalization">æ­£è¦åŒ– (z-score normalization)</h2>
<p>å¹³å‡=0ã€æ¨™æº–åå·®=1ã€ã«ãªã‚‹ã‚ˆã†ã«:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">normalized_z</span> <span class="o">=</span> <span class="n">diamonds</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">price</span> <span class="o">=</span> <span class="p">(</span><span class="n">price</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">price</span><span class="p">))</span> <span class="o">/</span> <span class="nf">sd</span><span class="p">(</span><span class="n">price</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>      carat       cut color clarity depth table      price     x     y     z
      &lt;dbl&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
    1  0.23     Ideal     E     SI2  61.5    55 -0.9040868  3.95  3.98  2.43
    2  0.21   Premium     E     SI1  59.8    61 -0.9040868  3.89  3.84  2.31
    3  0.23      Good     E     VS1  56.9    65 -0.9038361  4.05  4.07  2.31
    4  0.29   Premium     I     VS2  62.4    58 -0.9020815  4.20  4.23  2.63
   --                                                                       
53937  0.72      Good     D     SI1  63.1    55 -0.2947280  5.69  5.75  3.61
53938  0.70 Very Good     D     SI1  62.8    60 -0.2947280  5.66  5.68  3.56
53939  0.86   Premium     H     SI2  61.0    58 -0.2947280  6.15  6.12  3.74
53940  0.75     Ideal     D     SI2  62.2    55 -0.2947280  5.83  5.87  3.64
</code></pre><p><code>price = as.vector(scale(price))</code> ã§ã‚‚å¯èƒ½ã€‚<br>
<code>scale()</code> ã¯matrixã‚’è¿”ã™ãŸã‚ <code>as.vector()</code> ãŒå¿…è¦ã€‚</p>

</section>
<section>
<h2 id="æ­£è¦åŒ–ã®çµæœã‚’ç¢ºèª">æ­£è¦åŒ–ã®çµæœã‚’ç¢ºèª</h2>
<p>åˆ†å¸ƒã®å½¢ã¯å¤‰ã‚ã‚‰ãšã€ç¯„å›²ãŒå¤‰ã‚ã‚‹ã€‚</p>
<p>z-scoreã¯æ­£è¦åˆ†å¸ƒå‰æã€‚ã“ã‚Œã ã‘éå¯¾ç§°ã ã¨ä½¿ã„ã«ãã„ã€‚</p>
<p><img src="figure/normalize-plot-1.png" alt="plot of chunk normalize-plot"></p>

</section>
<section>
<h2 id="å¤–ã‚Œå€¤ã®é™¤å»">å¤–ã‚Œå€¤ã®é™¤å»</h2>
<p>å¹³å‡å€¤ã‹ã‚‰æ¨™æº–åå·®ã®3å€ä»¥ä¸Šé›¢ã‚Œã¦ã„ã‚‹ã‚‚ã®($\lvert z \rvert \ge 3$)ã‚’å–ã‚Šé™¤ãä¾‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">diamonds</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">price</span> <span class="o">-</span> <span class="nf">mean</span><span class="p">(</span><span class="n">price</span><span class="p">))</span> <span class="o">/</span> <span class="nf">sd</span><span class="p">(</span><span class="n">price</span><span class="p">)</span> <span class="o">&lt;</span> <span class="m">3</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>      carat       cut color clarity depth table price     x     y     z
      &lt;dbl&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
    1  0.23     Ideal     E     SI2  61.5    55   326  3.95  3.98  2.43
    2  0.21   Premium     E     SI1  59.8    61   326  3.89  3.84  2.31
    3  0.23      Good     E     VS1  56.9    65   327  4.05  4.07  2.31
    4  0.29   Premium     I     VS2  62.4    58   334  4.20  4.23  2.63
   --                                                                  
52731  0.72      Good     D     SI1  63.1    55  2757  5.69  5.75  3.61
52732  0.70 Very Good     D     SI1  62.8    60  2757  5.66  5.68  3.56
52733  0.86   Premium     H     SI2  61.0    58  2757  6.15  6.12  3.74
52734  0.75     Ideal     D     SI2  62.2    55  2757  5.83  5.87  3.64
</code></pre><p>å”¯ä¸€ã®æ–¹æ³•ã§ã¯ãªã„ã—ã€ãã‚‚ãã‚‚ã‚„ã‚‹ã¹ãã‹ã©ã†ã‹ã‚‚è¦æ¤œè¨</p>

</section>
<section>
<h2 id="æ¬ æå€¤ã®é™¤å»-tidyrdrop_na">æ¬ æå€¤ã®é™¤å» <code>tidyr::drop_na()</code></h2>
<p>(æŒ‡å®šã—ãŸåˆ—ã«) <code>NA</code> ãŒå«ã¾ã‚Œã¦ã‚‹è¡Œã‚’å‰Šé™¤ã™ã‚‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="nf">tibble</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kc">NA</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;a&#34;</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="s">&#34;b&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">%&gt;%</span> <span class="nf">drop_na</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>      x     y
  &lt;dbl&gt; &lt;chr&gt;
1     1     a
</code></pre><p>ğŸ”° <code>starwars</code> ã§<strong>èº«é•·ä½“é‡ãƒ‡ãƒ¼ã‚¿ã®ã‚ã‚‹è¡Œã ã‘æŠ½å‡º</strong>ã—ã¦ã¿ã‚ˆã†</p>
<pre tabindex="0"><code>             name height  mass hair_color  skin_color eye_color birth_year    sex    gender homeworld species     films  vehicles starships
            &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;      &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;list&gt;    &lt;list&gt;    &lt;list&gt;
 1 Luke Skywalker    172    77      blond        fair      blue       19.0   male masculine  Tatooine   Human &lt;chr [5]&gt; &lt;chr [2]&gt; &lt;chr [2]&gt;
 2          C-3PO    167    75       &lt;NA&gt;        gold    yellow      112.0   none masculine  Tatooine   Droid &lt;chr [6]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 3          R2-D2     96    32       &lt;NA&gt; white, blue       red       33.0   none masculine     Naboo   Droid &lt;chr [7]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 4    Darth Vader    202   136       none       white    yellow       41.9   male masculine  Tatooine   Human &lt;chr [4]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
--                                                                                                                                         
84    Poe Dameron     NA    NA      brown       light     brown         NA   male masculine      &lt;NA&gt;   Human &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
85            BB8     NA    NA       none        none     black         NA   none masculine      &lt;NA&gt;   Droid &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
86 Captain Phasma     NA    NA    unknown     unknown   unknown         NA   &lt;NA&gt;      &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt; &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
87  PadmÃ© Amidala    165    45      brown       light     brown       46.0 female  feminine     Naboo   Human &lt;chr [3]&gt; &lt;chr [0]&gt; &lt;chr [3]&gt;
</code></pre>
</section>
<section>
<h2 id="æ¬ æå€¤ã®è£œå®Œ-tidyrreplace_na">æ¬ æå€¤ã®è£œå®Œ <code>tidyr::replace_na()</code></h2>
<p>æ¬ æå€¤ <code>NA</code> ã‚’ä»»æ„ã®å€¤ã§ç½®ãæ›ãˆã‚‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="nf">tibble</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kc">NA</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;a&#34;</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="s">&#34;b&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">%&gt;%</span> <span class="nf">replace_na</span><span class="p">(</span><span class="nf">list</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="m">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s">&#34;unknown&#34;</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>      x       y
  &lt;dbl&gt;   &lt;chr&gt;
1     1       a
2     2 unknown
3     0       b
</code></pre><p>ğŸ”° <code>starwars</code> ã§<strong>é«ªã‚„ç›®ã®è‰²ãŒä¸æ˜ã®éƒ¨åˆ†ã‚’&quot;UNKNOWN&quot;ã«ç½®æ›</strong>ã—ã‚ˆã†</p>
<pre tabindex="0"><code>             name height  mass hair_color  skin_color eye_color birth_year    sex    gender homeworld species     films  vehicles starships
            &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;      &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;list&gt;    &lt;list&gt;    &lt;list&gt;
 1 Luke Skywalker    172    77      blond        fair      blue       19.0   male masculine  Tatooine   Human &lt;chr [5]&gt; &lt;chr [2]&gt; &lt;chr [2]&gt;
 2          C-3PO    167    75       &lt;NA&gt;        gold    yellow      112.0   none masculine  Tatooine   Droid &lt;chr [6]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 3          R2-D2     96    32       &lt;NA&gt; white, blue       red       33.0   none masculine     Naboo   Droid &lt;chr [7]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 4    Darth Vader    202   136       none       white    yellow       41.9   male masculine  Tatooine   Human &lt;chr [4]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
--                                                                                                                                         
84    Poe Dameron     NA    NA      brown       light     brown         NA   male masculine      &lt;NA&gt;   Human &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
85            BB8     NA    NA       none        none     black         NA   none masculine      &lt;NA&gt;   Droid &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
86 Captain Phasma     NA    NA    unknown     unknown   unknown         NA   &lt;NA&gt;      &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt; &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
87  PadmÃ© Amidala    165    45      brown       light     brown       46.0 female  feminine     Naboo   Human &lt;chr [3]&gt; &lt;chr [0]&gt; &lt;chr [3]&gt;
</code></pre>
</section>
<section>
<h2 id="æ¬ æå€¤ã¨ã¿ãªã™-dplyrna_if">æ¬ æå€¤ã¨ã¿ãªã™ <code>dplyr::na_if()</code></h2>
<p>ç‰¹å®šã®å€¤ã‚’ <code>NA</code> ã«ç½®ãæ›ãˆã‚‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">na_if</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="nf">na_if</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="s">&#34;a&#34;</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>      x     y
  &lt;dbl&gt; &lt;chr&gt;
1    NA  &lt;NA&gt;
2     2  &lt;NA&gt;
3    NA     b
</code></pre><p>ğŸ”° <code>starwars</code> ã®<strong>æ€§åˆ¥&quot;none&quot;ã‚’æ¬ æå€¤ã«</strong>ã—ã‚ˆã†</p>
<pre tabindex="0"><code>             name height  mass hair_color  skin_color eye_color birth_year    sex    gender homeworld species     films  vehicles starships
            &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;      &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;list&gt;    &lt;list&gt;    &lt;list&gt;
 1 Luke Skywalker    172    77      blond        fair      blue       19.0   male masculine  Tatooine   Human &lt;chr [5]&gt; &lt;chr [2]&gt; &lt;chr [2]&gt;
 2          C-3PO    167    75       &lt;NA&gt;        gold    yellow      112.0   none masculine  Tatooine   Droid &lt;chr [6]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 3          R2-D2     96    32       &lt;NA&gt; white, blue       red       33.0   none masculine     Naboo   Droid &lt;chr [7]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 4    Darth Vader    202   136       none       white    yellow       41.9   male masculine  Tatooine   Human &lt;chr [4]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
--                                                                                                                                         
84    Poe Dameron     NA    NA      brown       light     brown         NA   male masculine      &lt;NA&gt;   Human &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
85            BB8     NA    NA       none        none     black         NA   none masculine      &lt;NA&gt;   Droid &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
86 Captain Phasma     NA    NA    unknown     unknown   unknown         NA   &lt;NA&gt;      &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt; &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
87  PadmÃ© Amidala    165    45      brown       light     brown       46.0 female  feminine     Naboo   Human &lt;chr [3]&gt; &lt;chr [0]&gt; &lt;chr [3]&gt;
</code></pre>
</section>
<section>
<h2 id="æ¬ æå€¤ã®è£œå®Œ-dplyrcoalesce">æ¬ æå€¤ã®è£œå®Œ <code>dplyr::coalesce()</code></h2>
<p>å…ˆã«æŒ‡å®šã—ãŸåˆ—ãŒ <code>NA</code> ãªã‚‰æ¬¡ã®åˆ—ã®å€¤ã‚’æ¡ç”¨:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">z</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">coalesce</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 1 2 3 4 5
</code></pre><p>ç•°ãªã‚‹å‹ã‚’æ··ãœã‚‹ã¨æ€’ã‚‰ã‚Œã‚‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="nf">tibble</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kc">NA</span><span class="p">),</span> <span class="n">y</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;a&#34;</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="s">&#34;b&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">%&gt;%</span> <span class="nf">mutate</span><span class="p">(</span><span class="n">z</span> <span class="o">=</span> <span class="nf">coalesce</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>Error in `mutate_cols()`:
! Problem with `mutate()` column `z`.
â„¹ `z = coalesce(x, y)`.
âœ– Can&#39;t combine `..1` &lt;double&gt; and `..2` &lt;character&gt;.
Caused by error in `stop_vctrs()`:
! Can&#39;t combine `..1` &lt;double&gt; and `..2` &lt;character&gt;.
</code></pre><p>ğŸ”° <code>starwars</code> ã§<strong>é«ªè‰²ã®æ¬ æå€¤ã‚’è‚Œè‰²ã§è£œãŠã†</strong></p>

</section>
<section>
<h2 id="æ¡ä»¶ã«å¿œã˜ã¦å€¤ã‚’é¸æŠ-dplyrif_else">æ¡ä»¶ã«å¿œã˜ã¦å€¤ã‚’é¸æŠ <code>dplyr::if_else()</code></h2>
<p>æ™®é€šã® <code>if</code>, <code>else</code> ã¨ã¯é•ã£ã¦vectoræ¼”ç®—ãªã®ãŒç‰¹å¾´:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">condition</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="kc">TRUE</span><span class="p">,</span> <span class="kc">TRUE</span><span class="p">,</span> <span class="kc">FALSE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="m">100</span><span class="p">,</span> <span class="m">200</span><span class="p">,</span> <span class="m">300</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">if_else</span><span class="p">(</span><span class="n">condition</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1]   1   2 300
</code></pre><p>ğŸ”° <code>starwars</code> ã§<strong>ç¨®æ—ãŒãƒ‰ãƒ­ã‚¤ãƒ‰ã®è¡Œã ã‘èº«é•·ã‚’100å€</strong>ã—ã¦ã¿ã‚ˆã†</p>
<pre tabindex="0"><code>             name height  mass hair_color  skin_color eye_color birth_year    sex    gender homeworld species     films  vehicles starships
            &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;      &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;list&gt;    &lt;list&gt;    &lt;list&gt;
 1 Luke Skywalker    172    77      blond        fair      blue       19.0   male masculine  Tatooine   Human &lt;chr [5]&gt; &lt;chr [2]&gt; &lt;chr [2]&gt;
 2          C-3PO    167    75       &lt;NA&gt;        gold    yellow      112.0   none masculine  Tatooine   Droid &lt;chr [6]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 3          R2-D2     96    32       &lt;NA&gt; white, blue       red       33.0   none masculine     Naboo   Droid &lt;chr [7]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 4    Darth Vader    202   136       none       white    yellow       41.9   male masculine  Tatooine   Human &lt;chr [4]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
--                                                                                                                                         
84    Poe Dameron     NA    NA      brown       light     brown         NA   male masculine      &lt;NA&gt;   Human &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
85            BB8     NA    NA       none        none     black         NA   none masculine      &lt;NA&gt;   Droid &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
86 Captain Phasma     NA    NA    unknown     unknown   unknown         NA   &lt;NA&gt;      &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt; &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
87  PadmÃ© Amidala    165    45      brown       light     brown       46.0 female  feminine     Naboo   Human &lt;chr [3]&gt; &lt;chr [0]&gt; &lt;chr [3]&gt;
</code></pre>
</section>
<section>
<h2 id="æ–‡å­—åˆ—-characterå‹-string">æ–‡å­—åˆ—: characterå‹ (string)</h2>
<p>ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã§å›²ã‚€ã€‚ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã‚‚ä½¿ãˆã‚‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="s">&#34;This is a string&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="s">&#39;If I want to include a &#34;quote&#34; inside a string, I use single quotes&#39;</span>
</span></span></code></pre></div><p>é–‰ã˜ãã³ã‚Œã‚‹ã¨å¤‰ãªçŠ¶æ…‹ã«ãªã‚‹ã®ã§ã€è½ã¡ç€ã„ã¦ <kbd>esc</kbd> or <kbd>ctrl</kbd><kbd>c</kbd></p>
<pre tabindex="0"><code>&gt; &#34;This is a string without a closing quote
+
+
+ HELP I&#39;M STUCK
</code></pre><div style="text-align: right;"><a class="url" href=https://r4ds.had.co.nz/strings.html>
https://r4ds.had.co.nz/strings.html
</a></div>
</section>
<section>
<h2 id="rå‚™ãˆä»˜ã‘ã®æ–‡å­—åˆ—æ©Ÿèƒ½ã¯ä½¿ã„ã«ãã„">Rå‚™ãˆä»˜ã‘ã®æ–‡å­—åˆ—æ©Ÿèƒ½ã¯ä½¿ã„ã«ãã„</h2>
<ul>
<li>
<p>ä½•ã‚’ã‚„ã‚‹é–¢æ•°ãªã®ã‹åå‰ã‹ã‚‰åˆ†ã‹ã‚Šã«ãã„<br>
<code>grep</code>, <code>grepl</code>, <code>regexpr</code>, <code>gregexpr</code>, <code>regexec</code><br>
<code>sub</code>, <code>gsub</code>, <code>substr</code>, <code>substring</code></p>
</li>
<li>
<p>å¯¾è±¡æ–‡å­—åˆ—ã¯ã„ãã¤ã‚ã«æ¸¡ã™ï¼Ÿé–¢æ•°ã”ã¨ã«é•ã†ã€‚e.g.,<br></p>
<pre tabindex="0"><code>grep(pattern, x, ...)
sub(pattern, replacement, x, ...)
substr(x, start, stop)
</code></pre></li>
<li>
<p>æ¬ æå€¤ <code>NA</code> ã«å¯¾ã™ã‚‹æŒ™å‹•ãŒå¾®å¦™</p>
</li>
</ul>

</section>
<section>
<h2 id="stringr-----æ–‡å­—åˆ—å‡¦ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸">stringr &mdash; æ–‡å­—åˆ—å‡¦ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸</h2>
<a href="https://stringr.tidyverse.org/">
<img src="/slides/image/hex-stickers/stringr.png" width="120" align="right">
</a>
<ul>
<li>tidyverseã®ä¸€éƒ¨</li>
<li>ä½•ã‚’ã‚„ã‚‹é–¢æ•°ãªã®ã‹åå‰ã‹ã‚‰åˆ†ã‹ã‚Šã‚„ã™ã„</li>
<li>å¯¾è±¡æ–‡å­—åˆ—ãŒä¸€è²«ã—ã¦ç¬¬ä¸€å¼•æ•°</li>
<li>å¼•æ•°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å„è¦ç´ ã®åå‰ã‚„ä½ç½®ã‚’ä¿æŒã™ã‚‹
<ul>
<li>é•·ã•ã‚¼ãƒ­ã®å…¥åŠ›ã‹ã‚‰ã¯é•·ã•ã‚¼ãƒ­ã®å‡ºåŠ›</li>
<li>å…¥åŠ›ã« <code>NA</code> ãŒå«ã¾ã‚Œã‚‹å ´åˆã¯å¯¾å¿œã™ã‚‹å‡ºåŠ›ã‚‚ <code>NA</code></li>
</ul>
</li>
<li><a href="https://unicode-org.github.io/icu/userguide/strings/regexp.html">ICUæ­£è¦è¡¨ç¾</a>ã®ä»•æ§˜ãŒæ˜ç¢º</li>
<li><a href="https://stringr.tidyverse.org/">å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>ã‚’è¦‹ã‚Œã°å…¨å®¹ãŒæ´ã‚ã‚‹</li>
</ul>

</section>
<section>
<h2 id="stringr-----æ–‡å­—åˆ—å‡¦ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸">stringr &mdash; æ–‡å­—åˆ—å‡¦ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸</h2>
<figure style="margin: 0;">
<a href="https://stringr.tidyverse.org/">
<img src="/slides/image/cheatsheet/strings.png" width="90%">
<figcaption class="url">https://stringr.tidyverse.org/</figcaption>
</a>
</figure>

</section>
<section>
<h2 id="æ–‡å­—åˆ—ã®åŸºæœ¬æ“ä½œ">æ–‡å­—åˆ—ã®åŸºæœ¬æ“ä½œ</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fruit4</span> <span class="o">=</span> <span class="nf">head</span><span class="p">(</span><span class="n">fruit</span><span class="p">,</span> <span class="m">4L</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">print</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;apple&#34;   &#34;apricot&#34; &#34;avocado&#34; &#34;banana&#34; 
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">str_length</span><span class="p">(</span><span class="n">fruit4</span><span class="p">)</span>            <span class="c1"># é•·ã•</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 5 7 7 6
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">str_sub</span><span class="p">(</span><span class="n">fruit4</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>         <span class="c1"># éƒ¨åˆ†æŠ½å‡º</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;ppl&#34; &#34;pri&#34; &#34;voc&#34; &#34;ana&#34;
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">str_c</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> <span class="s">&#34; &#34;</span><span class="p">,</span> <span class="n">fruit4</span><span class="p">,</span> <span class="s">&#34;!&#34;</span><span class="p">)</span>  <span class="c1"># çµåˆ</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;1 apple!&#34;   &#34;2 apricot!&#34; &#34;3 avocado!&#34; &#34;4 banana!&#34; 
</code></pre><p>ğŸ”° <code>fruit</code> ã‚„ <code>words</code> ã®ä¸€éƒ¨ã‚’æŠœãå‡ºã—ã¦ä¸Šè¨˜ã®é–¢æ•°ã‚’è©¦ã—ã¦ã¿ã‚ˆã†</p>

</section>
<section>
<h2 id="ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°">ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°</h2>
<p>å˜ç´”ãªä¸€è‡´ã ã‘ã˜ã‚ƒãªãã€ã„ã‚ã‚“ãªæ¡ä»¶ã§ãƒãƒƒãƒãƒ³ã‚°ã§ãã‚‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># aã§å§‹ã¾ã‚‹</span>
</span></span><span class="line"><span class="cl"><span class="nf">str_subset</span><span class="p">(</span><span class="n">fruit</span><span class="p">,</span> <span class="s">&#34;^a&#34;</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;apple&#34;   &#34;apricot&#34; &#34;avocado&#34;
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># rã§çµ‚ã‚ã‚‹</span>
</span></span><span class="line"><span class="cl"><span class="nf">str_subset</span><span class="p">(</span><span class="n">fruit</span><span class="p">,</span> <span class="s">&#34;r$&#34;</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;bell pepper&#34;  &#34;chili pepper&#34; &#34;cucumber&#34;     &#34;pear&#34;        
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="c1"># è‹±æ•°å­—3-4æ–‡å­—</span>
</span></span><span class="line"><span class="cl"><span class="nf">str_subset</span><span class="p">(</span><span class="n">fruit</span><span class="p">,</span> <span class="s">&#34;^\\w{3,4}$&#34;</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;date&#34; &#34;fig&#34;  &#34;lime&#34; &#34;nut&#34;  &#34;pear&#34; &#34;plum&#34;
</code></pre><p>ã“ã® <code>^</code> ã¨ã‹ <code>$</code> ã£ã¦ä½•è€…ï¼Ÿ</p>

</section>
<section>
<h2 id="æ­£è¦è¡¨ç¾-æŸ”è»Ÿãªæ¤œç´¢ç½®æ›ã‚’å¯èƒ½ã«ã™ã‚‹ãƒ„ãƒ¼ãƒ«">æ­£è¦è¡¨ç¾: æŸ”è»Ÿãªæ¤œç´¢ãƒ»ç½®æ›ã‚’å¯èƒ½ã«ã™ã‚‹ãƒ„ãƒ¼ãƒ«</h2>
<table>
<thead>
<tr>
<th>ãƒ¡ã‚¿æ–‡å­—</th>
<th>æ„å‘³</th>
<th>â€ƒâ€ƒ</th>
<th>æ¼”ç®—å­</th>
<th>æ„å‘³</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>\d</code></td>
<td>æ•°å­— (é€†ã¯ <code>\D</code>)</td>
<td></td>
<td><code>?</code></td>
<td>0å›ã‹1å›</td>
</tr>
<tr>
<td><code>\s</code></td>
<td>ç©ºç™½ (é€†ã¯ <code>\S</code>)</td>
<td></td>
<td><code>*</code></td>
<td>0å›ä»¥ä¸Šç¹°ã‚Šè¿”ã—</td>
</tr>
<tr>
<td><code>\w</code></td>
<td>è‹±æ•°å­— (é€†ã¯ <code>\W</code>)</td>
<td></td>
<td><code>+</code></td>
<td>1å›ä»¥ä¸Šç¹°ã‚Šè¿”ã—</td>
</tr>
<tr>
<td><code>.</code></td>
<td><strong>ä½•ã§ã‚‚1æ–‡å­—</strong></td>
<td></td>
<td><code>{n,m}</code></td>
<td>nå›ä»¥ä¸Šmå›ä»¥ä¸‹</td>
</tr>
<tr>
<td><code>^</code></td>
<td>è¡Œé ­</td>
<td></td>
<td><code>XXX(?=YYY)</code></td>
<td>YYYã«å…ˆç«‹ã¤XXX</td>
</tr>
<tr>
<td><code>$</code></td>
<td>è¡Œæœ«</td>
<td></td>
<td><code>(?&lt;=YYY)XXX</code></td>
<td>YYYã«ç¶šãXXX</td>
</tr>
</tbody>
</table>
<div style="text-align: right;"><a class="url" href="https://unicode-org.github.io/icu/userguide/strings/regexp.html#regular-expression-metacharacters">
https://unicode-org.github.io/icu/userguide/strings/regexp.html#regular-expression-metacharacters
</a></div>
<p>Rã®<code>&quot;æ™®é€šã®æ–‡å­—åˆ—&quot;</code>ã§ã¯ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚’é‡ã­ã‚‹å¿…è¦ãŒã‚ã‚‹: <code>&quot;^\\d&quot;</code>.</p>
<aside style="font-size: 0.9rem; color: #888888;">
<p>æ”¹è¡Œ <code>\n</code> ã¨ã‹ã‚¿ãƒ– <code>\t</code> ã®ã‚ˆã†ãª<a href="https://duckduckgo.com/?q=escape+sequence">ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹</a>ã¨åŒºåˆ¥ã™ã‚‹ãŸã‚ã€‚<br>
<code>r&quot;(rawæ–‡å­—åˆ—)&quot;</code>ã‚’ä½¿ã†å ´åˆã¯ã²ã¨ã¤ã§ã„ã„: <code>r&quot;(^\d)&quot;</code>.</p>
</aside>
</section>
<section>
<h2 id="æ­£è¦è¡¨ç¾-ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ">æ­£è¦è¡¨ç¾: ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ</h2>
<figure style="margin: 0;">
<a href="https://stringr.tidyverse.org/">
<img src="/slides/image/cheatsheet/strings-regex.png" width="90%">
<figcaption class="url">https://stringr.tidyverse.org/</figcaption>
</a>
</figure>
</section>
<section>
<h2 id="æ­£è¦è¡¨ç¾-ç·´ç¿’å•é¡Œ">æ­£è¦è¡¨ç¾: ç·´ç¿’å•é¡Œ</h2>
<p>ğŸ”° <code>str_subset()</code>, <code>fruit</code>, <code>words</code> ã§ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒã‚’èº«ã«ç€ã‘ã‚ˆã†</p>
<ul>
<li>&ldquo;o&rdquo; ã§å§‹ã¾ã‚‹ã‚‚ã®</li>
<li>&ldquo;berry&rdquo; ã§çµ‚ã‚ã‚‹ã‚‚ã®</li>
<li>&ldquo;c&rdquo; ã§å§‹ã¾ã‚Š &ldquo;r&rdquo; ã§çµ‚ã‚ã‚‹ã‚‚ã®</li>
<li>ç©ºç™½ã‚’å«ã‚€ã‚‚ã®ã€å«ã¾ãªã„ã‚‚ã®</li>
<li>æ•°å­—ã‚’å«ã‚€ã‚‚ã®ã€å«ã¾ãªã„ã‚‚ã®</li>
<li>ãã®ã»ã‹è‡ªåˆ†ã§é©å½“ã«è€ƒãˆã¦ã¿ã‚‹</li>
</ul>

</section>
<section>
<h2 id="æ¤œå‡º-str_detect">æ¤œå‡º <code>str_detect()</code></h2>
<p>ãƒãƒƒãƒã™ã‚‹ã‹ã©ã†ã‹ <code>TRUE</code>/<code>FALSE</code> ã‚’è¿”ã™ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fruit4</span> <span class="o">=</span> <span class="nf">head</span><span class="p">(</span><span class="n">fruit</span><span class="p">,</span> <span class="m">4L</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">str_detect</span><span class="p">(</span><span class="n">fruit4</span><span class="p">,</span> <span class="s">&#34;^a&#34;</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1]  TRUE  TRUE  TRUE FALSE
</code></pre><p>ğŸ”° <code>starwars</code> ã‹ã‚‰ <code>name</code> åˆ—ã«ç©ºç™½ã‚’å«ã¾ãªã„è¡Œã‚’æŠ½å‡ºã—ã‚ˆã†</p>
<pre tabindex="0"><code>             name height  mass hair_color  skin_color eye_color birth_year    sex    gender homeworld species     films  vehicles starships
            &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;      &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;list&gt;    &lt;list&gt;    &lt;list&gt;
 1 Luke Skywalker    172    77      blond        fair      blue       19.0   male masculine  Tatooine   Human &lt;chr [5]&gt; &lt;chr [2]&gt; &lt;chr [2]&gt;
 2          C-3PO    167    75       &lt;NA&gt;        gold    yellow      112.0   none masculine  Tatooine   Droid &lt;chr [6]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 3          R2-D2     96    32       &lt;NA&gt; white, blue       red       33.0   none masculine     Naboo   Droid &lt;chr [7]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 4    Darth Vader    202   136       none       white    yellow       41.9   male masculine  Tatooine   Human &lt;chr [4]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
--                                                                                                                                         
84    Poe Dameron     NA    NA      brown       light     brown         NA   male masculine      &lt;NA&gt;   Human &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
85            BB8     NA    NA       none        none     black         NA   none masculine      &lt;NA&gt;   Droid &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
86 Captain Phasma     NA    NA    unknown     unknown   unknown         NA   &lt;NA&gt;      &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt; &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
87  PadmÃ© Amidala    165    45      brown       light     brown       46.0 female  feminine     Naboo   Human &lt;chr [3]&gt; &lt;chr [0]&gt; &lt;chr [3]&gt;
</code></pre>
</section>
<section>
<h2 id="æŠ½å‡º-str_extract">æŠ½å‡º <code>str_extract()</code></h2>
<p>ãƒãƒƒãƒã—ãŸéƒ¨åˆ†æ–‡å­—åˆ—ã‚’å–ã‚Šå‡ºã™ã€‚ã—ãªã‹ã£ãŸè¦ç´ ã«ã¯ <code>NA</code>ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fruit4</span> <span class="o">=</span> <span class="nf">head</span><span class="p">(</span><span class="n">fruit</span><span class="p">,</span> <span class="m">4L</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">str_extract</span><span class="p">(</span><span class="n">fruit4</span><span class="p">,</span> <span class="s">&#34;^a..&#34;</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;app&#34; &#34;apr&#34; &#34;avo&#34; NA   
</code></pre><p>ğŸ”° <code>diamonds</code> ã® <code>clarity</code> åˆ—ã‚’æ•°å­—ãªã—ã«ã—ã¦ã¿ã‚ˆã†</p>
<pre tabindex="0"><code>      carat       cut color clarity depth table price     x     y     z
      &lt;dbl&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
    1  0.23     Ideal     E     SI2  61.5    55   326  3.95  3.98  2.43
    2  0.21   Premium     E     SI1  59.8    61   326  3.89  3.84  2.31
    3  0.23      Good     E     VS1  56.9    65   327  4.05  4.07  2.31
    4  0.29   Premium     I     VS2  62.4    58   334  4.20  4.23  2.63
   --                                                                  
53937  0.72      Good     D     SI1  63.1    55  2757  5.69  5.75  3.61
53938  0.70 Very Good     D     SI1  62.8    60  2757  5.66  5.68  3.56
53939  0.86   Premium     H     SI2  61.0    58  2757  6.15  6.12  3.74
53940  0.75     Ideal     D     SI2  62.2    55  2757  5.83  5.87  3.64
</code></pre>
</section>
<section>
<h2 id="ç½®æ›-str_replace-str_replace_all">ç½®æ› <code>str_replace()</code>, <code>str_replace_all()</code></h2>
<p>ã‚«ãƒƒã‚³ <code>()</code> ã§å›²ã‚“ã ãƒãƒƒãƒãƒ³ã‚°ã¯å¾Œã§å‚ç…§ã§ãã‚‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fruit4</span> <span class="o">=</span> <span class="nf">head</span><span class="p">(</span><span class="n">fruit</span><span class="p">,</span> <span class="m">4L</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">str_replace</span><span class="p">(</span><span class="n">fruit4</span><span class="p">,</span> <span class="s">&#34;..$&#34;</span><span class="p">,</span> <span class="s">&#34;!!&#34;</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;app!!&#34;   &#34;apric!!&#34; &#34;avoca!!&#34; &#34;bana!!&#34; 
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">str_replace</span><span class="p">(</span><span class="n">fruit4</span><span class="p">,</span> <span class="s">&#34;(..)$&#34;</span><span class="p">,</span> <span class="s">&#34;_\\1_&#34;</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;app_le_&#34;   &#34;apric_ot_&#34; &#34;avoca_do_&#34; &#34;bana_na_&#34; 
</code></pre><p>ğŸ”° <code>starwars</code> ã® <code>name</code> åˆ—ã®æ•°å­—ã‚’å…¨éƒ¨ã‚¼ãƒ­ã«ã—ã¦ã¿ã‚ˆã†</p>
<pre tabindex="0"><code>             name height  mass hair_color  skin_color eye_color birth_year    sex    gender homeworld species     films  vehicles starships
            &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;      &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;  &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;list&gt;    &lt;list&gt;    &lt;list&gt;
 1 Luke Skywalker    172    77      blond        fair      blue       19.0   male masculine  Tatooine   Human &lt;chr [5]&gt; &lt;chr [2]&gt; &lt;chr [2]&gt;
 2          C-3PO    167    75       &lt;NA&gt;        gold    yellow      112.0   none masculine  Tatooine   Droid &lt;chr [6]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 3          R2-D2     96    32       &lt;NA&gt; white, blue       red       33.0   none masculine     Naboo   Droid &lt;chr [7]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 4    Darth Vader    202   136       none       white    yellow       41.9   male masculine  Tatooine   Human &lt;chr [4]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
--                                                                                                                                         
84    Poe Dameron     NA    NA      brown       light     brown         NA   male masculine      &lt;NA&gt;   Human &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
85            BB8     NA    NA       none        none     black         NA   none masculine      &lt;NA&gt;   Droid &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
86 Captain Phasma     NA    NA    unknown     unknown   unknown         NA   &lt;NA&gt;      &lt;NA&gt;      &lt;NA&gt;    &lt;NA&gt; &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
87  PadmÃ© Amidala    165    45      brown       light     brown       46.0 female  feminine     Naboo   Human &lt;chr [3]&gt; &lt;chr [0]&gt; &lt;chr [3]&gt;
</code></pre>
</section>
<section>
<h2 id="dplyr-tidyr-ã®åˆ—é¸æŠãªã©ã§ã‚‚æ´»èº">dplyr, tidyr ã®åˆ—é¸æŠãªã©ã§ã‚‚æ´»èº</h2>
<p><code>matches()</code> ãŒã‚ã‚Œã° <code>starts_with()</code>/<code>ends_with()</code> ã¯ä¸è¦:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">diamonds</span> <span class="o">%&gt;%</span> <span class="nf">select</span><span class="p">(</span><span class="nf">matches</span><span class="p">(</span><span class="s">&#34;^c&#34;</span><span class="p">))</span>   <span class="c1"># starts_with(&#34;c&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">starwars</span> <span class="o">%&gt;%</span> <span class="nf">select</span><span class="p">(</span><span class="nf">matches</span><span class="p">(</span><span class="s">&#34;s$&#34;</span><span class="p">))</span>   <span class="c1"># ends_with(&#34;s&#34;)</span>
</span></span><span class="line"><span class="cl"><span class="n">world_bank_pop</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">pivot_longer</span><span class="p">(</span><span class="nf">matches</span><span class="p">(</span><span class="s">&#34;^\\d+$&#34;</span><span class="p">),</span> <span class="n">names_to</span> <span class="o">=</span> <span class="s">&#34;year&#34;</span><span class="p">)</span>
</span></span></code></pre></div><p>See <a href="https://tidyselect.r-lib.org/reference/language.html">selection helpers</a> for more details.</p>

</section>
<section>
<h2 id="å½¢å¼ã‚’å¤‰ãˆã‚‹æ•´ãˆã‚‹">å½¢å¼ã‚’å¤‰ãˆã‚‹ãƒ»æ•´ãˆã‚‹</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">fruit4</span> <span class="o">=</span> <span class="nf">head</span><span class="p">(</span><span class="n">fruit</span><span class="p">,</span> <span class="m">4L</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">str_to_upper</span><span class="p">(</span><span class="n">fruit4</span><span class="p">)</span>              <span class="c1"># å¤§æ–‡å­—ã«</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;APPLE&#34;   &#34;APRICOT&#34; &#34;AVOCADO&#34; &#34;BANANA&#34; 
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">str_pad</span><span class="p">(</span><span class="n">fruit4</span><span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="s">&#34;left&#34;</span><span class="p">,</span> <span class="s">&#34;_&#34;</span><span class="p">)</span>   <span class="c1"># å¹…ã‚’åŸ‹ã‚ã¦æŒ‡å®šå¹…ã«</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;___apple&#34; &#34;_apricot&#34; &#34;_avocado&#34; &#34;__banana&#34;
</code></pre><p><a href="http://www.gagolewski.com/software/stringi/"><code>stringi</code></a> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã•ã‚‰ã«å¤šæ©Ÿèƒ½</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">stringi</span><span class="o">::</span><span class="nf">stri_trans_nfkc</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;ï½¶ï¾€ï½¶ï¾…&#34;</span><span class="p">,</span> <span class="s">&#34;ï¼”ï¼’&#34;</span><span class="p">))</span>  <span class="c1"># åŠè§’ã‚«ãƒŠãƒ»å…¨è§’æ•°å­—ã«å¯¾å‡¦</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;ã‚«ã‚¿ã‚«ãƒŠ&#34; &#34;42&#34;      
</code></pre><p>ğŸ”° <code>starwars</code> ã® <code>name</code> åˆ—ã‚’å…¨éƒ¨å°æ–‡å­—ã«ã—ã¦ã¿ã‚ˆã†</p>

</section>
<section>
<h2 id="æ–‡å­—åˆ—ã‹ã‚‰åˆ¥ã®å‹ã«">æ–‡å­—åˆ—ã‹ã‚‰åˆ¥ã®å‹ã«</h2>
<a href="https://readr.tidyverse.org/">
<img src="/slides/image/hex-stickers/readr.png" width="120" align="right">
</a>
<p>ã“ã‚Œã¯stringrã§ã¯ãªãreadrã®æ‹…å½“:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">parse_number</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;p = 0.02 *&#34;</span><span class="p">,</span> <span class="s">&#34;N_A = 6e23&#34;</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 2e-02 6e+23
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">parse_double</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;0.02&#34;</span><span class="p">,</span> <span class="s">&#34;6e+23&#34;</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 2e-02 6e+23
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">parse_logical</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;1&#34;</span><span class="p">,</span> <span class="s">&#34;true&#34;</span><span class="p">,</span> <span class="s">&#34;0&#34;</span><span class="p">,</span> <span class="s">&#34;false&#34;</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1]  TRUE  TRUE FALSE FALSE
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">parse_date</span><span class="p">(</span><span class="s">&#34;2020-06-03&#34;</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;2020-06-03&#34;
</code></pre><p><code>6e+23</code> ã¯ $6 \times 10 ^ {23}$ ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°çš„è¡¨ç¾ã€‚
$6e^{23}$ ã§ã¯ãªã„ã€‚</p>

</section>
<section>
<h2 id="å› å­å‹-factor">å› å­å‹ <code>factor</code></h2>
<p><strong>ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°</strong>(è³ªçš„å¤‰æ•°)ã‚’æ‰±ã†ãŸã‚ã®å‹ã€‚æ–‡å­—åˆ—ã£ã½ã„ã‘ã©<strong>å®Ÿä½“ã¯æ•´æ•°</strong>ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">month_levels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span>                       <span class="c1"># å–ã‚Šã†ã‚‹å€¤</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;Jan&#34;</span><span class="p">,</span> <span class="s">&#34;Feb&#34;</span><span class="p">,</span> <span class="s">&#34;Mar&#34;</span><span class="p">,</span> <span class="s">&#34;Apr&#34;</span><span class="p">,</span> <span class="s">&#34;May&#34;</span><span class="p">,</span> <span class="s">&#34;Jun&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s">&#34;Jul&#34;</span><span class="p">,</span> <span class="s">&#34;Aug&#34;</span><span class="p">,</span> <span class="s">&#34;Sep&#34;</span><span class="p">,</span> <span class="s">&#34;Oct&#34;</span><span class="p">,</span> <span class="s">&#34;Nov&#34;</span><span class="p">,</span> <span class="s">&#34;Dec&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">x1</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;Dec&#34;</span><span class="p">,</span> <span class="s">&#34;Apr&#34;</span><span class="p">,</span> <span class="s">&#34;Jan&#34;</span><span class="p">,</span> <span class="s">&#34;Mar&#34;</span><span class="p">)</span>      <span class="c1"># ãŸã ã®æ–‡å­—åˆ—vector</span>
</span></span><span class="line"><span class="cl"><span class="n">y1</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">month_levels</span><span class="p">)</span>  <span class="c1"># å› å­å‹ã«å¤‰æ›</span>
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] Dec Apr Jan Mar
Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">as.integer</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>                          <span class="c1"># æ•´æ•°å‹ã«å¤‰æ›å¯èƒ½</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 12  4  1  3
</code></pre><p>ğŸ”° <code>iris</code> ã«å«ã¾ã‚Œã‚‹å› å­å‹ã‚’ç¢ºèªã—ã‚ˆã†: <code>str(iris)</code></p>
<div style="text-align: right;"><a class="url" href="https://r4ds.had.co.nz/factors.html">
https://r4ds.had.co.nz/factors.html
</a></div>
</section>
<section>
<h2 id="å› å­å‹-factor-æ–‡å­—åˆ—ã¨ã®é•ã„1">å› å­å‹ <code>factor</code>: æ–‡å­—åˆ—ã¨ã®é•ã„1</h2>
<p>å–ã‚Šã†ã‚‹å€¤ (levels) ãŒæ—¢çŸ¥ã€‚</p>
<p>typoãªã©ã«ã‚ˆã‚Šlevelså¤–ã«ãªã‚‹ã¨ <code>NA</code> æ‰±ã„ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x2</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;Dec&#34;</span><span class="p">,</span> <span class="s">&#34;Apr&#34;</span><span class="p">,</span> <span class="s">&#34;Jam&#34;</span><span class="p">,</span> <span class="s">&#34;Mar&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">factor</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">month_levels</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] Dec  Apr  &lt;NA&gt; Mar 
Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
</code></pre><p>å…ƒã®æ–‡å­—åˆ—vectorã«å…¨ã¦ã®levelsãŒå«ã¾ã‚Œã¦ã‚‹ãªã‚‰ç°¡å˜ã«å¤‰æ›å¯èƒ½:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">as.factor</span><span class="p">(</span><span class="n">starwars[[</span><span class="s">&#34;gender&#34;</span><span class="n">]]</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code> [1] masculine masculine masculine masculine feminine  masculine feminine  masculine masculine masculine masculine masculine masculine masculine masculine masculine masculine masculine masculine masculine masculine masculine masculine masculine masculine masculine feminine  masculine masculine masculine masculine masculine masculine masculine masculine masculine &lt;NA&gt;      masculine masculine &lt;NA&gt;      feminine  masculine masculine feminine  masculine masculine masculine masculine masculine masculine masculine feminine  masculine masculine masculine masculine masculine feminine  masculine masculine feminine  feminine  feminine  masculine masculine masculine feminine  masculine masculine feminine  feminine  masculine feminine  masculine masculine feminine  masculine masculine masculine &lt;NA&gt;      masculine masculine feminine  masculine masculine &lt;NA&gt;      feminine 
Levels: feminine masculine
</code></pre>
</section>
<section>
<h2 id="å› å­å‹-factor-æ–‡å­—åˆ—ã¨ã®é•ã„2">å› å­å‹ <code>factor</code>: æ–‡å­—åˆ—ã¨ã®é•ã„2</h2>
<p>ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã˜ã‚ƒãªã„é †åºãŒã‚ã‚‹:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x1</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;Dec&#34;</span><span class="p">,</span> <span class="s">&#34;Apr&#34;</span><span class="p">,</span> <span class="s">&#34;Jan&#34;</span><span class="p">,</span> <span class="s">&#34;Mar&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">sort</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>     <span class="c1"># æ–‡å­—åˆ—ã¨ã—ã¦ã‚½ãƒ¼ãƒˆã™ã‚‹ã¨ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;Apr&#34; &#34;Dec&#34; &#34;Jan&#34; &#34;Mar&#34;
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">y1</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">month_levels</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">sort</span><span class="p">(</span><span class="n">y1</span><span class="p">)</span>     <span class="c1"># å› å­ã¨ã—ã¦ã‚½ãƒ¼ãƒˆã™ã‚‹ã¨levelsé †</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] Jan Mar Apr Dec
Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
</code></pre>
</section>
<section>
<h2 id="å› å­å‹-factor-é †åºã®æƒ…å ±ã¯ä½œå›³ã§ç”Ÿãã‚‹">å› å­å‹ <code>factor</code>: é †åºã®æƒ…å ±ã¯ä½œå›³ã§ç”Ÿãã‚‹</h2>
<p>æ–‡å­—åˆ—ã ã¨å‹æ‰‹ã«ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã€‚å› å­å‹ãªã‚‰ä»»æ„æŒ‡å®šå¯èƒ½:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">mpg_fct</span> <span class="o">=</span> <span class="n">mpg</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">drv</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="n">drv</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;f&#34;</span><span class="p">,</span> <span class="s">&#34;r&#34;</span><span class="p">,</span> <span class="s">&#34;4&#34;</span><span class="p">)))</span>
</span></span></code></pre></div><p><img src="figure/factor-plot-1.png" alt="plot of chunk factor-plot"></p>

</section>
<section>
<h2 id="é †åºã¤ãå› å­å‹-ordered">é †åºã¤ãå› å­å‹ <code>ordered</code></h2>
<p>å¤§å°ã®æ¯”è¼ƒãŒã§ãã‚‹ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">x1</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;Dec&#34;</span><span class="p">,</span> <span class="s">&#34;Apr&#34;</span><span class="p">,</span> <span class="s">&#34;Jan&#34;</span><span class="p">,</span> <span class="s">&#34;Mar&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">y3</span> <span class="o">=</span> <span class="nf">factor</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">month_levels</span><span class="p">,</span> <span class="n">ordered</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">class</span><span class="p">(</span><span class="n">y3</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;ordered&#34; &#34;factor&#34; 
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">y3</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] Dec Apr Jan Mar
Levels: Jan &lt; Feb &lt; Mar &lt; Apr &lt; May &lt; Jun &lt; Jul &lt; Aug &lt; Sep &lt; Oct &lt; Nov &lt; Dec
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">y3</span> <span class="o">&lt;</span> <span class="s">&#34;Sep&#34;</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] FALSE  TRUE  TRUE  TRUE
</code></pre><p>ğŸ”° <code>diamonds</code> ã«å«ã¾ã‚Œã‚‹orderedå‹ã‚’ç¢ºèªã—ã‚ˆã†: <code>str(diamonds)</code><br>
ğŸ”° <code>cut</code> ãŒPremiumä»¥ä¸Šã®è¡Œã ã‘æŠœãå‡ºã™ã€ã¨ã‹ã€‚</p>

</section>
<section>
<h2 id="tidyverse-ã®å› å­å‹æ‹…å½“ã¯-forcats">tidyverse ã®å› å­å‹æ‹…å½“ã¯ forcats</h2>
<a href="https://forcats.tidyverse.org/">
<img src="/slides/image/hex-stickers/forcats.png" width="120" align="right">
</a>
<ul>
<li><code>fct_relevel()</code>: æ‰‹å‹•ã§é †åºè¨­å®š</li>
<li><code>fct_reorder()</code>: åˆ¥ã®å¤‰æ•°ã«å¿œã˜ã¦é †åºã‚’ä¸¦ã¹æ›¿ãˆ</li>
<li><code>fct_infreq()</code>: é »åº¦ã«å¿œã˜ã¦é †åºã‚’ä¸¦ã¹æ›¿ãˆ</li>
<li><code>fct_lump()</code>: å°‘ãªã™ãã‚‹ã‚«ãƒ†ã‚´ãƒªã‚’&quot;ãã®ä»–&quot;ã¨ã—ã¦ã¾ã¨ã‚ã‚‹</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">diamonds_fct</span> <span class="o">=</span> <span class="n">diamonds</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="nf">fct_infreq</span><span class="p">(</span><span class="n">color</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">mpg_fct</span> <span class="o">=</span> <span class="n">mpg</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">fl</span> <span class="o">=</span> <span class="nf">fct_lump</span><span class="p">(</span><span class="n">fl</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="m">2</span><span class="p">))</span>
</span></span></code></pre></div><p><img src="figure/fct_infreq-1.png" alt="plot of chunk fct_infreq"></p>

</section>
<section>
<h2 id="factorã§é †åºã‚’å¤‰ãˆã¦ä½œå›³ã™ã‚‹ç·´ç¿’">factorã§é †åºã‚’å¤‰ãˆã¦ä½œå›³ã™ã‚‹ç·´ç¿’</h2>
<p>ğŸ”° <code>mpg</code> ã§æ¬¡ã®ã‚ˆã†ãªå›³ã‚’æã„ã¦ã¿ã‚ˆã†</p>
<p><img src="figure/plot-factor-1.png" alt="plot of chunk plot-factor"></p>

</section>
<section>
<h2 id="æŒ‡ç¤ºå¤‰æ•°ãƒ€ãƒŸãƒ¼å¤‰æ•°ã«å¤‰æ›">æŒ‡ç¤ºå¤‰æ•°(ãƒ€ãƒŸãƒ¼å¤‰æ•°)ã«å¤‰æ›</h2>
<p>ã‚¤ãƒã‚¼ãƒ­ã®å€¤ã‚’æŒãŸã›ã¦æ¨ªåºƒã«å¤‰å½¢ã™ã‚‹ã®ã¨ç­‰ä¾¡ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">iris</span> <span class="o">%&gt;%</span> <span class="nf">rowid_to_column</span><span class="p">()</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="m">1L</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">pivot_wider</span><span class="p">(</span><span class="n">names_from</span> <span class="o">=</span> <span class="n">Species</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="n">values_from</span> <span class="o">=</span> <span class="n">value</span><span class="p">,</span> <span class="n">values_fill</span> <span class="o">=</span> <span class="m">0L</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>    rowid Sepal.Length Sepal.Width Petal.Length Petal.Width setosa versicolor virginica
    &lt;int&gt;        &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt;     &lt;int&gt;
  1     1          5.1         3.5          1.4         0.2      1          0         0
  2     2          4.9         3.0          1.4         0.2      1          0         0
  3     3          4.7         3.2          1.3         0.2      1          0         0
  4     4          4.6         3.1          1.5         0.2      1          0         0
 --                                                                                    
147   147          6.3         2.5          5.0         1.9      0          0         1
148   148          6.5         3.0          5.2         2.0      0          0         1
149   149          6.2         3.4          5.4         2.3      0          0         1
150   150          5.9         3.0          5.1         1.8      0          0         1
</code></pre><p>ğŸ”° ã“ã‚Œã‚’å…ƒã® <code>iris</code> ã«æˆ»ã—ã¦ã¿ã‚ˆã†</p>

</section>
<section>
<h2 id="æ—¥æ™‚å‹-posixct-posixlt">æ—¥æ™‚å‹: POSIXct, POSIXlt</h2>
<ul>
<li>POSIXct: ã‚¨ãƒãƒƒã‚¯ã‹ã‚‰ã®çµŒéç§’æ•°ã€‚æ¯”è¼ƒã‚„å·®åˆ†ãªã©ã‚’å–ã‚Šã‚„ã™ã„ã€‚</li>
<li>POSIXlt: list(ç§’, åˆ†, æ™‚, æ—¥, æœˆ, å¹´, &hellip;)ã€‚å˜ä½ã”ã¨ã«æŠœãå‡ºã—ã‚„ã™ã„ã€‚</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">now</span> <span class="o">=</span> <span class="s">&#34;2021-09-15 11:00:00&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">ct</span> <span class="o">=</span> <span class="nf">as.POSIXct</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">unclass</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 1631671200
attr(,&#34;tzone&#34;)
[1] &#34;&#34;
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">lt</span> <span class="o">=</span> <span class="nf">as.POSIXlt</span><span class="p">(</span><span class="n">now</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">unclass</span><span class="p">(</span><span class="n">lt</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">as_tibble</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>    sec   min  hour  mday   mon  year  wday  yday isdst  zone gmtoff
  &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;int&gt;
1     0     0    11    15     8   121     3   257     0   JST     NA
</code></pre><p>ç´ ã®Rã§ã‚‚æ‰±ãˆã‚‹ã‘ã© lubridate ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†ã¨ã‚‚ã£ã¨æ¥½ã«ã€‚</p>

</section>
<section>
<h2 id="lubridate-----æ—¥æ™‚å‹å‡¦ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸">lubridate &mdash; æ—¥æ™‚å‹å‡¦ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸</h2>
<a href="https://lubridate.tidyverse.org/">
<img src="/slides/image/hex-stickers/lubridate.png" width="120" align="right">
</a>
<p>æ—¥æ™‚å‹ã¸ã®å¤‰æ›:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ymd</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s">&#34;20201017&#34;</span><span class="p">,</span> <span class="s">&#34;2020-10-17&#34;</span><span class="p">,</span> <span class="s">&#34;20/10/17&#34;</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] &#34;2020-10-17&#34; &#34;2020-10-17&#34; &#34;2020-10-17&#34;
</code></pre><p>æ—¥æ™‚å‹ã‹ã‚‰å˜ä½ã”ã¨ã«å€¤ã‚’å–å¾—:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">today</span> <span class="o">=</span> <span class="nf">ymd</span><span class="p">(</span><span class="m">20201017</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">month</span><span class="p">(</span><span class="n">today</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] 10
</code></pre><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">wday</span><span class="p">(</span><span class="n">today</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[1] Sat
Levels: Sun &lt; Mon &lt; Tue &lt; Wed &lt; Thu &lt; Fri &lt; Sat
</code></pre><p>ğŸ”° <a href="https://lubridate.tidyverse.org/">å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a>ãªã©ã‚’è¦‹ã¦ã„ã‚ã„ã‚ãªå¤‰æ›ãƒ»æŠ½å‡ºã‚’è©¦ã—ã¦ã¿ã‚ˆã†</p>

</section>
<section>
<h2 id="ãƒ‡ãƒ¼ã‚¿å†…å®¹ã‚’å¯¾è±¡ã¨ã™ã‚‹å‡¦ç†--ã¾ã¨ã‚">ãƒ‡ãƒ¼ã‚¿å†…å®¹ã‚’å¯¾è±¡ã¨ã™ã‚‹å‡¦ç† | ã¾ã¨ã‚</h2>
<div style="float: right;">
<a href="https://stringr.tidyverse.org/">
<img src="/slides/image/hex-stickers/stringr.png" width="120">
</a><br>
<a href="https://forcats.tidyverse.org/">
<img src="/slides/image/hex-stickers/forcats.png" width="120">
</a><br>
<a href="https://lubridate.tidyverse.org/">
<img src="/slides/image/hex-stickers/lubridate.png" width="120">
</a><br>
</div>
<ul>
<li>æ­£è¦åŒ–ãƒ»æ¬ æå€¤å‡¦ç†ã¯ç›®çš„ã«å¿œã˜ã¦æ¤œè¨</li>
<li>vectorã«ã¯<strong>å‹</strong>ãŒã‚ã‚‹: æ–‡å­—åˆ—ã€æ•°å€¤ã€å› å­ã€æ—¥æ™‚ã€etc.</li>
<li>æ–‡å­—åˆ—ã‚’æ‰±ã†ã«ã¯ <a href="https://stringr.tidyverse.org/">stringr</a>
<ul>
<li><strong>æ­£è¦è¡¨ç¾</strong>ã¯ä¸€åº¦ç¿’å¾—ã™ã‚Œã°è¶…å¼·åŠ›</li>
</ul>
</li>
<li>å› å­ã‚’æ‰±ã†ã«ã¯ <a href="https://forcats.tidyverse.org/">forcats</a>
<ul>
<li>çŸ¥ã£ã¦ãŠãã¨ãŸã¾ã«ä¾¿åˆ©ã€‚è‹¦æ‰‹ãªã‚‰å…¨éƒ¨æ–‡å­—åˆ—ã«ã—ã¦ã‚‚ã„ã„ã€‚</li>
</ul>
</li>
<li>æ—¥æ™‚ã‚’æ‰±ã†ã«ã¯ <a href="https://lubridate.tidyverse.org/">lubridate</a></li>
</ul>
<p>å„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®<a href="https://www.rstudio.com/resources/cheatsheets/">ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ.pdf</a>ã‚’æ‰‹å…ƒã«æŒã£ã¦ãŠãã¨ä¾¿åˆ©ã€‚
</section>
<section>
<h2 id="å‰å‡¦ç†ã«å¿…è¦ãªé“å…·ã¯ã ã„ãŸã„æƒã£ãŸ">å‰å‡¦ç†ã«å¿…è¦ãªé“å…·ã¯ã ã„ãŸã„æƒã£ãŸ</h2>
<div style="float: right;">
<a href="https://dplyr.tidyverse.org/">
<img src="/slides/image/hex-stickers/dplyr.png" width="120">
</a><br>
<a href="https://tidyr.tidyverse.org/">
<img src="/slides/image/hex-stickers/tidyr.png" width="120">
</a><br>
<a href="https://stringr.tidyverse.org/">
<img src="/slides/image/hex-stickers/stringr.png" width="120">
</a>
</div>
<ul>
<li>ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å¯¾è±¡ã¨ã™ã‚‹å‡¦ç† â€” ç¬¬3, 4å›
<ul>
<li>ä½¿ã„ãŸã„éƒ¨åˆ†ã ã‘æŠ½å‡º &mdash; <code>select()</code>, <code>filter()</code></li>
<li>ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã«ç‰¹å¾´ã‚’è¦ç´„ &mdash; <code>group_by()</code>, <code>summarize()</code></li>
<li>ä½•ã‹ã®é †ã«ä¸¦ã¹æ›¿ãˆ &mdash; <code>arrange()</code></li>
<li>ç•°ãªã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã®çµåˆ &mdash; <code>*_join()</code></li>
<li>å¤‰å½¢: ç¸¦é•· â†” æ¨ªåºƒ &mdash; <code>pivot_longer()</code>, <code>pivot_wider()</code></li>
</ul>
</li>
<li><strong>ãƒ‡ãƒ¼ã‚¿å†…å®¹ã‚’å¯¾è±¡ã¨ã™ã‚‹å‡¦ç†</strong> â€” ğŸ‘ˆ ç¬¬5å› æœ¬æ—¥ã®è©±é¡Œ
<ul>
<li>æ•°å€¤ã®å¤‰æ›: å¯¾æ•°ã€æ­£è¦åŒ–</li>
<li>å¤–ã‚Œå€¤ãƒ»æ¬ æå€¤ã¸ã®å¯¾å‡¦</li>
<li>å‹å¤‰æ›: é€£ç¶šå¤‰æ•°ã€ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã€æŒ‡ç¤ºå¤‰æ•°ã€å› å­ã€æ—¥æ™‚</li>
<li>æ–‡å­—åˆ—å‡¦ç†: æ­£è¦è¡¨ç¾ã«ã‚ˆã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒ</li>
</ul>
</li>
</ul>
<p><cite style="display: block; text-align: right;"><a href="https://www.amazon.co.jp/dp/4774196479/ref=as_li_ss_tl?ie=UTF8&linkCode=ll1&tag=heavywatal-22&linkId=8a3fd4e9a0c944b1b41242bbab8d147b">
æœ¬æ©‹æ™ºå…‰ã€Œå‰å‡¦ç†å¤§å…¨ã€
</a></cite>
</section>
<section>
<h2 id="çµ±è¨ˆè§£æã®ä¸€æ­©æ‰‹å‰ã¾ã§ãªã‚‰è¡Œã‘ã‚‹">çµ±è¨ˆè§£æã®ä¸€æ­©æ‰‹å‰ã¾ã§ãªã‚‰è¡Œã‘ã‚‹</h2>
<ol>
<li>ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ç’°å¢ƒã®æ•´å‚™</li>
<li>ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã€èª­ã¿è¾¼ã¿</li>
<li>æ¢ç´¢çš„ãƒ‡ãƒ¼ã‚¿è§£æ
<ul>
<li><strong>å‰å‡¦ç†ã€åŠ å·¥</strong> (åœ°å‘³ã€‚æ„å¤–ã¨é‡ã„) ğŸ‘ˆ æœ¬å®Ÿç¿’ã®ä¸»é¡Œ</li>
<li>å¯è¦–åŒ–ã€ä»®èª¬ç”Ÿæˆ (æ´¾æ‰‹ï¼ã ã„ã˜ï¼)</li>
<li>çµ±è¨ˆè§£æã€ä»®èª¬æ¤œè¨¼ (ã¿ã‚“ãªå‹‰å¼·ã—ãŸãŒã‚‹)</li>
</ul>
</li>
<li>å ±å‘Šã€ç™ºè¡¨</li>
</ol>
<figure>
<a href="https://r4ds.had.co.nz/introduction.html">
<img src="/slides/image/r4ds/data-science.png">
<figcaption class="url">https://r4ds.had.co.nz/introduction.html</figcaption>
</a>
</figure>

</section>
<section>
<h2 id="-3æ—¥ç›®ã®èª²é¡Œ1-å¥½ããªãƒ‡ãƒ¼ã‚¿ã‚’ã„ã˜ãã‚Šå€’ã—ã¦ã¿ã‚ˆã†">ğŸ”° 3æ—¥ç›®ã®èª²é¡Œ1: å¥½ããªãƒ‡ãƒ¼ã‚¿ã‚’ã„ã˜ãã‚Šå€’ã—ã¦ã¿ã‚ˆã†</h2>
<ul>
<li>è‡ªåˆ†ãŒã“ã‚Œã‹ã‚‰è§£æã—ãŸã„ãƒ‡ãƒ¼ã‚¿ (ã‚‚ã—æ‰‹å…ƒã«ã‚ã‚Œã°)</li>
<li>ä½•ã‹é©å½“ãªãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã€‚ä¾‹ãˆã°:
<ul>
<li><a href="https://www.e-stat.go.jp/">e-Stat</a>: æ”¿åºœçµ±è¨ˆã®ç·åˆçª“å£</li>
<li><a href="https://www.data.go.jp/data/dataset?res_format=CSV">data.go.jp ãƒ‡ãƒ¼ã‚¿ã‚«ã‚¿ãƒ­ã‚°ã‚µã‚¤ãƒˆ</a>: ä¸­å¤®çœåº</li>
<li><a href="https://odcs.bodik.jp/">BODIKã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚«ã‚¿ãƒ­ã‚°ã‚µã‚¤ãƒˆ</a>: åœ°æ–¹è‡ªæ²»ä½“</li>
<li><a href="https://www.data.jma.go.jp/gmd/risk/obsdl/index.php">æ°—è±¡åº</a></li>
<li><a href="https://www.data.gov/">DATA.GOV</a>: U.S. Governmentâ€™s open data</li>
</ul>
</li>
<li>(è‹¦è‚‰ã®ç­–) Rã‚„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ä»˜å±ã®ãƒ‡ãƒ¼ã‚¿
<ul>
<li><code>diamonds</code>, <code>starwars</code>, <code>mpg</code>, etc. See <code>data()</code></li>
</ul>
</li>
</ul>
<dl>
<dt>ç™ºè¡¨ãƒ»ãƒ¬ãƒãƒ¼ãƒˆã®æ¡ä»¶</dt>
<dd>æœ€ä½1æšã®å›³ã¨ã€ãã“ã«è‡³ã‚‹å‰å‡¦ç†ï¼‹å¯è¦–åŒ–ã®ã‚³ãƒ¼ãƒ‰ã€‚</dd>
<dd>ã‚°ãƒ©ãƒ•ã‹ã‚‰èª­ã¿å–ã‚Œã‚‹ã“ã¨ã‚’ä¸€è¨€ã€‚</dd>
</dl>

</section>
<section>
<h2 id="å®Ÿæ¼”-ç›®é»’åŒºã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿httpsodcsbodikjp131105">å®Ÿæ¼”: <a href="https://odcs.bodik.jp/131105/">ç›®é»’åŒºã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿</a></h2>
<p><a href="https://data.bodik.jp/organization/968e265c-d998-4475-8abf-7e8a53f81595?res_format=CSV&amp;groups=gr_0200">ç”ºä¸åˆ¥ãƒ»å¹´é½¢åˆ¥ãƒ»ç”·å¥³åˆ¥äººå£&hellip;</a>
ã®æœ€æ–°CSVã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€èª­ã¿è¾¼ã¿</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">infile</span> <span class="o">=</span> <span class="s">&#34;131105_population_20211001.csv&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">raw_meguro</span> <span class="o">=</span> <span class="n">readr</span><span class="o">::</span><span class="nf">read_csv</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nf">print</span><span class="p">(</span><span class="n">raw_meguro</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>   éƒ½é“åºœçœŒã‚³ãƒ¼ãƒ‰åˆã¯å¸‚åŒºç”ºæ‘ã‚³ãƒ¼ãƒ‰ åœ°åŸŸã‚³ãƒ¼ãƒ‰ éƒ½é“åºœçœŒå å¸‚åŒºç”ºæ‘å èª¿æŸ»å¹´æœˆæ—¥       åœ°åŸŸå ç·äººå£  ç”·æ€§  å¥³æ€§ 0-4æ­³ã®ç”·æ€§ 0-4æ­³ã®å¥³æ€§ 5-9æ­³ã®ç”·æ€§ 5-9æ­³ã®å¥³æ€§ 10-14æ­³ã®ç”·æ€§ 10-14æ­³ã®å¥³æ€§ 15-19æ­³ã®ç”·æ€§ 15-19æ­³ã®å¥³æ€§ 20-24æ­³ã®ç”·æ€§ 20-24æ­³ã®å¥³æ€§ 25-29æ­³ã®ç”·æ€§ 25-29æ­³ã®å¥³æ€§ 30-34æ­³ã®ç”·æ€§ 30-34æ­³ã®å¥³æ€§ 35-39æ­³ã®ç”·æ€§ 35-39æ­³ã®å¥³æ€§ 40-44æ­³ã®ç”·æ€§ 40-44æ­³ã®å¥³æ€§ 45-49æ­³ã®ç”·æ€§ 45-49æ­³ã®å¥³æ€§ 50-54æ­³ã®ç”·æ€§ 50-54æ­³ã®å¥³æ€§ 55-59æ­³ã®ç”·æ€§ 55-59æ­³ã®å¥³æ€§ 60-64æ­³ã®ç”·æ€§ 60-64æ­³ã®å¥³æ€§ 65-69æ­³ã®ç”·æ€§ 65-69æ­³ã®å¥³æ€§ 70-74æ­³ã®ç”·æ€§ 70-74æ­³ã®å¥³æ€§ 75-79æ­³ã®ç”·æ€§ 75-79æ­³ã®å¥³æ€§ 80-84æ­³ã®ç”·æ€§ 80-84æ­³ã®å¥³æ€§ 85æ­³ä»¥ä¸Šã®ç”·æ€§ 85æ­³ä»¥ä¸Šã®å¥³æ€§ ä¸è©³è€…ã®ç”·æ€§ ä¸è©³è€…ã®å¥³æ€§ ä¸–å¸¯æ•°  å‚™è€ƒ    KEY_CODE
                              &lt;dbl&gt;      &lt;dbl&gt;      &lt;chr&gt;      &lt;chr&gt;     &lt;date&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;  &lt;dbl&gt; &lt;lgl&gt;       &lt;dbl&gt;
 1                           131105        111     æ±äº¬éƒ½     ç›®é»’åŒº 2021-10-01   é§’å ´ä¸€ä¸ç›®   4095  2108  1987          69          59          76          68            76            66            68            52           167           129           226           173           221           136           172           149           184           144           177           185           146           144           111           110            74            91            76            95           110           118            57            94            48            62             50            112            0            0   2487    NA 13110001001
 2                           131105        112     æ±äº¬éƒ½     ç›®é»’åŒº 2021-10-01   é§’å ´äºŒä¸ç›®    556   270   286           5           7          10           5            10             9            18            14            18            17            26            25            18            16            21            16            18            16            19            23            19            23            16            15            18            16             7            12            16            22            13            16            10            11              8             23            0            0    332    NA 13110001002
 3                           131105        113     æ±äº¬éƒ½     ç›®é»’åŒº 2021-10-01   é§’å ´ä¸‰ä¸ç›®    872   429   443          10          17          15          17            18            18            18            14            25            23            36            26            28            23            32            33            27            27            41            45            39            43            31            28            24            21            18            20            22            31            19            23            10            14             16             20            0            0    479    NA 13110001003
 4                           131105        114     æ±äº¬éƒ½     ç›®é»’åŒº 2021-10-01   é§’å ´å››ä¸ç›®   1258   581   677          13          14          26          27            38            21            37            30            34            42            36            29            37            47            30            34            48            61            55            63            47            66            37            58            32            29            27            32            32            48            23            26            13            18             16             32            0            0    666    NA 13110001004
--                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
85                           131105        364     æ±äº¬éƒ½     ç›®é»’åŒº 2021-10-01   å…«é›²å››ä¸ç›®   2089   969  1120          30          34          47          44            56            54            44            44            51            44            64            57            43            60            52            66            70           104            98           110            88           101            84            82            49            56            43            56            60            65            37            50            21            38             32             55            0            0    991    NA 13110026004
86                           131105        365     æ±äº¬éƒ½     ç›®é»’åŒº 2021-10-01   å…«é›²äº”ä¸ç›®   2851  1370  1481          73          53          79          58            81            71            59            68            78            61            74            75            82            98            96           118           128           127           102           130           112           116           103           113            83            95            60            63            69            63            30            61            31            43             30             68            0            0   1343    NA 13110026005
87                           131105        371     æ±äº¬éƒ½     ç›®é»’åŒº 2021-10-01 æ±ãŒä¸˜ä¸€ä¸ç›®   4476  2092  2384         105          79         112         102           118            99           111            92           104           142           116           138           125           155           150           176           179           203           187           195           173           194           148           174           112           129            94            90            98           119            69            82            45            73             46            142            0            0   2215    NA 13110027001
88                           131105        372     æ±äº¬éƒ½     ç›®é»’åŒº 2021-10-01 æ±ãŒä¸˜äºŒä¸ç›®   3114  1360  1754          65          62          66          54            59            48            40            49            88           200           140           218           119           162           108           150            99           121           112           111            90           122            97           101            80            76            53            57            40            74            42            47            35            40             27             62            0            0   1796    NA 13110027002
</code></pre>
</section>
<section>
<h2 id="å®Ÿæ¼”-ç›®é»’åŒºã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿">å®Ÿæ¼”: ç›®é»’åŒºã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿</h2>
<p>ggplotã—ãŸããªã‚‹å½¢ã«å¤‰å½¢ã€‚1è¡Œãšã¤çµŒéã‚’ç¢ºèªã—ã‚ˆã†ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">tidy_meguro</span> <span class="o">=</span> <span class="n">raw_meguro</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">select</span><span class="p">(</span><span class="s">&#34;åœ°åŸŸå&#34;</span><span class="p">,</span> <span class="nf">matches</span><span class="p">(</span><span class="s">&#34;ã®.+æ€§$&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">rename</span><span class="p">(</span><span class="n">place</span> <span class="o">=</span> åœ°åŸŸå<span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">place</span> <span class="o">=</span> <span class="nf">str_remove</span><span class="p">(</span><span class="n">place</span><span class="p">,</span> <span class="s">&#34;\\Sä¸ç›®&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">group_by</span><span class="p">(</span><span class="n">place</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">summarize</span><span class="p">(</span><span class="nf">across</span><span class="p">(</span><span class="nf">everything</span><span class="p">(),</span> <span class="n">sum</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">ungroup</span><span class="p">()</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">pivot_longer</span><span class="p">(</span><span class="o">!</span><span class="n">place</span><span class="p">,</span> <span class="n">names_to</span> <span class="o">=</span> <span class="s">&#34;category&#34;</span><span class="p">,</span> <span class="n">values_to</span> <span class="o">=</span> <span class="s">&#34;count&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">separate</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;age&#34;</span><span class="p">,</span> <span class="s">&#34;sex&#34;</span><span class="p">),</span> <span class="n">sep</span> <span class="o">=</span> <span class="s">&#34;ã®&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">mutate</span><span class="p">(</span><span class="n">age</span> <span class="o">=</span> <span class="nf">as.integer</span><span class="p">(</span><span class="nf">str_extract</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="s">&#34;^\\d+&#34;</span><span class="p">)))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">filter</span><span class="p">(</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">age</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>    place   age   sex count
    &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;
  1  ä¸‰ç”°     0  ç”·æ€§    92
  2  ä¸‰ç”°     0  å¥³æ€§    84
  3  ä¸‰ç”°     5  ç”·æ€§    98
  4  ä¸‰ç”°     5  å¥³æ€§    93
 --                        
969  é·¹ç•ª    80  ç”·æ€§   113
970  é·¹ç•ª    80  å¥³æ€§   182
971  é·¹ç•ª    85  ç”·æ€§   126
972  é·¹ç•ª    85  å¥³æ€§   276
</code></pre>
</section>
<section>
<h2 id="å®Ÿæ¼”-ç›®é»’åŒºã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿">å®Ÿæ¼”: ç›®é»’åŒºã‚ªãƒ¼ãƒ—ãƒ³ãƒ‡ãƒ¼ã‚¿</h2>
<p>ä½œå›³ã—ã¦ã¿ã‚‹</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">tidy_meguro</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_col</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="n">sex</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">facet_wrap</span><span class="p">(</span><span class="nf">vars</span><span class="p">(</span><span class="n">place</span><span class="p">),</span> <span class="n">nrow</span> <span class="o">=</span> <span class="m">3L</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_bw</span><span class="p">(</span><span class="n">base_family</span> <span class="o">=</span> <span class="s">&#34;HiraginoSans-W3&#34;</span><span class="p">)</span> <span class="c1"># æ—¥æœ¬èªã¯é¬¼é–€</span>
</span></span></code></pre></div><p><img src="figure/meguro_plot-1.png" alt="plot of chunk meguro_plot"></p>

</section>
<section>
<h2 id="å®Ÿæ¼”-e-stat-å›½å‹¢èª¿æŸ»2015httpswwwe-statgojpgisstatmap-searchpage1type1toukeicode00200521-å®®åŸçœŒ">å®Ÿæ¼”: <a href="https://www.e-stat.go.jp/gis/statmap-search?page=1&amp;type=1&amp;toukeiCode=00200521">e-Stat å›½å‹¢èª¿æŸ»2015</a> (å®®åŸçœŒ)</h2>
<p>æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒå¤ã„ã€‚åˆ—åãŒ2è¡Œã«ã¾ãŸãŒã£ã¦ã‚‹ã€‚æ•°å€¤ã®åˆ—ã«å¤‰ãªæ–‡å­—ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">infile</span> <span class="o">=</span> <span class="s">&#34;tblT000849C04.txt&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">sjis</span> <span class="o">=</span> <span class="nf">locale</span><span class="p">(</span><span class="n">encoding</span> <span class="o">=</span> <span class="s">&#34;SJIS&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># readr::read_csv(infile, locale = sjis)</span>
</span></span><span class="line"><span class="cl"><span class="n">miyagi_L</span> <span class="o">=</span> <span class="n">readr</span><span class="o">::</span><span class="nf">read_csv</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">locale</span> <span class="o">=</span> <span class="n">sjis</span><span class="p">,</span> <span class="n">col_select</span> <span class="o">=</span> <span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">7</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">slice</span><span class="p">(</span><span class="m">-1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">miyagi_R</span> <span class="o">=</span> <span class="n">readr</span><span class="o">::</span><span class="nf">read_csv</span><span class="p">(</span><span class="n">infile</span><span class="p">,</span> <span class="n">locale</span> <span class="o">=</span> <span class="n">sjis</span><span class="p">,</span> <span class="n">col_select</span> <span class="o">=</span> <span class="o">-</span><span class="nf">seq</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">7</span><span class="p">),</span> <span class="n">skip</span> <span class="o">=</span> <span class="m">1L</span><span class="p">,</span> <span class="n">na</span> <span class="o">=</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;-&#34;</span><span class="p">,</span> <span class="s">&#34;X&#34;</span><span class="p">),</span> <span class="n">name_repair</span> <span class="o">=</span> <span class="s">&#34;minimal&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">raw_miyagi</span> <span class="o">=</span> <span class="nf">bind_cols</span><span class="p">(</span><span class="n">miyagi_L</span><span class="p">,</span> <span class="n">miyagi_R</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">print</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>        KEY_CODE HYOSYO       CITYNAME         NAME HTKSYORI HTKSAKI GASSAN ç·æ•°ã€å¹´é½¢ã€Œä¸è©³ã€å«ã‚€ ã€€ç·æ•°ï¼ã€œï¼”æ­³ ã€€ç·æ•°ï¼•ã€œï¼™æ­³ ã€€ç·æ•°ï¼‘ï¼ã€œï¼‘ï¼”æ­³ ã€€ç·æ•°ï¼‘ï¼•ã€œï¼‘ï¼™æ­³ ã€€ç·æ•°ï¼’ï¼ã€œï¼’ï¼”æ­³ ã€€ç·æ•°ï¼’ï¼•ã€œï¼’ï¼™æ­³ ã€€ç·æ•°ï¼“ï¼ã€œï¼“ï¼”æ­³ ã€€ç·æ•°ï¼“ï¼•ã€œï¼“ï¼™æ­³ ã€€ç·æ•°ï¼”ï¼ã€œï¼”ï¼”æ­³ ã€€ç·æ•°ï¼”ï¼•ã€œï¼”ï¼™æ­³ ã€€ç·æ•°ï¼•ï¼ã€œï¼•ï¼”æ­³ ã€€ç·æ•°ï¼•ï¼•ã€œï¼•ï¼™æ­³ ã€€ç·æ•°ï¼–ï¼ã€œï¼–ï¼”æ­³ ã€€ç·æ•°ï¼–ï¼•ã€œï¼–ï¼™æ­³ ã€€ç·æ•°ï¼—ï¼ã€œï¼—ï¼”æ­³ ã€€ç·æ•°ï¼‘ï¼•æ­³æœªæº€ ã€€ç·æ•°ï¼‘ï¼•ã€œï¼–ï¼”æ­³ ã€€ç·æ•°ï¼–ï¼•æ­³ä»¥ä¸Š ã€€ç·æ•°ï¼—ï¼•æ­³ä»¥ä¸Š ç”·ã®ç·æ•°ã€å¹´é½¢ã€Œä¸è©³ã€å«ã‚€ ã€€ç”·ï¼ã€œï¼”æ­³ ã€€ç”·ï¼•ã€œï¼™æ­³ ã€€ç”·ï¼‘ï¼ã€œï¼‘ï¼”æ­³ ã€€ç”·ï¼‘ï¼•ã€œï¼‘ï¼™æ­³ ã€€ç”·ï¼’ï¼ã€œï¼’ï¼”æ­³ ã€€ç”·ï¼’ï¼•ã€œï¼’ï¼™æ­³ ã€€ç”·ï¼“ï¼ã€œï¼“ï¼”æ­³ ã€€ç”·ï¼“ï¼•ã€œï¼“ï¼™æ­³ ã€€ç”·ï¼”ï¼ã€œï¼”ï¼”æ­³ ã€€ç”·ï¼”ï¼•ã€œï¼”ï¼™æ­³ ã€€ç”·ï¼•ï¼ã€œï¼•ï¼”æ­³ ã€€ç”·ï¼•ï¼•ã€œï¼•ï¼™æ­³ ã€€ç”·ï¼–ï¼ã€œï¼–ï¼”æ­³ ã€€ç”·ï¼–ï¼•ã€œï¼–ï¼™æ­³ ã€€ç”·ï¼—ï¼ã€œï¼—ï¼”æ­³ ã€€ç”·ï¼‘ï¼•æ­³æœªæº€ ã€€ç”·ï¼‘ï¼•ã€œï¼–ï¼”æ­³ ã€€ç”·ï¼–ï¼•æ­³ä»¥ä¸Š ã€€ç”·ï¼—ï¼•æ­³ä»¥ä¸Š å¥³ã®ç·æ•°ã€å¹´é½¢ã€Œä¸è©³ã€å«ã‚€ ã€€å¥³ï¼ã€œï¼”æ­³ ã€€å¥³ï¼•ã€œï¼™æ­³ ã€€å¥³ï¼‘ï¼ã€œï¼‘ï¼”æ­³ ã€€å¥³ï¼‘ï¼•ã€œï¼‘ï¼™æ­³ ã€€å¥³ï¼’ï¼ã€œï¼’ï¼”æ­³ ã€€å¥³ï¼’ï¼•ã€œï¼’ï¼™æ­³ ã€€å¥³ï¼“ï¼ã€œï¼“ï¼”æ­³ ã€€å¥³ï¼“ï¼•ã€œï¼“ï¼™æ­³ ã€€å¥³ï¼”ï¼ã€œï¼”ï¼”æ­³ ã€€å¥³ï¼”ï¼•ã€œï¼”ï¼™æ­³ ã€€å¥³ï¼•ï¼ã€œï¼•ï¼”æ­³ ã€€å¥³ï¼•ï¼•ã€œï¼•ï¼™æ­³ ã€€å¥³ï¼–ï¼ã€œï¼–ï¼”æ­³ ã€€å¥³ï¼–ï¼•ã€œï¼–ï¼™æ­³ ã€€å¥³ï¼—ï¼ã€œï¼—ï¼”æ­³ ã€€å¥³ï¼‘ï¼•æ­³æœªæº€ ã€€å¥³ï¼‘ï¼•ã€œï¼–ï¼”æ­³ ã€€å¥³ï¼–ï¼•æ­³ä»¥ä¸Š ã€€å¥³ï¼—ï¼•æ­³ä»¥ä¸Š
           &lt;chr&gt;  &lt;dbl&gt;          &lt;chr&gt;        &lt;chr&gt;    &lt;dbl&gt;   &lt;chr&gt;  &lt;chr&gt;                  &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;              &lt;dbl&gt;            &lt;dbl&gt;              &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;                      &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;                      &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;          &lt;dbl&gt;          &lt;dbl&gt;
   1       04101      1   ä»™å°å¸‚é’è‘‰åŒº         &lt;NA&gt;        0    &lt;NA&gt;   &lt;NA&gt;                 310183          11107          11396              11605              16730              25517              20314              19691              20935              23107              20324              18759              17648              18731              19288              14488            34108             201756            66000            32224                     150535         5691         5819             5997             8641            13205            10180             9578            10244            11460            10204             9424             8525             8999             9058             6607          17507           100460          27716          12051                     159648         5416         5577             5608             8089            12312            10134            10113            10691            11647            10120             9335             9123             9732            10230             7881          16601           101296          38284          20173
   2   041010010      2   ä»™å°å¸‚é’è‘‰åŒº       é’è‘‰ç”º        0    &lt;NA&gt;   &lt;NA&gt;                    697             22             20                 21                 26                 50                 87                 58                 43                 41                 58                 30                 34                 49                 38                 30               63                476              145               77                        319           11            9                9               12               23               43               32               18               14               29               14               13               20               17               14             29              218             62             31                        378           11           11               12               14               27               44               26               25               27               29               16               21               29               21               16             34              258             83             46
   3   041010020      2   ä»™å°å¸‚é’è‘‰åŒº   ã‚ã‘ã¼ã®ç”º        0    &lt;NA&gt;   &lt;NA&gt;                    798             22             18                 16                 35                 60                 77                 59                 61                 58                 47                 44                 33                 55                 50                 46               56                529              201              105                        394           15            8               11               19               26               39               26               36               35               25               16               18               27               29               22             34              267             88             37                        404            7           10                5               16               34               38               33               25               23               22               28               15               28               21               24             22              262            113             68
   4   041010030      2   ä»™å°å¸‚é’è‘‰åŒº       æ—­ã‚±ä¸˜        0    &lt;NA&gt;   &lt;NA&gt;                   8958            245            260                258                347                824                939                771                662                731                597                505                451                414                407                322              763               6241             1780             1051                       4239          139          131              139              174              335              439              357              316              361              308              251              236              198              197              142            409             2975            741            402                       4719          106          129              119              173              489              500              414              346              370              289              254              215              216              210              180            354             3266           1039            649
  --                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
5880 04606004015      3 æœ¬å‰éƒ¡å—ä¸‰é™¸ç”º   æ­Œæ´¥å­—çŸ³æµœ        0    &lt;NA&gt;   &lt;NA&gt;                    242              5              9                  7                  7                  8                  6                 11                 11                 15                 17                 26                 18                 26                 21                 18               21                145               76               37                        122            3            5                3                4                5                2                6                5                8               12               12                8               12               15                6             11               74             37             16                        120            2            4                4                3                3                4                5                6                7                5               14               10               14                6               12             10               71             39             21
5881 04606004016      3 æœ¬å‰éƒ¡å—ä¸‰é™¸ç”º æ­Œæ´¥å­—ç”°ã®æµ¦        0    &lt;NA&gt;   &lt;NA&gt;                    181              4              4                  4                 10                  8                 11                 13                  5                  4                 15                 13                 22                 17                  5                  8               12                118               51               38                         86            1            2                3                6                4                6                7                2                3                5                5               12               11                5                2              6               61             19             12                         95            3            2                1                4                4                5                6                3                1               10                8               10                6               NA                6              6               57             32             26
5882 04606004017      3 æœ¬å‰éƒ¡å—ä¸‰é™¸ç”º æ­Œæ´¥å­—è‰æœ¨æ²¢        0    &lt;NA&gt;   &lt;NA&gt;                    466             14             17                 22                 18                 17                 25                 28                 16                 40                 29                 21                 33                 49                 39                 34               53                276              137               64                        246            6            7               10               12                6               14               18               12               21               16               12               18               22               26               17             23              151             72             29                        220            8           10               12                6               11               11               10                4               19               13                9               15               27               13               17             30              125             65             35
5883 04606004018      3 æœ¬å‰éƒ¡å—ä¸‰é™¸ç”º æ­Œæ´¥å­—ä¼Šé‡Œå‰        0    &lt;NA&gt;   &lt;NA&gt;                     NA             NA             NA                 NA                 NA                 NA                 NA                 NA                 NA                 NA                 NA                 NA                 NA                 NA                 NA                 NA               NA                 NA               NA               NA                         NA           NA           NA               NA               NA               NA               NA               NA               NA               NA               NA               NA               NA               NA               NA               NA             NA               NA             NA             NA                         NA           NA           NA               NA               NA               NA               NA               NA               NA               NA               NA               NA               NA               NA               NA               NA             NA               NA             NA             NA
</code></pre>
</section>
<section>
<h2 id="å®Ÿæ¼”-e-stat-å›½å‹¢èª¿æŸ»2015-å®®åŸçœŒ">å®Ÿæ¼”: e-Stat å›½å‹¢èª¿æŸ»2015 (å®®åŸçœŒ)</h2>
<p>ã¾ã ç½ ãŒãŸãã•ã‚“: åˆ—åã®é ­ã«ã‚¹ãƒšãƒ¼ã‚¹ã€‚å…¨è§’æ•°å­—ã€‚å¤‰ãªåŒºåˆ†ã€‚</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="n">tidy_miyagi</span> <span class="o">=</span> <span class="n">raw_miyagi</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">filter</span><span class="p">(</span><span class="n">HYOSYO</span> <span class="o">==</span> <span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">select</span><span class="p">(</span><span class="n">CITYNAME</span><span class="p">,</span> <span class="nf">matches</span><span class="p">(</span><span class="s">&#34;[ç”·å¥³].+[æ­³ä¸Š]$&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="n">tidyr</span><span class="o">::</span><span class="nf">pivot_longer</span><span class="p">(</span><span class="o">!</span><span class="n">CITYNAME</span><span class="p">,</span> <span class="n">names_to</span> <span class="o">=</span> <span class="s">&#34;category&#34;</span><span class="p">,</span> <span class="n">values_to</span> <span class="o">=</span> <span class="s">&#34;count&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">mutate</span><span class="p">(</span><span class="n">category</span> <span class="o">=</span> <span class="nf">str_trim</span><span class="p">(</span><span class="n">category</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="n">tidyr</span><span class="o">::</span><span class="nf">separate</span><span class="p">(</span><span class="n">category</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;sex&#34;</span><span class="p">,</span> <span class="s">&#34;age&#34;</span><span class="p">),</span> <span class="m">1</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">mutate</span><span class="p">(</span><span class="n">age</span> <span class="o">=</span> <span class="n">stringi</span><span class="o">::</span><span class="nf">stri_trans_nfkc</span><span class="p">(</span><span class="n">age</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="n">tidyr</span><span class="o">::</span><span class="nf">separate</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="nf">c</span><span class="p">(</span><span class="s">&#34;lower&#34;</span><span class="p">,</span> <span class="s">&#34;upper&#34;</span><span class="p">),</span> <span class="s">&#34;ã€œ&#34;</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span> <span class="s">&#34;right&#34;</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">mutate</span><span class="p">(</span><span class="n">lower</span> <span class="o">=</span> <span class="nf">parse_number</span><span class="p">(</span><span class="n">lower</span><span class="p">),</span> <span class="n">upper</span> <span class="o">=</span> <span class="nf">parse_number</span><span class="p">(</span><span class="n">upper</span><span class="p">))</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">filter</span><span class="p">((</span><span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span><span class="p">)</span> <span class="o">&lt;</span> <span class="m">5</span> <span class="o">|</span> <span class="n">lower</span> <span class="o">==</span> <span class="m">75</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="n">dplyr</span><span class="o">::</span><span class="nf">rename</span><span class="p">(</span><span class="n">age</span> <span class="o">=</span> <span class="n">lower</span><span class="p">)</span> <span class="o">%&gt;%</span>
</span></span><span class="line"><span class="cl">  <span class="nf">print</span><span class="p">()</span>
</span></span></code></pre></div><pre tabindex="0"><code>           CITYNAME   sex   age upper count
              &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
   1   ä»™å°å¸‚é’è‘‰åŒº    ç”·     0     4  5691
   2   ä»™å°å¸‚é’è‘‰åŒº    ç”·     5     9  5819
   3   ä»™å°å¸‚é’è‘‰åŒº    ç”·    10    14  5997
   4   ä»™å°å¸‚é’è‘‰åŒº    ç”·    15    19  8641
  --                                       
1245 æœ¬å‰éƒ¡å—ä¸‰é™¸ç”º    å¥³    60    64   519
1246 æœ¬å‰éƒ¡å—ä¸‰é™¸ç”º    å¥³    65    69   442
1247 æœ¬å‰éƒ¡å—ä¸‰é™¸ç”º    å¥³    70    74   381
1248 æœ¬å‰éƒ¡å—ä¸‰é™¸ç”º    å¥³    75    NA  1487
</code></pre>
</section>
<section>
<h2 id="å®Ÿæ¼”-e-stat-å›½å‹¢èª¿æŸ»2015-å®®åŸçœŒ">å®Ÿæ¼”: e-Stat å›½å‹¢èª¿æŸ»2015 (å®®åŸçœŒ)</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-r" data-lang="r"><span class="line"><span class="cl"><span class="nf">ggplot</span><span class="p">(</span><span class="n">tidy_miyagi</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">aes</span><span class="p">(</span><span class="n">age</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">geom_col</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">fill</span> <span class="o">=</span> <span class="n">sex</span><span class="p">))</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">facet_wrap</span><span class="p">(</span><span class="nf">vars</span><span class="p">(</span><span class="n">CITYNAME</span><span class="p">),</span> <span class="n">ncol</span> <span class="o">=</span> <span class="m">8L</span><span class="p">)</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">  <span class="nf">theme_minimal</span><span class="p">(</span><span class="n">base_family</span> <span class="o">=</span> <span class="s">&#34;HiraginoSans-W3&#34;</span><span class="p">,</span> <span class="n">base_size</span> <span class="o">=</span> <span class="m">14</span><span class="p">)</span>
</span></span></code></pre></div><p><img src="figure/estat_plot-1.png" alt="plot of chunk estat_plot"></p>

</section>
<section>
<h2 id="reference">Reference</h2>
<dl>
<dt>R for Data Science &mdash; Hadley Wickham and Garrett Grolemund</dt>
<dd><a href="https://r4ds.had.co.nz/">https://r4ds.had.co.nz/</a>,
<a href="https://amzn.to/2tbRmVc">Paperback</a>,
<a href="https://amzn.to/2yyFRKt">æ—¥æœ¬èªç‰ˆæ›¸ç±</a></dd>
</dl>
<p><a href="https://www.amazon.co.jp/dp/4774196479/ref=as_li_ss_tl?ie=UTF8&amp;linkCode=ll1&amp;tag=heavywatal-22&amp;linkId=8a3fd4e9a0c944b1b41242bbab8d147b">å‰å‡¦ç†å¤§å…¨ &mdash; æœ¬æ©‹æ™ºå…‰</a><br>
<a href="https://amzn.to/2Yy5LND">Rãƒ¦ãƒ¼ã‚¶ã®ãŸã‚ã®RStudio[å®Ÿè·µ]å…¥é–€ (å®‡å®™èˆ¹æœ¬) &mdash; æ¾æ‘ã‚‰</a></p>
<dl>
<dt>Official documents:</dt>
<dd><a href="https://www.tidyverse.org/">tidyverse</a>,
<a href="https://dplyr.tidyverse.org/">dplyr</a>,
<a href="https://tidyr.tidyverse.org/">tidyr</a>,
<a href="https://stringr.tidyverse.org/">stringr</a>,
<a href="https://forcats.tidyverse.org/">forcats</a>,
<a href="https://lubridate.tidyverse.org/">lubridate</a></dd>
<dt>Older versions</dt>
<dd>ã€Œ<a href="https://heavywatal.github.io/slides/nagoya2018/">Rã«ã‚„ã‚‰ã›ã¦æ¥½ã—ã‚ˆã† â€” ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–ã¨ä¸‹ã”ã—ã‚‰ãˆ</a>ã€
å²©åµœèˆª 2018</dd>
<dd>ã€ŒRã‚’ç”¨ã„ãŸãƒ‡ãƒ¼ã‚¿è§£æã®åŸºç¤ã¨å¿œç”¨ã€çŸ³å·ç”±å¸Œ 2019 åå¤å±‹å¤§å­¦</dd>
<dd>ã€Œ<a href="https://heavywatal.github.io/slides/tmd2020/">Rã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†å®Ÿç¿’</a>ã€
å²©åµœèˆª 2020 æ±äº¬åŒ»ç§‘æ­¯ç§‘å¤§</dd>
<dd>ã€Œ<a href="https://comicalcommet.github.io/r-training-2021/">Rã‚’ç”¨ã„ãŸãƒ‡ãƒ¼ã‚¿è§£æã®åŸºç¤ã¨å¿œç”¨</a>ã€
çŸ³å·ç”±å¸Œ 2021 åå¤å±‹å¤§å­¦</dd>
</dl>
<a href="6-distribution.html" rel="next" class="readmore">
6. çµ±è¨ˆãƒ¢ãƒ‡ãƒªãƒ³ã‚°1: ç¢ºç‡åˆ†å¸ƒã€å°¤åº¦
</a>

</section>
</div>
</div>
<script src="/slides/lib/reveal.js/reveal.js"></script>
<script src="/slides/lib/reveal.js/plugin/notes.js"></script>
<script>
Reveal.initialize({
  width: 960,
  height: 720,
  margin: 0,
  controls: true,
  controlsLayout: 'bottom-right',
  controlsTutorial: false,
  controlsBackArrows: 'faded',
  progress: false,
  slideNumber: 'c/t',
  showSlideNumber: 'all',
  hashOneBasedIndex: true,
  hash: true,
  history: false,
  keyboard: true,
  overview: true,
  center: false,
  touch: true,
  loop: false,
  rtl: false,
  navigationMode: 'linear',
  shuffle: false,
  fragments: true,
  fragmentInURL: true,
  embedded: false,
  help: true,
  showNotes: false,
  autoPlayMedia: null,
  preloadIframes: null,
  mouseWheel: false,
  previewLinks: false,
  transition: 'none',
  transitionSpeed: 'fast',
  backgroundTransition: 'none',
  pdfMaxPagesPerSlide: 1,
  pdfSeparateFragments: false,
  viewDistance: 2,
  plugins: [ RevealNotes ]
});
</script>
<script>
{
const reload_all_img = function() {
  const imgs = document.getElementsByTagName("img");
  for (let i = 0; i < imgs.length; ++i) {
    const src = imgs[i].src;
    imgs[i].src += "?q";
    imgs[i].src = src;
  }
};
const reload_src_element = function(ev) {
  const original_src = ev.srcElement.src;
  ev.srcElement.src += "?q";
  ev.srcElement.src = original_src;
};
const reload_src = function(ev) {
  if (ev.shiftKey || ev.metaKey || ev.altKey) {
    reload_all_img();
  } else {
    reload_src_element(ev);
  }
};
const img_elements = document.getElementsByTagName("img");
for (let i = 0; i < img_elements.length; ++i) {
  img_elements[i].onclick = reload_src;
}
};
</script>
</body>
</html>
