+++
title = "統計モデリング概論 DSHC 2022"
date = 2022-08-17T09:30:00+09:00
draft = false
unlisted = false
+++

[東京海上 Data Science Hill Climb](https://tokiomarine-dshc.com/)

- 講師: 岩嵜航 (東北大学生命科学研究科)
- 日程: 2022-08-17&24 09:30--17:30
- 場所: zoom.us

```{r schedule, echo = FALSE, fig.width = 5.5, fig.height = 5.5, dev="svg"}
library(ggplot2)

day_start = lubridate::ymd_hms("2022-08-17 09:30:00")
day_end = day_start + lubridate::hours("8")
.breaks = day_start - lubridate::minutes(30) + lubridate::hours(seq(0, 9))

csv_text = "label,run,rest,day
導入,25,5,1
直線回帰+可視化,50,10,1
確率分布,39,1,1
擬似乱数,20,60,1
尤度、最尤推定,40,10,1
GLM説明、可視化,40,10,1
モデル評価,40,10,1
GLM練習,40,10,1
個体差、GLMM,60,0,1
ベイズの定理、事後分布,40,10,2
MCMC、Stan,40,10,2
Stanで直線回帰,50,60,2
Stanでポアソン回帰,30,10,2
Stanでロジスティック回帰,30,10,2
Stanで重回帰,60,10,2
階層モデル,60,5,2
階層モデル練習,30,0,2
"

df_raw = readr::read_csv(csv_text, show_col_types = FALSE)
df = df_raw |>
  dplyr::group_by(day) |>
  dplyr::mutate(elapsed = dplyr::lag(cumsum(run + rest), 1L, default = 0)) |>
  dplyr::mutate(run = lubridate::minutes(run), elapsed = lubridate::minutes(elapsed)) |>
  dplyr::mutate(start = day_start + elapsed, end = start + run)

ggplot(df) +
  aes(1, start) +
  geom_segment(aes(xend = 1, yend = end), size = 3, alpha = 0.6) +
  geom_text(aes(label = label), hjust = 0, nudge_x = 0.05, nudge_y = 500,
            family = "Hiragino Sans W3", size = 4.2) +
  facet_grid(cols = vars(day), labeller = label_both) +
  scale_x_continuous(breaks = 1) +
  scale_y_datetime(breaks = .breaks, date_labels = "%H:%M") +
  coord_cartesian(xlim = c(1, 2), ylim = c(day_end, day_start)) +
  theme_minimal(base_size = 16) +
  theme(panel.grid.minor.x = element_blank(),
    axis.title = element_blank(),
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank(),
    strip.text = element_text(hjust = 0))
```

## 実行環境の準備

DSHC 2022 参加者はほかの講義で使っている環境をなるべくそのまま使う。
いくつかのパッケージを追加するため
[`preparation.ipynb`](./preparation.ipynb) をダウンロードして実行。

ほかの講義を受講していない私が追いつくために実行したコマンド
(macOSに講義用の仮想環境を用意する一例として):
```sh
brew install pyenv
env PYTHON_CONFIGURE_OPTS="--enable-shared" pyenv install 3.7.13
# Rscript -e 'reticulate::install_python("3.7.13")'
$(pyenv prefix 3.7.13)/bin/python3 -m venv ~/.virtualenvs/dshc2022
source ~/.virtualenvs/dshc2022/bin/activate
pip3 install -U setuptools pip wheel
pip3 install -r requirements.txt
# matplotlib==3.0.3 is too old (macosx backend requires Framework)
pip3 install -U "matplotlib>=3.1"
jupyter-notebook preparation.ipynb
```

DSHC 2022 に参加せずこの資料に辿り着いた人はわざわざ古い3.7を入れる必要はない。
最新版(≥3.10)をインストールする。
`requirements.txt` の代わりに個別指定で
`pip3 install -U seaborn scikit-learn jupyter`
を実行する。


## 演習資料

- [`preparation.ipynb`](./preparation.ipynb)
- [`2-stats-model.ipynb`](./2-stats-model.ipynb)
- [`3-glm.ipynb`](./3-glm.ipynb)
- [`4-bayesian.ipynb`](4-bayesian.ipynb)
- [`5-stan-glm.ipynb`](5-stan-glm.ipynb)
- [`6-stan-hbm.ipynb`](6-stan-hbm.ipynb)


## 講義資料

リンク先では<kbd>←</kbd><kbd>→</kbd>キーで戻る・進む。
