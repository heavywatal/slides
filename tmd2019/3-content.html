<!DOCTYPE html>
<html>
<head prefix="og: http://ogp.me/ns#">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<title>3. ãƒ‡ãƒ¼ã‚¿å†…å®¹ã®å‡¦ç† â€” Rã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†å®Ÿç¿’ 2019</title>
<link rel="stylesheet" href="/slides/reveal.js/css/reveal.css">
<link rel="stylesheet" href="/slides/css/theme-reveal.css">
<meta name="author" content="Watal M. Iwasaki">
<meta property="og:title" content="3. ãƒ‡ãƒ¼ã‚¿å†…å®¹ã®å‡¦ç† â€” Rã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†å®Ÿç¿’ 2019">
<meta property="og:type" content="article">
<meta property="og:url" content="https://heavywatal.github.io/slides/tmd2019/3-content.html">
<meta property="og:image" content="https://avatars.githubusercontent.com/heavywatal">
<meta property="og:description" content="">
<meta property="og:site_name" content="Slide decks â€” Heavy Watal">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@heavywatal">
<meta name="twitter:creator" content="@heavywatal">
<meta name="generator" content="Hugo 0.56.0-DEV" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js" integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
<script>
document.addEventListener("DOMContentLoaded", function() {
  renderMathInElement(document.body, {
    delimiters: [
      {left: "\\[", right: "\\]", display: true},
      {left: "$", right: "$", display: false}
    ]
  });
});
</script>
<style>
.katex {
  font-size: 1.12em;
}

.katex-display > .katex {
  text-align: left;
  padding-left: 2rem;
}
</style>

<script defer src="https://use.fontawesome.com/releases/v5.8.2/js/all.js" integrity="sha384-DJ25uNYET2XCl5ZF++U8eNxPWqcKohUUBUpKGlNLMchM7q4Wjg2CUpjHLaL8yYPH" crossorigin="anonymous"></script>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-41178626-2', 'auto');
	
	ga('send', 'pageview');
}
</script>

</head>
<body>
<div class="reveal">
<div class="slides">
<section>
<h1 id="rã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†å®Ÿç¿’"><a href=".">Rã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†å®Ÿç¿’</a></h1>

<div class="author">
å²©åµœ èˆª (Watal M. Iwasaki, PhD)
</div>

<div class="affiliation">
æ±åŒ—å¤§å­¦ ç”Ÿå‘½ç§‘å­¦ç ”ç©¶ç§‘ é€²åŒ–ã‚²ãƒãƒŸã‚¯ã‚¹åˆ†é‡ ç‰¹ä»»åŠ©æ•™<br>
(Graduate School of Life Sciences, Tohoku University)
</div>

<ol>
<li><a href="1-introduction.html">å…¥é–€: å‰å‡¦ç†ã¨ã¯ã€‚Rã‚’ä½¿ã†ãƒ¡ãƒªãƒƒãƒˆã€‚Rã®åŸºæœ¬</a>
<li><a href="2-structure.html">ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®å‡¦ç†: æŠ½å‡ºã€é›†ç´„ã€çµåˆã€å¤‰å½¢ãªã©</a>
<li class="current-deck"><a href="3-content.html">ãƒ‡ãƒ¼ã‚¿å†…å®¹ã®å‡¦ç†: æ•°å€¤ã€æ–‡å­—åˆ—ã€æ—¥æ™‚ãªã©</a>
<li><a href="4-practice.html">å®Ÿè·µ: ç¾å®Ÿã®å•é¡Œã«å¯¾å‡¦ã—ã¦ã¿ã‚‹</a>
</ol>

<div class="footnote">
2019-12-27 æ±äº¬åŒ»ç§‘æ­¯ç§‘å¤§å­¦ M&Dã‚¿ãƒ¯ãƒ¼ æƒ…å ±æ¤œç´¢å®¤1
</div>
</section>
<section>
<h2 id="rä½œæ¥­ã‚’å†é–‹ã™ã‚‹">Rä½œæ¥­ã‚’å†é–‹ã™ã‚‹</h2>

<ul>
<li>å‰å›ä½œã£ãŸ <code>***.Rproj</code> ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¦RStudioèµ·å‹•ã€‚<br>
ã‚‚ã—ãã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æ–°è¦ä½œæˆã€‚</li>
<li>Rã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ–°è¦ä½œæˆã€åå‰ã‚’ä»˜ã‘ã¦ä¿å­˜ã€‚</li>
<li><code>getwd()</code>: ç¾åœ¨åœ°ã‚’ç¢ºèªã€‚</li>
<li><code>library()</code>: ä½¿ã„ãŸã„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã‚€ã€‚</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kp">getwd</span><span class="p">()</span>
<span class="c1"># install.packages(&#34;tidyverse&#34;)</span>
<span class="kn">library</span><span class="p">(</span>tidyverse<span class="p">)</span></code></pre></div>
</section>
<section>
<h2 id="å‰å‡¦ç†ã¯å¤§ãã2ã¤ã«åˆ†ã‘ã‚‰ã‚Œã‚‹">å‰å‡¦ç†ã¯å¤§ãã2ã¤ã«åˆ†ã‘ã‚‰ã‚Œã‚‹</h2>

<ul>
<li>ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å¯¾è±¡ã¨ã™ã‚‹å‡¦ç† (<a href="2-structure.html">å‰å›ã®ä¸»é¡Œ</a>)

<ul>
<li>ä½¿ã„ãŸã„éƒ¨åˆ†ã ã‘æŠ½å‡º &mdash; <code>select()</code>, <code>filter()</code></li>
<li>ã‚°ãƒ«ãƒ¼ãƒ—ã”ã¨ã«ç‰¹å¾´ã‚’è¦ç´„ &mdash; <code>group_by()</code>, <code>summarize()</code></li>
<li>å¤§ãã„é †ã«ä¸¦ã¹æ›¿ãˆ &mdash; <code>arrange()</code></li>
<li>ç•°ãªã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã®çµåˆ &mdash; <code>*_join()</code></li>
<li>å¤‰å½¢: ç¸¦é•· â†” æ¨ªåºƒ &mdash; <code>pivot_longer()</code>, <code>pivot_wider()</code></li>
</ul></li>
<li><strong>ãƒ‡ãƒ¼ã‚¿å†…å®¹ã‚’å¯¾è±¡ã¨ã™ã‚‹å‡¦ç†</strong> (ğŸ‘ˆä»Šå›ã®ä¸»é¡Œ)

<ul>
<li>æ•°å€¤ã‚’å¤‰æ›ã™ã‚‹ (e.g., å¯¾æ•°ã€åº§æ¨™ç³»)</li>
<li>å¤‰æ›: é€£ç¶šå¤‰æ•° â†” ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•° â†” ãƒ€ãƒŸãƒ¼å¤‰æ•°</li>
<li>æ¬ æå€¤ <code>NA</code> ã«å¯¾å‡¦</li>
<li>æ–‡å­—åˆ—ã‹ã‚‰æ•°å€¤ã‚„æ—¥æ™‚ã‚’æŠœãå‡ºã™</li>
</ul></li>
</ul>
</section>
<section>
<h2 id="å¤‰æ•°-ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å‹-å…ˆé€±ã®ãŠã•ã‚‰ã„">å¤‰æ•°/ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å‹ (å…ˆé€±ã®ãŠã•ã‚‰ã„)</h2>

<ul>
<li><code>NULL</code>: ç©ºã£ã½</li>
<li><strong>vector: åŸºæœ¬å‹ã€‚ä¸€æ¬¡å…ƒã®é…åˆ—ã€‚</strong> (ğŸ‘ˆä»Šå›ã®ä¸»å½¹)

<ul>
<li>logical: è«–ç†å€¤ (<code>TRUE</code> or <code>FALSE</code>)</li>
<li>numeric: æ•°å€¤ (æ•´æ•° <code>42L</code> or å®Ÿæ•° <code>3.1416</code>)</li>
<li>character: æ–‡å­—åˆ— (<code>&quot;historgram.png&quot;</code>)</li>
<li>factor: å› å­ (æ–‡å­—åˆ—ã£ã½ã„ã‘ã©å¾®å¦™ã«é•ã†)</li>
<li>â†‘ãã‚Œãã‚Œã«æ¬ æå€¤ <code>NA</code> ã‚‚å®šç¾©ã•ã‚Œã¦ã‚‹</li>
</ul></li>
<li>matrix: äºŒæ¬¡å…ƒã®è¡Œåˆ—ã€‚vectoråŒæ§˜ã€å…¨è¦ç´ ãŒåŒã˜å‹ã€‚</li>
<li>list: ç•°ãªã‚‹å‹ã§ã‚‚è©°ã‚è¾¼ã‚ã‚‹å¤ªã£è…¹ãƒ™ã‚¯ãƒˆãƒ«ã€‚</li>
<li>data.frame: åŒã˜é•·ã•ã®ãƒ™ã‚¯ãƒˆãƒ«ã‚’ä¸¦ã¹ãŸé•·æ–¹å½¢ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã€‚é‡è¦ã€‚<br>
<strong>tibble</strong> ã¨ã‹ <strong>tbl_df</strong> ã¨å‘¼ã°ã‚Œã‚‹äºœç¨®ã‚‚ã‚ã‚‹ã‘ã©ã»ã¼åŒã˜ã€‚</li>
</ul>
</section>
<section>
<h2 id="vector-ä¸€æ¬¡å…ƒã®é…åˆ—-å…ˆé€±ã®ãŠã•ã‚‰ã„">vector: ä¸€æ¬¡å…ƒã®é…åˆ— (å…ˆé€±ã®ãŠã•ã‚‰ã„)</h2>

<p>1å€‹ã®å€¤ã§ã‚‚ãƒ™ã‚¯ãƒˆãƒ«æ‰±ã„ã€‚<br>
ãƒ™ã‚¯ãƒˆãƒ«ã®å„è¦ç´ ã«ä¸€æ°—ã«è¨ˆç®—ã‚’é©ç”¨ã§ãã‚‹ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">x <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">9</span><span class="p">)</span>  <span class="c1"># é•·ã•3ã®æ•°å€¤ãƒ™ã‚¯ãƒˆãƒ«</span>
x <span class="o">+</span> x           <span class="c1"># åŒã˜é•·ã•åŒå£«ã®è¨ˆç®—</span></code></pre></div>
<pre><code>[1]  2  4 18
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">y <span class="o">=</span> <span class="m">10</span>          <span class="c1"># é•·ã•1ã®æ•°å€¤ãƒ™ã‚¯ãƒˆãƒ«</span>
x <span class="o">+</span> y           <span class="c1"># é•·ã•3 + é•·ã•1 = é•·ã•3 (ãã‚Œãã‚Œè¶³ã—ç®—)</span></code></pre></div>
<pre><code>[1] 11 12 19
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kp">sqrt</span><span class="p">(</span>x<span class="p">)</span>         <span class="c1"># square root</span></code></pre></div>
<pre><code>[1] 1.000000 1.414214 3.000000
</code></pre>

</section>
<section>
<h2 id="data-frameã¯åˆ—vectorã®é›†ã¾ã‚Š">data.frameã¯åˆ—vectorã®é›†ã¾ã‚Š</h2>

<p><a href="https://tibble.tidyverse.org/">
<img src="/slides/figure/rstats/hex-tibble.png" width="120" align="right">
</a></p>

<p>å†…å®¹ã‚’å¤‰æ›´ã™ã‚‹æ–¹æ³•ã¯ã„ãã¤ã‹ã‚ã‚‹ã€‚<br>
<code>diamonds[[&quot;price&quot;]]</code> ã‚’ãƒ‰ãƒ«ã‹ã‚‰å††ã«å¤‰æ›ã™ã‚‹ä¾‹:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">dia <span class="o">=</span> diamonds    <span class="c1"># åˆ¥åã‚³ãƒ”ãƒ¼</span>

<span class="c1"># dollaræ¼”ç®—å­ã§æŒ‡å®š</span>
dia<span class="o">$</span>price <span class="o">=</span> <span class="m">109.58</span> <span class="o">*</span> dia<span class="o">$</span>price

<span class="c1"># åå‰ã‚’æ–‡å­—åˆ—ã§æŒ‡å®š</span>
dia<span class="p">[[</span><span class="s">&#34;price&#34;</span><span class="p">]]</span> <span class="o">=</span> <span class="m">109.58</span> <span class="o">*</span> dia<span class="p">[[</span><span class="s">&#34;price&#34;</span><span class="p">]]</span>

<span class="c1"># dplyr::mutate with pipe</span>
dia <span class="o">=</span> diamonds <span class="o">%&gt;%</span>
  mutate<span class="p">(</span>price <span class="o">=</span> <span class="m">109.58</span> <span class="o">*</span> price<span class="p">)</span></code></pre></div>
<p>1ç™ºãªã‚‰ã©ã‚Œã§ã‚‚ã„ã„ã€‚æµã‚Œä½œæ¥­ã«ã¯ <code>mutate()</code> ãŒä¾¿åˆ©ã€‚</p>

</section>
<section>
<h2 id="æ•°å€¤-numericå‹">æ•°å€¤: numericå‹</h2>

<p>æ™®é€šã¯å€ç²¾åº¦æµ®å‹•å°æ•°ç‚¹å‹ <code>double</code> ã¨ã—ã¦æ‰±ã‚ã‚Œã‚‹:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">answer <span class="o">=</span> <span class="m">42</span>
<span class="kp">typeof</span><span class="p">(</span>answer<span class="p">)</span></code></pre></div>
<pre><code>[1] &quot;double&quot;
</code></pre>

<p>æ˜ç¤ºçš„ã«å¤‰æ›ã—ãŸã‚Šæœ«å°¾ã«Lã‚’ä»˜ã‘ã‚‹ã“ã¨ã§æ•´æ•°æ‰±ã„ã‚‚ã§ãã‚‹:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kp">typeof</span><span class="p">(</span><span class="kp">as.integer</span><span class="p">(</span>answer<span class="p">))</span></code></pre></div>
<pre><code>[1] &quot;integer&quot;
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">whoami <span class="o">=</span> <span class="m">24601L</span>
<span class="kp">typeof</span><span class="p">(</span>whoami<span class="p">)</span></code></pre></div>
<pre><code>[1] &quot;integer&quot;
</code></pre>

</section>
<section>
<h2 id="æ§˜ã€…ãªæ•°å­¦é–¢æ•°">æ§˜ã€…ãªæ•°å­¦é–¢æ•°</h2>

<p>ãƒ™ã‚¯ãƒˆãƒ«ã‚’å—ã‘å–ã‚Šã€ãã‚Œãã‚Œã®è¦ç´ ã«é©ç”¨</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">x <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">)</span>
<span class="kp">sqrt</span><span class="p">(</span>x<span class="p">)</span></code></pre></div>
<pre><code>[1] 1.000000 1.414214 1.732051
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kp">log</span><span class="p">(</span>x<span class="p">)</span></code></pre></div>
<pre><code>[1] 0.0000000 0.6931472 1.0986123
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kp">log10</span><span class="p">(</span>x<span class="p">)</span></code></pre></div>
<pre><code>[1] 0.0000000 0.3010300 0.4771213
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kp">exp</span><span class="p">(</span>x<span class="p">)</span></code></pre></div>
<pre><code>[1]  2.718282  7.389056 20.085537
</code></pre>

<div class="url">
<a href="https://stat.ethz.ch/R-manual/R-patched/library/base/html/00Index.html">
https://stat.ethz.ch/R-manual/R-patched/library/base/html/00Index.html
</a></div>

</section>
<section>
<h2 id="æ­£è¦åŒ–-z-score-normalization">æ­£è¦åŒ– (z-score normalization)</h2>

<p>å¹³å‡=0ã€æ¨™æº–åå·®=1ã€ã«ãªã‚‹ã‚ˆã†ã«:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">result <span class="o">=</span> diamonds <span class="o">%&gt;%</span>
  mutate<span class="p">(</span>depth <span class="o">=</span> <span class="kp">scale</span><span class="p">(</span>depth<span class="p">))</span> <span class="o">%&gt;%</span>
  <span class="kp">print</span><span class="p">()</span></code></pre></div>
<pre><code>      carat       cut color clarity            table price     x     y     z
      &lt;dbl&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt;   &lt;matrix&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
    1  0.23     Ideal     E     SI2 -0.1740899    55   326  3.95  3.98  2.43
    2  0.21   Premium     E     SI1 -1.3607259    61   326  3.89  3.84  2.31
    3  0.23      Good     E     VS1 -3.3849872    65   327  4.05  4.07  2.31
    4  0.29   Premium     I     VS2  0.4541292    58   334  4.20  4.23  2.63
   --                                                                       
53937  0.72      Good     D     SI1  0.9427440    55  2757  5.69  5.75  3.61
53938  0.70 Very Good     D     SI1  0.7333376    60  2757  5.66  5.68  3.56
53939  0.86   Premium     H     SI2 -0.5231005    58  2757  6.15  6.12  3.74
53940  0.75     Ideal     D     SI2  0.3145249    55  2757  5.83  5.87  3.64
</code></pre>

<p><code>depth = (depth - mean(depth)) / sd(depth)</code> ã¨åŒã˜ã€‚</p>

</section>
<section>
<h2 id="æ­£è¦åŒ–-min-max-normalization">æ­£è¦åŒ– (min-max normalization)</h2>

<p>æœ€å°=0ã€æœ€å¤§=1ã€ã«ãªã‚‹ã‚ˆã†ã«:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">result <span class="o">=</span> diamonds <span class="o">%&gt;%</span>
  mutate<span class="p">(</span>depth <span class="o">=</span> <span class="p">(</span>depth <span class="o">-</span> <span class="kp">min</span><span class="p">(</span>depth<span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="kp">max</span><span class="p">(</span>depth<span class="p">)</span> <span class="o">-</span> <span class="kp">min</span><span class="p">(</span>depth<span class="p">)))</span> <span class="o">%&gt;%</span>
  <span class="kp">print</span><span class="p">()</span></code></pre></div>
<pre><code>      carat       cut color clarity     depth table price     x     y     z
      &lt;dbl&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
    1  0.23     Ideal     E     SI2 0.5138889    55   326  3.95  3.98  2.43
    2  0.21   Premium     E     SI1 0.4666667    61   326  3.89  3.84  2.31
    3  0.23      Good     E     VS1 0.3861111    65   327  4.05  4.07  2.31
    4  0.29   Premium     I     VS2 0.5388889    58   334  4.20  4.23  2.63
   --                                                                      
53937  0.72      Good     D     SI1 0.5583333    55  2757  5.69  5.75  3.61
53938  0.70 Very Good     D     SI1 0.5500000    60  2757  5.66  5.68  3.56
53939  0.86   Premium     H     SI2 0.5000000    58  2757  6.15  6.12  3.74
53940  0.75     Ideal     D     SI2 0.5333333    55  2757  5.83  5.87  3.64
</code></pre>

<p>å¤–ã‚Œå€¤ã®å½±éŸ¿ã‚’å¤§ããå—ã‘ã‚‹ã“ã¨ã«æ³¨æ„ã€‚</p>

</section>
<section>
<h2 id="å¤–ã‚Œå€¤ã®é™¤å»">å¤–ã‚Œå€¤ã®é™¤å»</h2>

<p>å¹³å‡å€¤ã‹ã‚‰æ¨™æº–åå·®ã®3å€ä»¥ä¸Šé›¢ã‚Œã¦ã„ã‚‹ã‚‚ã®ã‚’å–ã‚Šé™¤ãä¾‹:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">result <span class="o">=</span> diamonds <span class="o">%&gt;%</span>
  filter<span class="p">(</span><span class="kp">abs</span><span class="p">(</span>depth <span class="o">-</span> <span class="kp">mean</span><span class="p">(</span>depth<span class="p">))</span> <span class="o">/</span> sd<span class="p">(</span>depth<span class="p">)</span> <span class="o">&lt;</span> <span class="m">3</span><span class="p">)</span> <span class="o">%&gt;%</span>
  <span class="kp">print</span><span class="p">()</span></code></pre></div>
<pre><code>      carat       cut color clarity depth table price     x     y     z
      &lt;dbl&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
    1  0.23     Ideal     E     SI2  61.5    55   326  3.95  3.98  2.43
    2  0.21   Premium     E     SI1  59.8    61   326  3.89  3.84  2.31
    3  0.29   Premium     I     VS2  62.4    58   334  4.20  4.23  2.63
    4  0.31      Good     J     SI2  63.3    58   335  4.34  4.35  2.75
   --                                                                  
53252  0.72      Good     D     SI1  63.1    55  2757  5.69  5.75  3.61
53253  0.70 Very Good     D     SI1  62.8    60  2757  5.66  5.68  3.56
53254  0.86   Premium     H     SI2  61.0    58  2757  6.15  6.12  3.74
53255  0.75     Ideal     D     SI2  62.2    55  2757  5.83  5.87  3.64
</code></pre>

<p>å”¯ä¸€ã®æ–¹æ³•ã§ã¯ãªã„ã—ã€ãã‚‚ãã‚‚ã‚„ã‚‹ã¹ãã‹ã©ã†ã‹ã‚‚è¦æ¤œè¨</p>

</section>
<section>
<h2 id="æ¬ æå€¤ã®é™¤å»-tidyr-drop-na">æ¬ æå€¤ã®é™¤å» <code>tidyr::drop_na()</code></h2>

<p>(æŒ‡å®šã—ãŸåˆ—ã«) <code>NA</code> ãŒå«ã¾ã‚Œã¦ã‚‹è¡Œã‚’å‰Šé™¤ã™ã‚‹ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">df <span class="o">=</span> tibble<span class="p">(</span>x <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kc">NA</span><span class="p">),</span> y <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;a&#34;</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="s">&#34;b&#34;</span><span class="p">))</span>
df <span class="o">%&gt;%</span> drop_na<span class="p">()</span></code></pre></div>
<pre><code>      x     y
  &lt;dbl&gt; &lt;chr&gt;
1     1     a
</code></pre>

<p>å•: <code>starwars</code> ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§è©¦ã—ã¦ã¿ã‚ˆã†</p>

<pre><code>             name height  mass hair_color  skin_color eye_color birth_year
            &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;      &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;
 1 Luke Skywalker    172    77      blond        fair      blue       19.0
 2          C-3PO    167    75       &lt;NA&gt;        gold    yellow      112.0
 3          R2-D2     96    32       &lt;NA&gt; white, blue       red       33.0
 4    Darth Vader    202   136       none       white    yellow       41.9
--                                                                        
84    Poe Dameron     NA    NA      brown       light     brown         NA
85            BB8     NA    NA       none        none     black         NA
86 Captain Phasma     NA    NA    unknown     unknown   unknown         NA
87  PadmÃ© Amidala    165    45      brown       light     brown       46.0
   gender homeworld species     films  vehicles starships
    &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;list&gt;    &lt;list&gt;    &lt;list&gt;
 1   male  Tatooine   Human &lt;chr [5]&gt; &lt;chr [2]&gt; &lt;chr [2]&gt;
 2   &lt;NA&gt;  Tatooine   Droid &lt;chr [6]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 3   &lt;NA&gt;     Naboo   Droid &lt;chr [7]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 4   male  Tatooine   Human &lt;chr [4]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
--                                                       
84   male      &lt;NA&gt;   Human &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
85   none      &lt;NA&gt;   Droid &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
86 female      &lt;NA&gt;    &lt;NA&gt; &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
87 female     Naboo   Human &lt;chr [3]&gt; &lt;chr [0]&gt; &lt;chr [3]&gt;
</code></pre>

</section>
<section>
<h2 id="æ¬ æå€¤ã®è£œå®Œ-tidyr-replace-na">æ¬ æå€¤ã®è£œå®Œ <code>tidyr::replace_na()</code></h2>

<p>æ¬ æå€¤ <code>NA</code> ã‚’ä»»æ„ã®å€¤ã§ç½®ãæ›ãˆã‚‹ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">df <span class="o">=</span> tibble<span class="p">(</span>x <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kc">NA</span><span class="p">),</span> y <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;a&#34;</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="s">&#34;b&#34;</span><span class="p">))</span>
df <span class="o">%&gt;%</span> replace_na<span class="p">(</span><span class="kt">list</span><span class="p">(</span>x <span class="o">=</span> <span class="m">0</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&#34;unknown&#34;</span><span class="p">))</span></code></pre></div>
<pre><code>      x       y
  &lt;dbl&gt;   &lt;chr&gt;
1     1       a
2     2 unknown
3     0       b
</code></pre>

<p>å•: <code>starwars</code> ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§è©¦ã—ã¦ã¿ã‚ˆã†</p>

</section>
<section>
<h2 id="æ¬ æå€¤ã®è£œå®Œ-dplyr-coalesce">æ¬ æå€¤ã®è£œå®Œ <code>dplyr::coalesce()</code></h2>

<p>å…ˆã«æŒ‡å®šã—ãŸåˆ—ãŒ <code>NA</code> ãªã‚‰æ¬¡ã®åˆ—ã®å€¤ã‚’æ¡ç”¨:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">y <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
z <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">)</span>
coalesce<span class="p">(</span>y<span class="p">,</span> z<span class="p">)</span></code></pre></div>
<pre><code>[1] 1 2 3 4 5
</code></pre>

<p>å‹ãŒç•°ãªã‚‹ã¨æ€’ã‚‰ã‚Œã‚‹:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">df <span class="o">=</span> tibble<span class="p">(</span>x <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kc">NA</span><span class="p">),</span> y <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;a&#34;</span><span class="p">,</span> <span class="kc">NA</span><span class="p">,</span> <span class="s">&#34;b&#34;</span><span class="p">))</span>
df <span class="o">%&gt;%</span>
  mutate<span class="p">(</span>z <span class="o">=</span> coalesce<span class="p">(</span>x<span class="p">,</span> y<span class="p">))</span></code></pre></div>
<pre><code>Error: Argument 2 must be a double vector, not a character vector
</code></pre>

<p>å•: <code>starwars</code> ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§è©¦ã—ã¦ã¿ã‚ˆã†</p>

</section>
<section>
<h2 id="æ¬ æå€¤ã¨ã¿ãªã™-dplyr-na-if">æ¬ æå€¤ã¨ã¿ãªã™ <code>dplyr::na_if()</code></h2>

<p>ç‰¹å®šã®å€¤ã‚’ <code>NA</code> ã«ç½®ãæ›ãˆã‚‹:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">df <span class="o">%&gt;%</span>
  mutate<span class="p">(</span>x <span class="o">=</span> na_if<span class="p">(</span>x<span class="p">,</span> <span class="m">1</span><span class="p">),</span> y <span class="o">=</span> na_if<span class="p">(</span>y<span class="p">,</span> <span class="s">&#34;a&#34;</span><span class="p">))</span></code></pre></div>
<pre><code>      x     y
  &lt;dbl&gt; &lt;chr&gt;
1    NA  &lt;NA&gt;
2     2  &lt;NA&gt;
3    NA     b
</code></pre>

<p>å•: <code>starwars</code> ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§è©¦ã—ã¦ã¿ã‚ˆã†</p>

</section>
<section>
<h2 id="æ–‡å­—åˆ—">æ–‡å­—åˆ—</h2>

<p>ãƒ€ãƒ–ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã§å›²ã‚€ã€‚ã‚·ãƒ³ã‚°ãƒ«ã‚¯ã‚©ãƒ¼ãƒˆã‚‚ä½¿ãˆã‚‹ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">x <span class="o">=</span> <span class="s">&#34;This is a string&#34;</span>
y <span class="o">=</span> <span class="s">&#39;If I want to include a &#34;quote&#34; inside a string, I use single quotes&#39;</span></code></pre></div>
<p>é–‰ã˜ãã³ã‚Œã‚‹ã¨å¤‰ãªçŠ¶æ…‹ã«ãªã‚‹ã®ã§ã€è½ã¡ç€ã„ã¦ <kbd>esc</kbd> or <kbd>ctrl</kbd><kbd>c</kbd></p>

<pre><code>&gt; &quot;This is a string without a closing quote
+
+
+ HELP I'M STUCK
</code></pre>

<div class="url">
<a href=https://r4ds.had.co.nz/strings.html>
https://r4ds.had.co.nz/strings.html
</a></div>

</section>
<section>
<h2 id="rå‚™ãˆä»˜ã‘ã®æ–‡å­—åˆ—æ©Ÿèƒ½ã¯ä½¿ã„ã«ãã„">Rå‚™ãˆä»˜ã‘ã®æ–‡å­—åˆ—æ©Ÿèƒ½ã¯ä½¿ã„ã«ãã„</h2>

<ul>
<li>ä½•ã‚’ã‚„ã‚‹é–¢æ•°ãªã®ã‹åå‰ã‹ã‚‰åˆ†ã‹ã‚Šã«ãã„<br>
<code>grep</code>, <code>grepl</code>, <code>regexpr</code>, <code>gregexpr</code>, <code>regexec</code><br>
<code>sub</code>, <code>gsub</code>, <code>substr</code>, <code>substring</code></li>
<li>ç¬¬ä¸€å¼•æ•°ã¯å¯¾è±¡æ–‡å­—åˆ—ï¼Ÿæ¤œç´¢ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼Ÿé–¢æ•°ã”ã¨ã«é•ã†ã€‚</li>
<li><code>NA</code> ã«å¯¾ã™ã‚‹æŒ™å‹•ãŒå¾®å¦™</li>
</ul>
</section>
<section>
<h2 id="stringr-æ–‡å­—åˆ—å‡¦ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸">stringr &mdash; æ–‡å­—åˆ—å‡¦ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸</h2>

<p><a href="https://stringr.tidyverse.org/">
<img src="/slides/figure/rstats/hex-stringr.png" width="120" align="right">
</a></p>

<ul>
<li>tidyverseã®ä¸€éƒ¨</li>
<li>ä½•ã‚’ã‚„ã‚‹é–¢æ•°ãªã®ã‹åå‰ã‹ã‚‰åˆ†ã‹ã‚Šã‚„ã™ã„</li>
<li>å¯¾è±¡æ–‡å­—åˆ—ãŒä¸€è²«ã—ã¦ç¬¬ä¸€å¼•æ•°ã§ã€ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒäºŒç•ªç›®</li>
<li>å¼•æ•°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å„è¦ç´ ã®åå‰ã‚„ä½ç½®ã‚’ä¿æŒã™ã‚‹

<ul>
<li>é•·ã•ã‚¼ãƒ­ã®å…¥åŠ›ã‹ã‚‰ã¯é•·ã•ã‚¼ãƒ­ã®å‡ºåŠ›</li>
<li>å…¥åŠ›ã« <code>NA</code> ãŒå«ã¾ã‚Œã‚‹å ´åˆã¯å¯¾å¿œã™ã‚‹å‡ºåŠ›ã‚‚ <code>NA</code></li>
</ul></li>
<li><a href="http://userguide.icu-project.org/strings/regexp">ICUæ­£è¦è¡¨ç¾</a> ã®ä»•æ§˜ãŒæ˜ç¢º</li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/strings.pdf">ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ</a></li>
</ul>
</section>
<section>
<h2 id="æ–‡å­—åˆ—åŸºæœ¬æ“ä½œ">æ–‡å­—åˆ—åŸºæœ¬æ“ä½œ</h2>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">fruit4 <span class="o">=</span> <span class="kp">head</span><span class="p">(</span>fruit<span class="p">,</span> <span class="m">4L</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="kp">print</span><span class="p">()</span></code></pre></div>
<pre><code>[1] &quot;apple&quot;   &quot;apricot&quot; &quot;avocado&quot; &quot;banana&quot; 
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">str_length<span class="p">(</span>fruit4<span class="p">)</span>            <span class="c1"># é•·ã•</span></code></pre></div>
<pre><code>[1] 5 7 7 6
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">str_sub<span class="p">(</span>fruit4<span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">)</span>         <span class="c1"># éƒ¨åˆ†åˆ—</span></code></pre></div>
<pre><code>[1] &quot;ppl&quot; &quot;pri&quot; &quot;voc&quot; &quot;ana&quot;
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">str_c<span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">4</span><span class="p">,</span> <span class="s">&#34; &#34;</span><span class="p">,</span> fruit4<span class="p">,</span> <span class="s">&#34;!&#34;</span><span class="p">)</span>  <span class="c1"># çµåˆ</span></code></pre></div>
<pre><code>[1] &quot;1 apple!&quot;   &quot;2 apricot!&quot; &quot;3 avocado!&quot; &quot;4 banana!&quot; 
</code></pre>

</section>
<section>
<h2 id="ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°-æ­£è¦è¡¨ç¾">ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã€æ­£è¦è¡¨ç¾</h2>

<p>å˜ç´”ãªä¸€è‡´ã ã‘ã˜ã‚ƒãªãã€ã„ã‚ã‚“ãªæ¡ä»¶ã§ãƒãƒƒãƒãƒ³ã‚°ã§ãã‚‹:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># aã§å§‹ã¾ã‚‹</span>
str_subset<span class="p">(</span>fruit<span class="p">,</span> <span class="s">&#34;^a&#34;</span><span class="p">)</span></code></pre></div>
<pre><code>[1] &quot;apple&quot;   &quot;apricot&quot; &quot;avocado&quot;
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># rã§çµ‚ã‚ã‚‹</span>
str_subset<span class="p">(</span>fruit<span class="p">,</span> <span class="s">&#34;r$&#34;</span><span class="p">)</span></code></pre></div>
<pre><code>[1] &quot;bell pepper&quot;  &quot;chili pepper&quot; &quot;cucumber&quot;     &quot;pear&quot;        
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="c1"># è‹±æ•°å­—3-4æ–‡å­—</span>
str_subset<span class="p">(</span>fruit<span class="p">,</span> <span class="s">&#34;^\\w{3,4}$&#34;</span><span class="p">)</span></code></pre></div>
<pre><code>[1] &quot;date&quot; &quot;fig&quot;  &quot;lime&quot; &quot;nut&quot;  &quot;pear&quot; &quot;plum&quot;
</code></pre>

</section>
<section>
<h2 id="æ­£è¦è¡¨ç¾-ã‚ˆãä½¿ã†ç‰¹æ®Šæ–‡å­—">æ­£è¦è¡¨ç¾: ã‚ˆãä½¿ã†ç‰¹æ®Šæ–‡å­—</h2>

<table>
<thead>
<tr>
<th>ãƒ¡ã‚¿æ–‡å­—</th>
<th>æ„å‘³</th>
<th>&emsp;&emsp;&emsp;</th>
<th>æ¼”ç®—å­</th>
<th>æ„å‘³</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>\d</code></td>
<td>æ•°å­—</td>
<td></td>
<td><code>?</code></td>
<td>0å›ã‹1å›</td>
</tr>

<tr>
<td><code>\s</code></td>
<td>ç©ºç™½</td>
<td></td>
<td><code>*</code></td>
<td>0å›ä»¥ä¸Šç¹°ã‚Šè¿”ã—</td>
</tr>

<tr>
<td><code>\w</code></td>
<td>è‹±æ•°å­—</td>
<td></td>
<td><code>+</code></td>
<td>1å›ä»¥ä¸Šç¹°ã‚Šè¿”ã—</td>
</tr>

<tr>
<td><code>.</code></td>
<td>ä½•ã§ã‚‚</td>
<td></td>
<td><code>{n,m}</code></td>
<td>nå›ä»¥ä¸Šmå›ä»¥ä¸‹</td>
</tr>

<tr>
<td><code>^</code></td>
<td>è¡Œé ­</td>
<td></td>
<td><code>XXX(?=YYY)</code></td>
<td>YYYã«å…ˆç«‹ã¤XXX</td>
</tr>

<tr>
<td><code>$</code></td>
<td>è¡Œæœ«</td>
<td></td>
<td><code>(?&lt;=YYY)XXX</code></td>
<td>YYYã«ç¶šãXXX</td>
</tr>
</tbody>
</table>

<p>Ræ–‡å­—åˆ—ã§ã¯ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥ã‚’é‡ã­ã‚‹å¿…è¦ãŒã‚ã‚‹, e.g., <code>&quot;\\d&quot;</code>.<br>
<code>\D</code>, <code>\S</code>, <code>W</code> ã®ã‚ˆã†ã«å¤§æ–‡å­—ã«ã™ã‚‹ã¨åè»¢ã€‚</p>

<div class="url"><a href="http://userguide.icu-project.org/strings/regexp">
http://userguide.icu-project.org/strings/regexp
</a></div>

<p>å•: <code>str_subset(fruit, &quot;PATTERN&quot;)</code> ã‚’ã„ã‚ã„ã‚è©¦ã—ã¦ã¿ã‚ˆã†</p>

</section>
<section>
<h2 id="æ¤œå‡º-str-detect">æ¤œå‡º <code>str_detect()</code></h2>

<p>ãƒãƒƒãƒã™ã‚‹ã‹ã©ã†ã‹ <code>TRUE</code>/<code>FALSE</code> ã‚’è¿”ã™ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">fruit4 <span class="o">=</span> <span class="kp">head</span><span class="p">(</span>fruit<span class="p">,</span> <span class="m">4L</span><span class="p">)</span>
str_detect<span class="p">(</span>fruit4<span class="p">,</span> <span class="s">&#34;^a&#34;</span><span class="p">)</span></code></pre></div>
<pre><code>[1]  TRUE  TRUE  TRUE FALSE
</code></pre>

<p>å•: <code>starwars</code> ã® <code>name</code> åˆ—ã§ <code>filter()</code> ã—ã¦ã¿ã‚ˆã†</p>

<pre><code>             name height  mass hair_color  skin_color eye_color birth_year
            &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;      &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;
 1 Luke Skywalker    172    77      blond        fair      blue       19.0
 2          C-3PO    167    75       &lt;NA&gt;        gold    yellow      112.0
 3          R2-D2     96    32       &lt;NA&gt; white, blue       red       33.0
 4    Darth Vader    202   136       none       white    yellow       41.9
--                                                                        
84    Poe Dameron     NA    NA      brown       light     brown         NA
85            BB8     NA    NA       none        none     black         NA
86 Captain Phasma     NA    NA    unknown     unknown   unknown         NA
87  PadmÃ© Amidala    165    45      brown       light     brown       46.0
   gender homeworld species     films  vehicles starships
    &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;list&gt;    &lt;list&gt;    &lt;list&gt;
 1   male  Tatooine   Human &lt;chr [5]&gt; &lt;chr [2]&gt; &lt;chr [2]&gt;
 2   &lt;NA&gt;  Tatooine   Droid &lt;chr [6]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 3   &lt;NA&gt;     Naboo   Droid &lt;chr [7]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 4   male  Tatooine   Human &lt;chr [4]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
--                                                       
84   male      &lt;NA&gt;   Human &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
85   none      &lt;NA&gt;   Droid &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
86 female      &lt;NA&gt;    &lt;NA&gt; &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
87 female     Naboo   Human &lt;chr [3]&gt; &lt;chr [0]&gt; &lt;chr [3]&gt;
</code></pre>

</section>
<section>
<h2 id="æŠ½å‡º-str-extract">æŠ½å‡º <code>str_extract()</code></h2>

<p>ãƒãƒƒãƒã—ãŸéƒ¨åˆ†æ–‡å­—åˆ—ã‚’å–ã‚Šå‡ºã™ã€‚ã—ãªã‹ã£ãŸè¦ç´ ã«ã¯ <code>NA</code>ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">fruit4 <span class="o">=</span> <span class="kp">head</span><span class="p">(</span>fruit<span class="p">,</span> <span class="m">4L</span><span class="p">)</span>
str_extract<span class="p">(</span>fruit4<span class="p">,</span> <span class="s">&#34;^a..&#34;</span><span class="p">)</span></code></pre></div>
<pre><code>[1] &quot;app&quot; &quot;apr&quot; &quot;avo&quot; NA   
</code></pre>

<p>å•: <code>diamonds</code> ã® <code>clarity</code> åˆ—ã‹ã‚‰æ•°å­—ã‚’å–ã‚Šé™¤ã„ã¦ã¿ã‚ˆã†</p>

<pre><code>      carat       cut color clarity depth table price     x     y     z
      &lt;dbl&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;ord&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
    1  0.23     Ideal     E     SI2  61.5    55   326  3.95  3.98  2.43
    2  0.21   Premium     E     SI1  59.8    61   326  3.89  3.84  2.31
    3  0.23      Good     E     VS1  56.9    65   327  4.05  4.07  2.31
    4  0.29   Premium     I     VS2  62.4    58   334  4.20  4.23  2.63
   --                                                                  
53937  0.72      Good     D     SI1  63.1    55  2757  5.69  5.75  3.61
53938  0.70 Very Good     D     SI1  62.8    60  2757  5.66  5.68  3.56
53939  0.86   Premium     H     SI2  61.0    58  2757  6.15  6.12  3.74
53940  0.75     Ideal     D     SI2  62.2    55  2757  5.83  5.87  3.64
</code></pre>

</section>
<section>
<h2 id="ç½®æ›-str-replace">ç½®æ› <code>str_replace()</code></h2>

<p>ã‚«ãƒƒã‚³ <code>()</code> ã§å›²ã‚“ã ãƒãƒƒãƒãƒ³ã‚°ã¯å¾Œã§å‚ç…§ã§ãã‚‹:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">fruit4 <span class="o">=</span> <span class="kp">head</span><span class="p">(</span>fruit<span class="p">,</span> <span class="m">4L</span><span class="p">)</span>
str_replace<span class="p">(</span>fruit4<span class="p">,</span> <span class="s">&#34;..$&#34;</span><span class="p">,</span> <span class="s">&#34;!!&#34;</span><span class="p">)</span></code></pre></div>
<pre><code>[1] &quot;app!!&quot;   &quot;apric!!&quot; &quot;avoca!!&quot; &quot;bana!!&quot; 
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">str_replace<span class="p">(</span>fruit4<span class="p">,</span> <span class="s">&#34;(..)$&#34;</span><span class="p">,</span> <span class="s">&#34;!!\\1&#34;</span><span class="p">)</span></code></pre></div>
<pre><code>[1] &quot;app!!le&quot;   &quot;apric!!ot&quot; &quot;avoca!!do&quot; &quot;bana!!na&quot; 
</code></pre>

<p>å•: <code>starwars</code> ã® <code>name</code> åˆ—ã®æ•°å­—ã‚’å…¨éƒ¨ã‚¼ãƒ­ã«ã—ã¦ã¿ã‚ˆã†</p>

<pre><code>             name height  mass hair_color  skin_color eye_color birth_year
            &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt;      &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;      &lt;dbl&gt;
 1 Luke Skywalker    172    77      blond        fair      blue       19.0
 2          C-3PO    167    75       &lt;NA&gt;        gold    yellow      112.0
 3          R2-D2     96    32       &lt;NA&gt; white, blue       red       33.0
 4    Darth Vader    202   136       none       white    yellow       41.9
--                                                                        
84    Poe Dameron     NA    NA      brown       light     brown         NA
85            BB8     NA    NA       none        none     black         NA
86 Captain Phasma     NA    NA    unknown     unknown   unknown         NA
87  PadmÃ© Amidala    165    45      brown       light     brown       46.0
   gender homeworld species     films  vehicles starships
    &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;    &lt;list&gt;    &lt;list&gt;    &lt;list&gt;
 1   male  Tatooine   Human &lt;chr [5]&gt; &lt;chr [2]&gt; &lt;chr [2]&gt;
 2   &lt;NA&gt;  Tatooine   Droid &lt;chr [6]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 3   &lt;NA&gt;     Naboo   Droid &lt;chr [7]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
 4   male  Tatooine   Human &lt;chr [4]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
--                                                       
84   male      &lt;NA&gt;   Human &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [1]&gt;
85   none      &lt;NA&gt;   Droid &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
86 female      &lt;NA&gt;    &lt;NA&gt; &lt;chr [1]&gt; &lt;chr [0]&gt; &lt;chr [0]&gt;
87 female     Naboo   Human &lt;chr [3]&gt; &lt;chr [0]&gt; &lt;chr [3]&gt;
</code></pre>

</section>
<section>
<h2 id="å½¢å¼ã‚’å¤‰ãˆã‚‹-æ•´ãˆã‚‹">å½¢å¼ã‚’å¤‰ãˆã‚‹ãƒ»æ•´ãˆã‚‹</h2>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">fruit4 <span class="o">=</span> <span class="kp">head</span><span class="p">(</span>fruit<span class="p">,</span> <span class="m">4L</span><span class="p">)</span>
str_to_upper<span class="p">(</span>fruit4<span class="p">)</span>              <span class="c1"># å¤§æ–‡å­—ã«</span></code></pre></div>
<pre><code>[1] &quot;APPLE&quot;   &quot;APRICOT&quot; &quot;AVOCADO&quot; &quot;BANANA&quot; 
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">str_pad<span class="p">(</span>fruit4<span class="p">,</span> <span class="m">8</span><span class="p">,</span> <span class="s">&#34;left&#34;</span><span class="p">,</span> <span class="s">&#34;_&#34;</span><span class="p">)</span>   <span class="c1"># å¹…ã‚’åŸ‹ã‚ã‚‹</span></code></pre></div>
<pre><code>[1] &quot;___apple&quot; &quot;_apricot&quot; &quot;_avocado&quot; &quot;__banana&quot;
</code></pre>

<p><a href="http://www.gagolewski.com/software/stringi/"><code>stringi</code></a> ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã•ã‚‰ã«å¤šæ©Ÿèƒ½</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">stringi<span class="o">::</span>stri_trans_nfkc<span class="p">(</span><span class="s">&#34;ï½¶ï¾€ï½¶ï¾…&#34;</span><span class="p">)</span>  <span class="c1"># åŠè§’ã‚«ãƒŠã‚’å…¨è§’ã«</span></code></pre></div>
<pre><code>[1] &quot;ã‚«ã‚¿ã‚«ãƒŠ&quot;
</code></pre>

</section>
<section>
<h2 id="æ–‡å­—åˆ—ã‹ã‚‰åˆ¥ã®å‹ã«">æ–‡å­—åˆ—ã‹ã‚‰åˆ¥ã®å‹ã«</h2>

<p><a href="https://readr.tidyverse.org/">
<img src="/slides/figure/rstats/hex-readr.png" width="120" align="right">
</a></p>

<p>ã“ã‚Œã¯stringrã§ã¯ãªãreadrã®æ‹…å½“:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">parse_number<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&#34;p = 0.02 *&#34;</span><span class="p">,</span> <span class="s">&#34;N_A = 6e23&#34;</span><span class="p">))</span></code></pre></div>
<pre><code>[1] 2e-02 6e+23
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">parse_double<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&#34;0.02&#34;</span><span class="p">,</span> <span class="s">&#34;6e23&#34;</span><span class="p">))</span>   <span class="c1"># ç•°ç‰©ã«ã¯è­¦å‘Š</span></code></pre></div>
<pre><code>[1] 2e-02 6e+23
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">parse_logical<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&#34;1&#34;</span><span class="p">,</span> <span class="s">&#34;true&#34;</span><span class="p">,</span> <span class="s">&#34;0&#34;</span><span class="p">,</span> <span class="s">&#34;false&#34;</span><span class="p">))</span></code></pre></div>
<pre><code>[1]  TRUE  TRUE FALSE FALSE
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">parse_date<span class="p">(</span><span class="s">&#34;2019-12-27&#34;</span><span class="p">)</span></code></pre></div>
<pre><code>[1] &quot;2019-12-27&quot;
</code></pre>

</section>
<section>
<h2 id="å› å­å‹-factor">å› å­å‹ <code>factor</code></h2>

<p>ã‚«ãƒ†ã‚´ãƒªã‚«ãƒ«å¤‰æ•°ã‚’æ‰±ã†ãŸã‚ã®å‹ã€‚æ–‡å­—åˆ—ã£ã½ã„ã‘ã©ä¸­èº«ã¯æ•°ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">iris <span class="o">=</span> tibble<span class="o">::</span>as_tibble<span class="p">(</span>iris<span class="p">)</span> <span class="o">%&gt;%</span> <span class="kp">print</span><span class="p">()</span></code></pre></div>
<pre><code>    Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;     &lt;fct&gt;
  1          5.1         3.5          1.4         0.2    setosa
  2          4.9         3.0          1.4         0.2    setosa
  3          4.7         3.2          1.3         0.2    setosa
  4          4.6         3.1          1.5         0.2    setosa
 --                                                            
147          6.3         2.5          5.0         1.9 virginica
148          6.5         3.0          5.2         2.0 virginica
149          6.2         3.4          5.4         2.3 virginica
150          5.9         3.0          5.1         1.8 virginica
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r"><span class="kp">levels</span><span class="p">(</span>iris<span class="p">[[</span><span class="s">&#34;Species&#34;</span><span class="p">]])</span></code></pre></div>
<pre><code>[1] &quot;setosa&quot;     &quot;versicolor&quot; &quot;virginica&quot; 
</code></pre>

<div class="url"><a href="https://r4ds.had.co.nz/factors.html">
https://r4ds.had.co.nz/factors.html
</a></div>

</section>
<section>
<h2 id="å› å­å‹-factor-æ–‡å­—åˆ—ã¨ã®é•ã„1">å› å­å‹ <code>factor</code>: æ–‡å­—åˆ—ã¨ã®é•ã„1</h2>

<p>å–ã‚Šã†ã‚‹å€¤ (levels) ãŒæ—¢çŸ¥ã€‚</p>

<p>typoãŒã‚ã‚‹ã¨ <code>NA</code> æ‰±ã„ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">month_levels <span class="o">=</span> <span class="kt">c</span><span class="p">(</span>
  <span class="s">&#34;Jan&#34;</span><span class="p">,</span> <span class="s">&#34;Feb&#34;</span><span class="p">,</span> <span class="s">&#34;Mar&#34;</span><span class="p">,</span> <span class="s">&#34;Apr&#34;</span><span class="p">,</span> <span class="s">&#34;May&#34;</span><span class="p">,</span> <span class="s">&#34;Jun&#34;</span><span class="p">,</span>
  <span class="s">&#34;Jul&#34;</span><span class="p">,</span> <span class="s">&#34;Aug&#34;</span><span class="p">,</span> <span class="s">&#34;Sep&#34;</span><span class="p">,</span> <span class="s">&#34;Oct&#34;</span><span class="p">,</span> <span class="s">&#34;Nov&#34;</span><span class="p">,</span> <span class="s">&#34;Dec&#34;</span>
<span class="p">)</span>
x2 <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;Dec&#34;</span><span class="p">,</span> <span class="s">&#34;Apr&#34;</span><span class="p">,</span> <span class="s">&#34;Jam&#34;</span><span class="p">,</span> <span class="s">&#34;Mar&#34;</span><span class="p">)</span>
<span class="kp">factor</span><span class="p">(</span>x2<span class="p">,</span> levels <span class="o">=</span> month_levels<span class="p">)</span></code></pre></div>
<pre><code>[1] Dec  Apr  &lt;NA&gt; Mar 
Levels: Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec
</code></pre>

</section>
<section>
<h2 id="å› å­å‹-factor-æ–‡å­—åˆ—ã¨ã®é•ã„2">å› å­å‹ <code>factor</code>: æ–‡å­—åˆ—ã¨ã®é•ã„2</h2>

<p>é †åºãŒã‚ã‚‹ã€‚</p>

<p>æ–‡å­—åˆ—ã‚’ã‚½ãƒ¼ãƒˆã™ã‚‹ã¨å½“ç„¶ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã«ãªã‚‹ã‘ã©ã€<br>
å› å­å‹ã«ã¯ãã†ã˜ã‚ƒãªã„é †åºã‚’æŒãŸã›ã‚‰ã‚Œã‚‹:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">x1 <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&#34;Dec&#34;</span><span class="p">,</span> <span class="s">&#34;Apr&#34;</span><span class="p">,</span> <span class="s">&#34;Jan&#34;</span><span class="p">,</span> <span class="s">&#34;Mar&#34;</span><span class="p">)</span>
<span class="kp">sort</span><span class="p">(</span>x1<span class="p">)</span></code></pre></div>
<pre><code>[1] &quot;Apr&quot; &quot;Dec&quot; &quot;Jan&quot; &quot;Mar&quot;
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">y1 <span class="o">=</span> <span class="kp">factor</span><span class="p">(</span>x1<span class="p">,</span> levels <span class="o">=</span> month_levels<span class="p">)</span>
<span class="kp">as.integer</span><span class="p">(</span>y1<span class="p">)</span></code></pre></div>
<pre><code>[1] 12  4  1  3
</code></pre>

</section>
<section>
<h2 id="å› å­å‹-factor-é †åºã®æƒ…å ±ã¯ä½œå›³ã§ç”Ÿãã‚‹">å› å­å‹ <code>factor</code>: é †åºã®æƒ…å ±ã¯ä½œå›³ã§ç”Ÿãã‚‹</h2>

<p>æ–‡å­—åˆ—ãªã‚‰ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆé †ã€å› å­å‹ãªã‚‰ä»»æ„æŒ‡å®šå¯èƒ½ã€‚<br>
é »åº¦é †ã«ã™ã‚‹ä¾‹:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">diamonds <span class="o">%&gt;%</span>
  mutate<span class="p">(</span>color <span class="o">=</span> fct_infreq<span class="p">(</span>color<span class="p">))</span> <span class="o">%&gt;%</span>
  ggplot<span class="p">(</span>aes<span class="p">(</span>x <span class="o">=</span> color<span class="p">))</span> <span class="o">+</span>
  geom_bar<span class="p">()</span> <span class="o">+</span> coord_flip<span class="p">()</span></code></pre></div>
<p><img src="figure/fct_infreq-1.png" alt="plot of chunk fct_infreq"></p>

</section>
<section>
<h2 id="tidyverse-ã®å› å­å‹æ‹…å½“ã¯-forcats">tidyverse ã®å› å­å‹æ‹…å½“ã¯ forcats</h2>

<p><a href="https://forcats.tidyverse.org/">
<img src="/slides/figure/rstats/hex-forcats.png" width="120" align="right">
</a></p>

<ul>
<li><code>fct_reorder()</code>: åˆ¥ã®å¤‰æ•°ã«å¿œã˜ã¦é †åºã‚’ä¸¦ã¹æ›¿ãˆ</li>
<li><code>fct_infreq()</code>: é »åº¦ã«å¿œã˜ã¦é †åºã‚’ä¸¦ã¹æ›¿ãˆ</li>
<li><code>fct_relevel()</code>: ã™ã¹ã¦æ‰‹å‹•ã§å†è¨­å®š</li>
<li><code>fct_lump()</code>: å°‘ãªã™ãã‚‹ã‚«ãƒ†ã‚´ãƒªã‚’&rdquo;ãã®ä»–&rdquo;ã¨ã—ã¦ã¾ã¨ã‚ã‚‹</li>
</ul>
</section>
<section>
<h2 id="ãƒ€ãƒŸãƒ¼å¤‰æ•°ã«å¤‰æ›">ãƒ€ãƒŸãƒ¼å¤‰æ•°ã«å¤‰æ›</h2>

<p>ã‚¤ãƒã‚¼ãƒ­ã®å€¤ã‚’æŒãŸã›ã¦æ¨ªåºƒã«å¤‰å½¢ã™ã‚‹ã®ã¨ç­‰ä¾¡ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">iris <span class="o">%&gt;%</span>
  rowid_to_column<span class="p">()</span> <span class="o">%&gt;%</span> select<span class="p">(</span><span class="o">-</span>starts_with<span class="p">(</span><span class="s">&#34;Sepal&#34;</span><span class="p">))</span> <span class="o">%&gt;%</span>
  mutate<span class="p">(</span>value <span class="o">=</span> <span class="m">1L</span><span class="p">)</span> <span class="o">%&gt;%</span>
  pivot_wider<span class="p">(</span>names_from <span class="o">=</span> Species<span class="p">,</span> values_from <span class="o">=</span> value<span class="p">,</span> values_fill <span class="o">=</span> <span class="kt">c</span><span class="p">(</span>value <span class="o">=</span> <span class="m">0L</span><span class="p">))</span></code></pre></div>
<pre><code>    rowid Petal.Length Petal.Width setosa versicolor virginica
    &lt;int&gt;        &lt;dbl&gt;       &lt;dbl&gt;  &lt;int&gt;      &lt;int&gt;     &lt;int&gt;
  1     1          1.4         0.2      1          0         0
  2     2          1.4         0.2      1          0         0
  3     3          1.3         0.2      1          0         0
  4     4          1.5         0.2      1          0         0
 --                                                           
147   147          5.0         1.9      0          0         1
148   148          5.2         2.0      0          0         1
149   149          5.4         2.3      0          0         1
150   150          5.1         1.8      0          0         1
</code></pre>

<p>å•: ã“ã‚Œã®é€†å‘ãã‚’ã‚„ã£ã¦ã¿ã‚ˆã†</p>

</section>
<section>
<h2 id="æ—¥æ™‚å‹-posixct-posixlt">æ—¥æ™‚å‹: POSIXct, POSIXlt</h2>

<ul>
<li>POSIXct: ã‚¨ãƒãƒƒã‚¯ã‹ã‚‰ã®çµŒéç§’æ•°ã€‚æ¯”è¼ƒã‚„å·®åˆ†ãªã©ã‚’å–ã‚Šã‚„ã™ã„ã€‚</li>
<li>POSIXlt: list(å¹´, æœˆ, æ—¥, æ™‚, åˆ†, ç§’)ã€‚å˜ä½ã”ã¨ã«æŠœãå‡ºã—ã‚„ã™ã„ã€‚</li>
</ul>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">now <span class="o">=</span> <span class="s">&#34;2019-12-27 13:00:00&#34;</span>
ct <span class="o">=</span> <span class="kp">as.POSIXct</span><span class="p">(</span>now<span class="p">)</span>
<span class="kp">unclass</span><span class="p">(</span>ct<span class="p">)</span></code></pre></div>
<pre><code>[1] 1577419200
attr(,&quot;tzone&quot;)
[1] &quot;&quot;
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">lt <span class="o">=</span> <span class="kp">as.POSIXlt</span><span class="p">(</span>now<span class="p">)</span>
<span class="kp">unclass</span><span class="p">(</span>lt<span class="p">)</span> <span class="o">%&gt;%</span> as_tibble<span class="p">()</span></code></pre></div>
<pre><code>    sec   min  hour  mday   mon  year  wday  yday isdst  zone gmtoff
  &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;  &lt;int&gt;
1     0     0    13    27    11   119     5   360     0   JST     NA
</code></pre>

<p>ç´ ã®Rã§ã‚‚æ‰±ãˆã‚‹ã‘ã© lubridate ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†ã¨ã‚‚ã£ã¨æ¥½ã«ã€‚</p>

</section>
<section>
<h2 id="lubridate-æ—¥æ™‚å‹å‡¦ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸">lubridate &mdash; æ—¥æ™‚å‹å‡¦ç†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸</h2>

<p><a href="https://lubridate.tidyverse.org/">
<img src="/slides/figure/rstats/hex-lubridate.png" width="120" align="right">
</a></p>

<p>æ—¥æ™‚å‹ã¸ã®å¤‰æ›:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">today <span class="o">=</span> ymd<span class="p">(</span><span class="m">20191227</span><span class="p">)</span>
ymd<span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&#34;20191227&#34;</span><span class="p">,</span> <span class="s">&#34;2019-12-27&#34;</span><span class="p">,</span> <span class="s">&#34;19/12/27&#34;</span><span class="p">))</span></code></pre></div>
<pre><code>[1] &quot;2019-12-27&quot; &quot;2019-12-27&quot; &quot;2019-12-27&quot;
</code></pre>

<p>æ—¥æ™‚å‹ã‹ã‚‰å˜ä½ã”ã¨ã«å€¤ã‚’å–å¾—:</p>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">month<span class="p">(</span>today<span class="p">)</span></code></pre></div>
<pre><code>[1] 12
</code></pre>
<div class="highlight"><pre class="chroma"><code class="language-r" data-lang="r">wday<span class="p">(</span>today<span class="p">,</span> label <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span></code></pre></div>
<pre><code>[1] Fri
Levels: Sun &lt; Mon &lt; Tue &lt; Wed &lt; Thu &lt; Fri &lt; Sat
</code></pre>

<p><a href="https://github.com/rstudio/cheatsheets/raw/master/lubridate.pdf">ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ</a></p>

</section>
<section>
<h2 id="æœ¬æ—¥å‰åŠã®ã¾ã¨ã‚">æœ¬æ—¥å‰åŠã®ã¾ã¨ã‚</h2>

<ul>
<li>vectorã«ã¯å‹ãŒã‚ã‚‹: æ–‡å­—åˆ—ã€æ•°å€¤ã€å› å­ã€æ—¥æ™‚ã€etc.</li>
<li>å¤§æ¦‚ã®æ“ä½œã¯vectorå…¨ä½“ã«ä¸€æ‹¬é©ç”¨</li>
<li>æ–‡å­—åˆ—ã‚’æ‰±ã†ã«ã¯ <a href="https://stringr.tidyverse.org/">stringr</a>

<ul>
<li>æ­£è¦è¡¨ç¾ã¯å¼·åŠ›ãƒ»æ±ç”¨çš„</li>
</ul></li>
<li>å› å­ã‚’æ‰±ã†ã«ã¯ <a href="https://forcats.tidyverse.org/">forcats</a>

<ul>
<li>çŸ¥ã£ã¦ãŠãã¨ä½œå›³ã§æœ‰åˆ©</li>
</ul></li>
<li>æ—¥æ™‚ã‚’æ‰±ã†ã«ã¯ <a href="https://lubridate.tidyverse.org/">lubridate</a></li>
</ul>

<p>å„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ.pdfã‚’æ‰‹å…ƒã«æŒã£ã¦ãŠãã¨ä¾¿åˆ©ã€‚
</section>
<section>
<h2 id="reference">Reference</h2>

<dl>
<dt>R for Data Science &mdash; Hadley Wickham &amp; Garrett Grolemund</dt>
<dd><a href="https://r4ds.had.co.nz/">Website</a>, <a href="https://amzn.to/2tbRmVc">Book</a></dd>
<dd><a href="https://amzn.to/2yyFRKt">æ—¥æœ¬èªç‰ˆæ›¸ç±(Rã§ã¯ã˜ã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹)</a></dd>
</dl>

<p><a href="https://amzn.to/2Q8GlhE">Rãƒ¦ãƒ¼ã‚¶ã®ãŸã‚ã®RStudio[å®Ÿè·µ]å…¥é–€</a> &mdash; æ¾æ‘å„ªå“‰ã»ã‹<br>
<a href="https://amzn.to/2PFe4jF">å‰å‡¦ç†å¤§å…¨</a> &mdash; æœ¬æ©‹æ™ºå…‰</p>

<dl>
<dt>éå»ã®è¬›ç¾©è³‡æ–™</dt>
<dd>ã€Œ<a href="https://heavywatal.github.io/slides/nagoya2018/">Rã«ã‚„ã‚‰ã›ã¦æ¥½ã—ã‚ˆã† â€” ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–ã¨ä¸‹ã”ã—ã‚‰ãˆ</a>ã€
å²©åµœèˆª 2018</dd>
<dd>ã€ŒRã‚’ç”¨ã„ãŸãƒ‡ãƒ¼ã‚¿è§£æã®åŸºç¤ã¨å¿œç”¨ã€çŸ³å·ç”±å¸Œ 2019 åå¤å±‹å¤§å­¦</dd>
<dd>ã€Œ<a href="https://heavywatal.github.io/slides/makino2019r/">Hands-on R Lecture for Makino Lab</a>ã€
å²©åµœèˆª 2019 æ±åŒ—å¤§å­¦</dd>
<dt>Official documents:</dt>
<dd><a href="https://www.tidyverse.org/">tidyverse</a>,
<a href="https://dplyr.tidyverse.org/">dplyr</a>,
<a href="https://tidyr.tidyverse.org/">tidyr</a>,
<a href="https://tibble.tidyverse.org/">tibble</a>,
<a href="https://readr.tidyverse.org/">readr</a>,
<a href="https://stringr.tidyverse.org/">stringr</a>,
<a href="https://forcats.tidyverse.org/">forcats</a>
<a href="https://lubridate.tidyverse.org/">lubridate</a></dd>
</dl>

<p><a href="4-practice.html" rel="next" class="readmore">
4. å®Ÿè·µ: ç¾å®Ÿã®å•é¡Œã«å¯¾å‡¦ã—ã¦ã¿ã‚‹
</a></p>

</section>
</div>
</div>
<script src="/slides/reveal.js/js/reveal.js"></script>
<script>
Reveal.initialize({
  width: 960,
  height: 720,
  margin: 0,
  controls: true,
  controlsTutorial: false,
  controlsBackArrows: 'faded',
  progress: false,
  slideNumber: 'c/t',
  history: false,
  keyboard: true,
  overview: true,
  center: false,
  touch: true,
  loop: false,
  rtl: false,
  shuffle: false,
  fragments: true,
  fragmentInURL: false,
  embedded: false,
  help: true,
  showNotes: false,
  mouseWheel: false,
  transition: 'none',
  transitionSpeed: 'fast',
  backgroundTransition: 'none',
  viewDistance: 1,
  dependencies: [
    { src: '\/slides\/reveal.js\/plugin\/notes\/notes.js', async: true }
  ]
});
</script>
<script>
{
const reload_all_img = function() {
  const imgs = document.getElementsByTagName("img");
  for (let i = 0; i < imgs.length; ++i) {
    const src = imgs[i].src;
    imgs[i].src += "?q";
    imgs[i].src = src;
  }
};
const reload_src_element = function(ev) {
  const original_src = ev.srcElement.src;
  ev.srcElement.src += "?q";
  ev.srcElement.src = original_src;
};
const reload_src = function(ev) {
  if (ev.shiftKey || ev.metaKey || ev.altKey) {
    reload_all_img();
  } else {
    reload_src_element(ev);
  }
};
const img_elements = document.getElementsByTagName("img");
for (let i = 0; i < img_elements.length; ++i) {
  img_elements[i].onclick = reload_src;
}
};
</script>
</body>
</html>
